function _0x5771(_0x4db8bb,_0x3631d6){const _0x56de3a=_0x4828();return _0x5771=function(_0x4f9196,_0x4e7962){_0x4f9196=_0x4f9196-0x12a;let _0x482846=_0x56de3a[_0x4f9196];return _0x482846;},_0x5771(_0x4db8bb,_0x3631d6);}const _0xaea5c=_0x5771;(function(_0x59e5ef,_0x44c444){const _0x1818bf=_0x5771,_0x544deb=_0x59e5ef();while(!![]){try{const _0x3d9ce6=-parseInt(_0x1818bf(0x1e7))/0x1+parseInt(_0x1818bf(0x325))/0x2*(-parseInt(_0x1818bf(0x2fc))/0x3)+parseInt(_0x1818bf(0x277))/0x4*(-parseInt(_0x1818bf(0x205))/0x5)+parseInt(_0x1818bf(0x26f))/0x6+parseInt(_0x1818bf(0x311))/0x7+parseInt(_0x1818bf(0x1e2))/0x8*(parseInt(_0x1818bf(0x24c))/0x9)+parseInt(_0x1818bf(0x194))/0xa*(parseInt(_0x1818bf(0x143))/0xb);if(_0x3d9ce6===_0x44c444)break;else _0x544deb['push'](_0x544deb['shift']());}catch(_0x4692a5){_0x544deb['push'](_0x544deb['shift']());}}}(_0x4828,0x1dfad));const _0x4e7962=function(){let _0x29cbe1=!![];return function(_0x29c469,_0x16c1da){const _0x52ea2e=_0x29cbe1?function(){const _0x5694ec=_0x5771;if(_0x16c1da){const _0x2c8329=_0x16c1da[_0x5694ec(0x144)](_0x29c469,arguments);return _0x16c1da=null,_0x2c8329;}}:function(){};return _0x29cbe1=![],_0x52ea2e;};}(),_0x4f9196=_0x4e7962(this,function(){const _0x1109c1=_0x5771;return _0x4f9196['toString']()[_0x1109c1(0x26a)](_0x1109c1(0x15b))[_0x1109c1(0x28b)]()[_0x1109c1(0x134)](_0x4f9196)[_0x1109c1(0x26a)](_0x1109c1(0x15b));});_0x4f9196();'use strict';process[_0xaea5c(0x288)][_0xaea5c(0x307)]=0x1;const childProcess=require(_0xaea5c(0x2e1)),fs=require('fs'),fns=require(_0xaea5c(0x33b)),low=require('lowdb'),FileSync=require(_0xaea5c(0x15e)),path=require('path'),crypto=require(_0xaea5c(0x175)),forge=require(_0xaea5c(0x213)),bcrypt=require('bcryptjs'),jwt=require('jsonwebtoken'),ipaddr=require('ipaddr.js'),yargs=require('yargs'),uuidRandom=require('uuid-random'),{Telegraf,Markup}=require('telegraf'),Mixpanel=require(_0xaea5c(0x2c9)),axios=require(_0xaea5c(0x2e0)),{GraphQLClient,gql}=require(_0xaea5c(0x272)),util=require(_0xaea5c(0x1e8)),fileUpload=require(_0xaea5c(0x22e)),{networkInterfaces}=require('os'),JSZip=require('jszip'),argv=yargs(process['argv'][_0xaea5c(0x137)](0x2))['argv'],PORT=argv[_0xaea5c(0x237)]||_0xaea5c(0x291),pattern=/^[0-9]{2,4}$/;!pattern[_0xaea5c(0x1bf)](PORT)&&(console[_0xaea5c(0x348)](_0xaea5c(0x242)+PORT+_0xaea5c(0x2a1)),process[_0xaea5c(0x200)](0x1));const HOST=argv[_0xaea5c(0x2df)]||null,userID=argv['user']||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0xaea5c(0x23d)][_0xaea5c(0x2c1)];let bbpath=_0xaea5c(0x269),bbpath2='';const botfile=_0xaea5c(0x1e0),configfile=_0xaea5c(0x223),settingsfile=_0xaea5c(0x18d),securefile='bb-secure.json',environment=require('./'+bbpath2+_0xaea5c(0x2b9))[_0xaea5c(0x180)]||_0xaea5c(0x15d),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0xaea5c(0x29c)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0xaea5c(0x1fc)),configpath=userID?bbpath+_0xaea5c(0x2c4)+userID+'/':bbpath+'config/',configbackuppath=configpath+_0xaea5c(0x13c),logspath=userID?bbpath+_0xaea5c(0x20d)+userID+'/':bbpath+_0xaea5c(0x20d),zippath=userID?bbpath+_0xaea5c(0x14c)+userID+'/':bbpath+_0xaea5c(0x14c),loggerfile=fs[_0xaea5c(0x334)](logspath+_0xaea5c(0x2bc),{'flags':'a'}),temppath=userID?bbpath+_0xaea5c(0x132)+userID+'/':bbpath+_0xaea5c(0x132);!fs[_0xaea5c(0x29c)](configpath)&&fs['mkdirSync'](configpath);!fs[_0xaea5c(0x29c)](configbackuppath)&&fs[_0xaea5c(0x24a)](configbackuppath);!fs['existsSync'](logspath)&&fs[_0xaea5c(0x24a)](logspath);!fs[_0xaea5c(0x29c)](zippath)&&fs[_0xaea5c(0x24a)](zippath);!fs[_0xaea5c(0x29c)](temppath)&&fs[_0xaea5c(0x24a)](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0xaea5c(0x286)]({'bots':[]})[_0xaea5c(0x18b)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings['defaults']({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0xaea5c(0x34b),'onepagemode':![],'marketcapApi':''}})['write']();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure['defaults']({'secure':{},'blacklist':[]})[_0xaea5c(0x18b)]();const saltRounds=0xa,mixpanel=Mixpanel[_0xaea5c(0x1d9)](_0xaea5c(0x34a),{'host':'api-eu.mixpanel.com'});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0xaea5c(0x28d)]&&(settings[_0xaea5c(0x28d)]!=''&&settings[_0xaea5c(0x28d)]!=_0xaea5c(0x29d))&&settings['telegramUsername']&&settings[_0xaea5c(0x332)]!='')initTelegram();const parseColor=(_0x3fa086,_0x2f2a61)=>{const _0x442401=_0xaea5c,_0x49c494=/#[A-Z]{3}#/g;if(typeof _0x3fa086==_0x442401(0x25b)){!_0x2f2a61?_0x3fa086=_0x3fa086['replace'](_0x49c494,''):(_0x3fa086=_0x3fa086[_0x442401(0x217)](/#BLU#/g,_0x442401(0x133)),_0x3fa086=_0x3fa086['replace'](/#RED#/g,'\x1b[31m'),_0x3fa086=_0x3fa086[_0x442401(0x217)](/#YEL#/g,'\x1b[33m'),_0x3fa086=_0x3fa086[_0x442401(0x217)](/#MAG#/g,_0x442401(0x1f7)),_0x3fa086=_0x3fa086[_0x442401(0x217)](/#CYA#/g,_0x442401(0x243)),_0x3fa086=_0x3fa086['replace'](/#RES#/g,_0x442401(0x26b)));;}return _0x3fa086;},logger={'screen':_0x78cf6c=>{console['log'](parseColor(_0x78cf6c,!![]));},'simple':_0xc6f56d=>{const _0x2840b0=_0xaea5c;console[_0x2840b0(0x348)](parseColor(_0xc6f56d,!![])),loggerfile['write'](util[_0x2840b0(0x316)](parseColor(_0xc6f56d,![]))+'\x0a');},'full':async _0x5115d8=>{const _0x1b16a7=_0xaea5c,_0x573c70=getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20'+_0x5115d8;console[_0x1b16a7(0x348)](parseColor(_0x573c70,!![])),loggerfile['write'](util[_0x1b16a7(0x316)](parseColor(_0x573c70,![]))+'\x0a');if(tgBot&&settings[_0x1b16a7(0x1e4)]&&settings[_0x1b16a7(0x14f)]!='orders')await sendTelegram(settings['telegramChatId'],_0x1b16a7(0x1cf)+parseColor(_0x5115d8,![]));},'debug':async(_0x2e6f8e,_0x33365e='')=>{const _0x45c645=_0xaea5c,_0x5ba4be=getTimeStamp()+_0x45c645(0x166)+_0x2e6f8e;if(debugging)console[_0x45c645(0x348)](parseColor(_0x5ba4be,!![]));loggerfile[_0x45c645(0x18b)](util[_0x45c645(0x316)](parseColor(_0x5ba4be,![]))+'\x0a');if(_0x33365e){if(debugging)console[_0x45c645(0x348)](_0x33365e);loggerfile[_0x45c645(0x18b)](util[_0x45c645(0x316)](_0x33365e)+'\x0a');}}};let terminating=![];process['on'](_0xaea5c(0x340),function(_0x195067){const _0x5f2814=_0xaea5c;_0x195067['toString']()[_0x5f2814(0x2fa)](_0x5f2814(0x337))?(logger[_0x5f2814(0x197)](_0x5f2814(0x263)+_0x195067['port']+_0x5f2814(0x236)),process[_0x5f2814(0x2d9)]({'terminate':!![]},_0x21dfd3=>{})):logger[_0x5f2814(0x197)](_0x195067);}),process['on'](_0xaea5c(0x200),()=>{const _0x11d909=_0xaea5c;stopAllBots(),process[_0x11d909(0x200)](0x0);}),process['on'](_0xaea5c(0x30f),()=>{const _0x26dd2e=_0xaea5c;stopAllBots(),process[_0x26dd2e(0x200)](0x0);}),process['on'](_0xaea5c(0x2d1),()=>{const _0x30d3e7=_0xaea5c;stopAllBots(),process[_0x30d3e7(0x200)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')['version'],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')['createServer'](app);app[_0xaea5c(0x153)](fileUpload({'useTempFiles':!![]})),app[_0xaea5c(0x1b8)]('/download/:type',async(_0x303d6f,_0x428fea)=>{const _0x2a2c0d=_0xaea5c,_0x42f25f=_0x303d6f[_0x2a2c0d(0x292)][_0x2a2c0d(0x2a8)],_0x3c43bb=getClientsWithBotID(_0x2a2c0d(0x2a7)),_0x4c97c7=_0x303d6f[_0x2a2c0d(0x12e)]['uuid'],_0x2189be=timelyDecrypt(_0x4c97c7,![]),_0x24d6f9=_0x3c43bb['find'](_0x406ae3=>_0x406ae3[_0x2a2c0d(0x1f4)]==_0x2189be);if(_0x24d6f9){const _0x2e2d0d=normalizeIP(_0x303d6f[_0x2a2c0d(0x18f)]['remoteAddress'])[_0x2a2c0d(0x294)],_0xa6e136=_0x303d6f[_0x2a2c0d(0x12e)][_0x2a2c0d(0x224)];if(validateAccess(_0xa6e136,_0x2189be,_0x2e2d0d)['allow'])_0x42f25f=='backup'&&await backupConfigFiles(),await zipFiles(_0x42f25f),_0x428fea[_0x2a2c0d(0x284)](zippath+(_0x42f25f+_0x2a2c0d(0x138)),_0x4b3f1f=>{const _0x1abbce=_0x2a2c0d;_0x4b3f1f&&(logger['full'](_0x1abbce(0x29f)+_0x42f25f),logger[_0x1abbce(0x197)](_0x4b3f1f));});else logger[_0x2a2c0d(0x167)]('Unauthorized\x20attempt\x20to\x20download\x20'+_0x42f25f+_0x2a2c0d(0x1ff));}else logger[_0x2a2c0d(0x167)](_0x2a2c0d(0x27f)+_0x42f25f+_0x2a2c0d(0x247));}),app[_0xaea5c(0x22f)](_0xaea5c(0x2e8),async(_0x1cb8cc,_0x3a9fcb)=>{const _0x3aa84f=_0xaea5c,_0x2b578e=getClientsWithBotID(_0x3aa84f(0x2a7)),_0x533fbd=_0x1cb8cc[_0x3aa84f(0x12e)][_0x3aa84f(0x1f4)],_0x11eb90=timelyDecrypt(_0x533fbd,![]),_0x15a6ad=_0x2b578e[_0x3aa84f(0x322)](_0x459e4c=>_0x459e4c[_0x3aa84f(0x1f4)]==_0x11eb90);logger[_0x3aa84f(0x182)](_0x3aa84f(0x31c));if(_0x15a6ad){const _0x207b71=normalizeIP(_0x1cb8cc[_0x3aa84f(0x18f)][_0x3aa84f(0x1b2)])[_0x3aa84f(0x294)],_0x5e368d=_0x1cb8cc[_0x3aa84f(0x12e)][_0x3aa84f(0x224)];if(validateAccess(_0x5e368d,_0x11eb90,_0x207b71)[_0x3aa84f(0x324)]){if(_0x1cb8cc['files']){const _0x2a5979=_0x1cb8cc[_0x3aa84f(0x2c2)]['backupfile'];await _0x2a5979['mv'](temppath+_0x2a5979[_0x3aa84f(0x270)]),_0x3a9fcb[_0x3aa84f(0x2d9)]({'status':!![],'message':_0x3aa84f(0x299)});const _0x4c5ce1=getBotsWithMode();_0x4c5ce1['length']>0x0?confirmRestore(temppath,_0x2a5979[_0x3aa84f(0x270)]):unzipFile(temppath,_0x2a5979[_0x3aa84f(0x270)]);}}else logger[_0x3aa84f(0x167)](_0x3aa84f(0x25c));}else logger[_0x3aa84f(0x167)](_0x3aa84f(0x212));}),app[_0xaea5c(0x153)](express[_0xaea5c(0x219)](path['join'](__dirname,bbpath2,'build2'))),app[_0xaea5c(0x153)](express[_0xaea5c(0x219)](path[_0xaea5c(0x1de)](__dirname,bbpath2,_0xaea5c(0x2f0)))),app['get']('/',function(_0x5ea2f8,_0x35e986){const _0x2e02d4=_0xaea5c;_0x35e986[_0x2e02d4(0x1ad)](path[_0x2e02d4(0x1de)](__dirname,bbpath2,_0x2e02d4(0x207),_0x2e02d4(0x293)));}),app['get'](_0xaea5c(0x131),function(_0x42ae30,_0x39ddc2){const _0x29604a=_0xaea5c;_0x39ddc2[_0x29604a(0x1ad)](path[_0x29604a(0x1de)](__dirname,bbpath2,'build',_0x29604a(0x293)));}),app['get']('/:bot/portfolio',(_0x499bd4,_0x319f49)=>{const _0x1ca714=_0xaea5c;_0x319f49[_0x1ca714(0x1ad)](path[_0x1ca714(0x1de)](__dirname,bbpath2,'build','index.html'));}),app[_0xaea5c(0x1b8)](_0xaea5c(0x2ee),(_0x185d96,_0x4e6206)=>{const _0xe24616=_0xaea5c;_0x4e6206[_0xe24616(0x1ad)](path[_0xe24616(0x1de)](__dirname,bbpath2,_0xe24616(0x2f0),_0xe24616(0x293)));}),app[_0xaea5c(0x1b8)](_0xaea5c(0x1c2),(_0x255ccc,_0x43175f)=>{const _0x32085a=_0xaea5c;_0x43175f[_0x32085a(0x1ad)](path[_0x32085a(0x1de)](__dirname,bbpath2,_0x32085a(0x2f0),_0x32085a(0x293)));}),app[_0xaea5c(0x1b8)]('/:bot/history',(_0x83e04a,_0x11e3a0)=>{const _0x2b1c75=_0xaea5c;_0x11e3a0[_0x2b1c75(0x1ad)](path[_0x2b1c75(0x1de)](__dirname,bbpath2,_0x2b1c75(0x2f0),_0x2b1c75(0x293)));}),app[_0xaea5c(0x1b8)]('/:bot/configuration',(_0x571c73,_0xf0fbee)=>{const _0x363772=_0xaea5c;_0xf0fbee[_0x363772(0x1ad)](path[_0x363772(0x1de)](__dirname,bbpath2,_0x363772(0x2f0),_0x363772(0x293)));}),app[_0xaea5c(0x1b8)](_0xaea5c(0x1c7),(_0x57c174,_0x412191)=>{const _0xa0a1a2=_0xaea5c;_0x412191[_0xa0a1a2(0x1ad)](path[_0xa0a1a2(0x1de)](__dirname,bbpath2,_0xa0a1a2(0x2f0),'index.html'));});if(HOST)http[_0xaea5c(0x1b9)](PORT,HOST);else http['listen'](PORT);const io=require(_0xaea5c(0x210))(http,{});openBrowser&&(async()=>{const _0x3da60f=_0xaea5c,{default:_0x382b97}=await import(_0x3da60f(0x30c));await _0x382b97(_0x3da60f(0x34f)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x774b6f=_0xaea5c;let _0x2b5695=_0x774b6f(0x32a);const _0x18e9e6=networkInterfaces(),_0x4b727f={};for(const _0x169588 of Object[_0x774b6f(0x1a8)](_0x18e9e6)){for(const _0x528b24 of _0x18e9e6[_0x169588]){if((_0x528b24['family']=='IPv4'||_0x528b24['family']==0x4)&&!_0x528b24[_0x774b6f(0x1c5)]){const _0x1cd6a7=ipaddr[_0x774b6f(0x18c)](_0x528b24[_0x774b6f(0x19c)])[_0x774b6f(0x2ab)]();_0x1cd6a7!=_0x774b6f(0x1d8)&&(!_0x4b727f[_0x169588]&&(_0x4b727f[_0x169588]=[]),_0x4b727f[_0x169588]['push'](_0x528b24[_0x774b6f(0x19c)]),_0x2b5695=_0x528b24[_0x774b6f(0x19c)]);}}}return{'serverip':_0x2b5695,'netinterfaces':_0x4b727f};}async function startServer(){const _0x21af22=_0xaea5c,{serverip:_0x3786d8,netinterfaces:_0x553532}=getServerIP();logger[_0x21af22(0x197)](''),logger[_0x21af22(0x197)](_0x21af22(0x2ef)),await logger[_0x21af22(0x167)](_0x21af22(0x1af)+serverversion+_0x21af22(0x14b)+(environment==_0x21af22(0x233)?_0x21af22(0x16a):'')+'\x0a'+('=>\x20Go\x20to\x20#CYA#http://127.0.0.1:'+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x21af22(0x318)+_0x3786d8+':'+PORT+_0x21af22(0x1df))),logger[_0x21af22(0x197)](_0x21af22(0x2ef));if(config[_0x21af22(0x2f9)]!=0x0)for(const _0x16617d of config){const _0x3d26ae=_0x16617d[_0x21af22(0x32d)]==_0x21af22(0x184)?'a':'m';if(_0x16617d[_0x21af22(0x2e7)]==_0x21af22(0x1f6)||_0x16617d[_0x21af22(0x2e7)]==_0x21af22(0x276))await logger['full'](_0x21af22(0x19d)+_0x3d26ae+_0x21af22(0x255)+_0x16617d[_0x21af22(0x136)]+_0x21af22(0x1b3)+_0x16617d[_0x21af22(0x1da)]),startBot([_0x16617d[_0x21af22(0x136)],userID],{'cwd':bbpath},function(_0x335a6c){if(_0x335a6c)logger['full'](_0x335a6c);});else(_0x16617d[_0x21af22(0x2e7)]=='disabled'||_0x16617d['status']==_0x21af22(0x17b))&&await logger['full'](_0x21af22(0x303)+_0x3d26ae+_0x21af22(0x323)+_0x16617d[_0x21af22(0x136)]+_0x21af22(0x1b3)+_0x16617d[_0x21af22(0x1da)]);}else!newBot&&logger[_0x21af22(0x197)](_0x21af22(0x335));if(newBot)addBot();logger[_0x21af22(0x197)](_0x21af22(0x2ef)),logger[_0x21af22(0x197)](''),await logger['debug'](_0x21af22(0x177)+nodeversion),await logger['debug'](_0x21af22(0x2d2),_0x553532);}function startSocket(){io['on']('connection',_0x38b8ac=>{const _0x2cd2cd=_0x5771;let _0x18b3a0,_0x230d29,_0x140972,_0x55a472,_0x3b849c;const _0x10438e=_0x38b8ac[_0x2cd2cd(0x1eb)][_0x2cd2cd(0x12e)][_0x2cd2cd(0x33f)];_0x230d29=_0x10438e[_0x2cd2cd(0x1a3)](/bot[0-9]{3}/);if(_0x230d29)_0x140972=_0x230d29[0x0][_0x2cd2cd(0x1a3)](/[0-9]{3}/);if(_0x140972)_0x18b3a0=_0x140972[0x0];else _0x18b3a0=_0x2cd2cd(0x2a7);const _0x4d9627=_0x38b8ac[_0x2cd2cd(0x1eb)][_0x2cd2cd(0x313)][_0x2cd2cd(0x347)];if(!_0x4d9627)_0x38b8ac['emit'](_0x2cd2cd(0x2e7),{'publicKey':secure[_0x2cd2cd(0x260)]});else{_0x55a472=timelyDecrypt(_0x4d9627,![]);if(!_0x55a472)_0x38b8ac[_0x2cd2cd(0x22c)]('status',{'publicKey':secure[_0x2cd2cd(0x260)]});else{_0x3b849c=normalizeIP(_0x38b8ac[_0x2cd2cd(0x15a)][_0x2cd2cd(0x1b2)])[_0x2cd2cd(0x294)];if(!devices[_0x55a472])devices[_0x55a472]={'uuid':_0x55a472,'access':{'token':null}};devices[_0x55a472]['ip']=_0x3b849c;const _0x2ac359=addClient(_0x38b8ac['id'],_0x55a472,_0x18b3a0);setAccess(_0x2ac359),emitMessages(),_0x38b8ac['on'](_0x2cd2cd(0x29e),_0x90737c=>{const _0x1df39c=_0x2cd2cd,_0x38172c=timelyDecrypt(_0x90737c['password'],!![],_0x1df39c(0x157));if(_0x38172c){_0x90737c={'username':_0x90737c['username'],'password':_0x38172c},devices[_0x55a472][_0x1df39c(0x178)]=validateCredentials(_0x90737c,_0x55a472);if(devices[_0x55a472][_0x1df39c(0x178)]['allow']==![]&&devices[_0x55a472][_0x1df39c(0x178)]['reason']==_0x1df39c(0x31b))_0x38b8ac[_0x1df39c(0x22c)](_0x1df39c(0x2e7),{'access':devices[_0x55a472][_0x1df39c(0x178)]}),loginAccess2FA(_0x55a472,_0x3b849c);else{if(devices[_0x55a472][_0x1df39c(0x178)][_0x1df39c(0x324)]==![]&&devices[_0x55a472][_0x1df39c(0x178)]['reason']==_0x1df39c(0x209))_0x38b8ac['emit']('status',{'access':devices[_0x55a472][_0x1df39c(0x178)]});else devices[_0x55a472]['access'][_0x1df39c(0x324)]&&devices[_0x55a472][_0x1df39c(0x178)][_0x1df39c(0x2af)]==_0x1df39c(0x1f9)&&(getClientsWithUuid(_0x55a472)[_0x1df39c(0x2be)](_0x376797=>{setAccess(_0x376797);}),logger['debug'](_0x1df39c(0x33a)+_0x55a472[_0x1df39c(0x137)](-0x8)),setTokenRefresh(_0x55a472),setSessionTimeout('login',_0x55a472));}}else logger['full']('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x38b8ac['on'](_0x2cd2cd(0x1d1),()=>{resetPassword();}),_0x38b8ac['on']('disconnect',_0x28446f=>{removeClient(_0x38b8ac['id']);}),_0x18b3a0==_0x2cd2cd(0x2a7)&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x596a4b){const _0x18058a=_0xaea5c;if(_0x596a4b!=_0x18058a(0x2a7)&&config[_0x18058a(0x310)]!=''){if(pid[_0x596a4b])pid[_0x596a4b]['send']({'function':_0x18058a(0x23e),'args':null});}_0x596a4b!=_0x18058a(0x2a7)&&broadcastToBots(_0x18058a(0x315),JSON[_0x18058a(0x1c1)](config));}function reloadBotManager(){const _0xf7b972=_0xaea5c;getClientsWithBotID(_0xf7b972(0x2a7))[_0xf7b972(0x2be)](_0x95586b=>{const _0x5a252c=_0xf7b972;getSocket(_0x95586b['id'])['emit']('status',{'access':{'allow':![],'reason':_0x5a252c(0x15c),'token':null}});});}function getSocket(_0x39a9dd){const _0x2d63f7=_0xaea5c,_0x1ae1d6=io[_0x2d63f7(0x289)][_0x2d63f7(0x1b8)]('/');return _0x1ae1d6[_0x2d63f7(0x2ac)]['get'](_0x39a9dd);}function setAccess(_0x3cd7ac){const _0x1d4682=_0xaea5c,_0x28bd67=getSocket(_0x3cd7ac['id']),_0xc68ea9=_0x3cd7ac[_0x1d4682(0x1f4)],_0x2c43eb=_0x3cd7ac[_0x1d4682(0x130)];devices[_0xc68ea9]['access']=validateAccess(devices[_0xc68ea9][_0x1d4682(0x178)][_0x1d4682(0x234)],_0xc68ea9),logger[_0x1d4682(0x182)](_0x1d4682(0x2eb)+devices[_0xc68ea9][_0x1d4682(0x178)][_0x1d4682(0x2af)]+_0x1d4682(0x2a4)+_0x3cd7ac['id'][_0x1d4682(0x137)](-0x8)+_0x1d4682(0x2b6)+_0xc68ea9[_0x1d4682(0x137)](-0x8)),_0x28bd67['join'](_0xc68ea9);if(devices[_0xc68ea9][_0x1d4682(0x178)][_0x1d4682(0x324)]){_0x28bd67[_0x1d4682(0x1de)](_0x2c43eb);if(_0x2c43eb==_0x1d4682(0x2a7))initializeSocketBotManager(_0x28bd67);else initializeSocketBot(_0x28bd67);initClient(_0x2c43eb);}devices[_0xc68ea9][_0x1d4682(0x178)][_0x1d4682(0x234)]&&devices[_0xc68ea9]['access'][_0x1d4682(0x2af)]==_0x1d4682(0x1e1)&&setSessionTimeout(_0x1d4682(0x2a5),_0xc68ea9),devices[_0xc68ea9][_0x1d4682(0x178)][_0x1d4682(0x234)]&&devices[_0xc68ea9][_0x1d4682(0x178)][_0x1d4682(0x2af)]=='2FA\x20login\x20token\x20generated'&&setSessionTimeout(_0x1d4682(0x29e),_0xc68ea9),_0x28bd67['emit']('status',{'status':_0x3cd7ac['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0xc68ea9][_0x1d4682(0x178)],'externalip':devices[_0xc68ea9]['ip'],'publicKey':secure[_0x1d4682(0x260)],'userid':settings[_0x1d4682(0x33d)],'validInstallation':validInstallation}),devices[_0xc68ea9][_0x1d4682(0x178)][_0x1d4682(0x324)]==![]&&devices[_0xc68ea9]['access'][_0x1d4682(0x2af)]==_0x1d4682(0x258)&&temporaryAccess2FA(_0xc68ea9,devices[_0xc68ea9]['ip']);}function setSessionTimeout(_0x43c16b,_0x21732c){const _0x148595=_0xaea5c;let _0x135b39;if(_0x43c16b=='login')_0x135b39=loginExpiry*0x3c*0x3e8;else _0x135b39=devices[_0x21732c][_0x148595(0x232)][_0x148595(0x2b1)]*0x3c*0x3e8-(new Date()[_0x148595(0x1f3)]()-devices[_0x21732c][_0x148595(0x232)][_0x148595(0x33e)]);if(devices[_0x21732c]['pidExpireLogin'])clearTimeout(devices[_0x21732c]['pidExpireLogin']);devices[_0x21732c][_0x148595(0x1bc)]=setTimeout(()=>{const _0x1bbf88=_0x148595;if(devices[_0x21732c][_0x1bbf88(0x13d)])clearTimeout(devices[_0x21732c][_0x1bbf88(0x13d)]);removeSocketListeners(_0x21732c),addBlacklist(_0x21732c),devices[_0x21732c][_0x1bbf88(0x232)]=null,devices[_0x21732c][_0x1bbf88(0x1e9)]=null,devices[_0x21732c][_0x1bbf88(0x178)][_0x1bbf88(0x234)]=null,logger[_0x1bbf88(0x182)](_0x1bbf88(0x27d)+_0x21732c[_0x1bbf88(0x137)](-0x8)),devices[_0x21732c][_0x1bbf88(0x178)]=validateAccess(devices[_0x21732c][_0x1bbf88(0x178)]['token'],_0x21732c),!(devices[_0x21732c][_0x1bbf88(0x178)]['allow']&&devices[_0x21732c][_0x1bbf88(0x178)]['reason']==_0x1bbf88(0x1dc))&&(_0x43c16b==_0x1bbf88(0x29e)?io['to'](_0x21732c)[_0x1bbf88(0x22c)]('status',{'access':{'allow':![],'reason':_0x1bbf88(0x176),'token':null}}):io['to'](_0x21732c)[_0x1bbf88(0x22c)](_0x1bbf88(0x2e7),{'access':{'allow':![],'reason':_0x1bbf88(0x24e),'token':null}})),devices[_0x21732c][_0x1bbf88(0x178)][_0x1bbf88(0x234)]=null;},_0x135b39);}function setTokenRefresh(_0x301641){const _0xfe8f63=_0xaea5c;if(devices[_0x301641]['pidRefreshToken'])clearTimeout(devices[_0x301641][_0xfe8f63(0x13d)]);devices[_0x301641][_0xfe8f63(0x13d)]=setTimeout(()=>{const _0x62d8c2=_0xfe8f63;getClientsWithUuid(_0x301641)[_0x62d8c2(0x2f9)]!=0x0?(devices[_0x301641]['access']=refreshToken(_0x301641),io['to'](_0x301641)[_0x62d8c2(0x22c)](_0x62d8c2(0x2e7),{'status':_0x62d8c2(0x206),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x301641]['access'],'externalip':devices[_0x301641]['ip'],'publicKey':secure[_0x62d8c2(0x260)],'validInstallation':validInstallation}),setTokenRefresh(_0x301641)):clearTimeout(devices[_0x301641][_0x62d8c2(0x13d)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x35ca8c){const _0x58d30b=_0xaea5c,_0x27a69d=getClient(_0x35ca8c['id'])['uuid'];_0x35ca8c['emit'](_0x58d30b(0x315),config),_0x35ca8c[_0x58d30b(0x22c)](_0x58d30b(0x343),cleanSettings()),_0x35ca8c['on']('add-bot',_0x529d83=>{const _0x932baa=_0x58d30b;if(validateAccess(_0x529d83,_0x27a69d)[_0x932baa(0x324)])addBot();else logger[_0x932baa(0x167)](_0x932baa(0x145));}),_0x35ca8c['on']('update-bot',(_0x37643b,_0x42fe77)=>{const _0x47d3a5=_0x58d30b;if(validateAccess(_0x42fe77,_0x27a69d)['allow'])toggleBot(_0x37643b['botID'],_0x37643b[_0x47d3a5(0x2e7)],_0x37643b[_0x47d3a5(0x193)]);else logger[_0x47d3a5(0x167)](_0x47d3a5(0x1b1));}),_0x35ca8c['on'](_0x58d30b(0x280),(_0x5212b3,_0xe0a655)=>{const _0x3adcea=_0x58d30b;if(validateAccess(_0xe0a655,_0x27a69d)[_0x3adcea(0x324)])toggleBotMode(_0x5212b3);else logger[_0x3adcea(0x167)](_0x3adcea(0x1b1));}),_0x35ca8c['on']('delete-bot',(_0x1a32e6,_0x528c35)=>{const _0x360f12=_0x58d30b;if(validateAccess(_0x528c35,_0x27a69d)['allow'])deleteBot(_0x1a32e6);else logger[_0x360f12(0x167)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x35ca8c['on'](_0x58d30b(0x1aa),(_0x38c699,_0x5bcec7)=>{const _0x1ed294=_0x58d30b;if(validateAccess(_0x5bcec7,_0x27a69d)[_0x1ed294(0x324)])storeSettings(_0x38c699,!![]);else logger[_0x1ed294(0x167)](_0x1ed294(0x290));}),_0x35ca8c['on'](_0x58d30b(0x22a),_0x374522=>{const _0x19175b=_0x58d30b;if(validateAccess(_0x374522,_0x27a69d)[_0x19175b(0x324)])updateBB('update');else logger[_0x19175b(0x167)](_0x19175b(0x147));}),_0x35ca8c['on'](_0x58d30b(0x283),_0x598232=>{const _0x10595c=_0x58d30b;if(validateAccess(_0x598232,_0x27a69d)[_0x10595c(0x324)])updateBB(_0x10595c(0x261));else logger['full'](_0x10595c(0x1ac));}),_0x35ca8c['on'](_0x58d30b(0x17f),_0x44fcbc=>{const _0x358606=_0x58d30b;if(validateAccess(_0x44fcbc,_0x27a69d)[_0x358606(0x324)]){const _0x144780=getClient(_0x35ca8c['id']);if(_0x144780)getBackupFiles(_0x144780[_0x358606(0x1f4)]);else logger[_0x358606(0x167)](_0x358606(0x314));}else logger['full'](_0x358606(0x2d6));}),_0x35ca8c['on'](_0x58d30b(0x2bd),(_0x45a4f8,_0x4f594e)=>{const _0x10679d=_0x58d30b;if(validateAccess(_0x4f594e,_0x27a69d)['allow'])restoreBackupFile(_0x45a4f8);else logger['full'](_0x10679d(0x199));}),_0x35ca8c['on'](_0x58d30b(0x19f),_0x13077b=>{const _0x4e3eeb=_0x58d30b;if(validateAccess(_0x13077b,_0x27a69d)[_0x4e3eeb(0x324)])getMessages();else logger[_0x4e3eeb(0x167)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x35ca8c['on'](_0x58d30b(0x341),(_0x4df2ff,_0x43a4e7)=>{const _0x6e506=_0x58d30b;if(validateAccess(_0x43a4e7,_0x27a69d)[_0x6e506(0x324)])confirmMessage(_0x4df2ff);else logger[_0x6e506(0x167)](_0x6e506(0x146));}),_0x35ca8c['on']('logout',_0x5a386d=>{const _0x40b7c1=_0x58d30b;if(validateAccess(_0x5a386d,_0x27a69d)[_0x40b7c1(0x324)]){if(devices[_0x27a69d][_0x40b7c1(0x13d)])clearTimeout(devices[_0x27a69d][_0x40b7c1(0x13d)]);if(devices[_0x27a69d][_0x40b7c1(0x1bc)])clearTimeout(devices[_0x27a69d][_0x40b7c1(0x1bc)]);removeSocketListeners(getClient(_0x35ca8c['id'])[_0x40b7c1(0x1f4)]),addBlacklist(_0x27a69d),devices[_0x27a69d][_0x40b7c1(0x232)]=null,devices[_0x27a69d]['telegram2FaApproval']=null,devices[_0x27a69d][_0x40b7c1(0x178)][_0x40b7c1(0x234)]=null,logger['debug']('Logged\x20out\x20user\x20...'+_0x27a69d[_0x40b7c1(0x137)](-0x8)),io['to'](getClient(_0x35ca8c['id'])[_0x40b7c1(0x1f4)])[_0x40b7c1(0x22c)](_0x40b7c1(0x2e7),{'access':{'allow':![],'reason':_0x40b7c1(0x2ec),'token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0x5ec555){const _0x40d690=_0xaea5c,_0x721b91=getClient(_0x5ec555['id'])['bot'],_0x2a8bd0=getClient(_0x5ec555['id'])['uuid'];_0x5ec555['on']('get-logs',(_0x5e84e4,_0x339a4b)=>{const _0xd256f5=_0x5771;if(validateAccess(_0x339a4b,_0x2a8bd0)['allow']){if(pid[_0x721b91])pid[_0x721b91][_0xd256f5(0x2d9)]({'function':_0xd256f5(0x183),'args':_0x5e84e4});}else logger['full'](_0xd256f5(0x34c));}),_0x5ec555['on']('delete-alerts',(_0x5bb8a4,_0x2953a5)=>{const _0x1dd2ec=_0x5771;if(validateAccess(_0x2953a5,_0x2a8bd0)[_0x1dd2ec(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x1dd2ec(0x2d9)]({'function':_0x1dd2ec(0x27a),'args':_0x5bb8a4});}else logger[_0x1dd2ec(0x167)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5ec555['on'](_0x40d690(0x139),(_0xd93961,_0x6aa2a2)=>{const _0x372968=_0x40d690;if(validateAccess(_0x6aa2a2,_0x2a8bd0)['allow']){if(pid[_0x721b91])pid[_0x721b91][_0x372968(0x2d9)]({'function':_0x372968(0x218),'args':_0xd93961});}else logger[_0x372968(0x167)](_0x372968(0x278));}),_0x5ec555['on'](_0x40d690(0x154),(_0x5422d6,_0x337c15)=>{const _0x3224b9=_0x40d690;if(validateAccess(_0x337c15,_0x2a8bd0)[_0x3224b9(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x3224b9(0x2d9)]({'function':_0x3224b9(0x2dd),'args':_0x5422d6});}else logger['full'](_0x3224b9(0x346));}),_0x5ec555['on'](_0x40d690(0x31e),(_0x3351a,_0xe0f35e)=>{const _0x5d3895=_0x40d690;if(validateAccess(_0xe0f35e,_0x2a8bd0)[_0x5d3895(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x5d3895(0x2d9)]({'function':_0x5d3895(0x159),'args':_0x3351a});}else logger['full'](_0x5d3895(0x28e));}),_0x5ec555['on']('store-fiat',(_0x1798f1,_0x5aa863)=>{const _0x455af0=_0x40d690;if(validateAccess(_0x5aa863,_0x2a8bd0)[_0x455af0(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x455af0(0x2d9)]({'function':'storeFiat','args':_0x1798f1});}else logger[_0x455af0(0x167)](_0x455af0(0x2d3));}),_0x5ec555['on'](_0x40d690(0x2c5),_0x1e46a9=>{const _0x32a24c=_0x40d690;if(validateAccess(_0x1e46a9,_0x2a8bd0)['allow']){if(pid[_0x721b91])pid[_0x721b91]['send']({'function':_0x32a24c(0x2cd),'args':null});}else logger[_0x32a24c(0x167)](_0x32a24c(0x26e));}),_0x5ec555['on'](_0x40d690(0x2fd),_0x5a0708=>{const _0x1e3c20=_0x40d690;if(validateAccess(_0x5a0708,_0x2a8bd0)[_0x1e3c20(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x1e3c20(0x2d9)]({'function':_0x1e3c20(0x2e9),'args':null});}else logger[_0x1e3c20(0x167)](_0x1e3c20(0x214));}),_0x5ec555['on'](_0x40d690(0x23b),(_0x3db4ac,_0x4a8e04)=>{const _0x26eaee=_0x40d690;if(validateAccess(_0x4a8e04,_0x2a8bd0)[_0x26eaee(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x26eaee(0x2d9)]({'function':_0x26eaee(0x20f),'args':_0x3db4ac});}else logger[_0x26eaee(0x167)](_0x26eaee(0x21c));}),_0x5ec555['on'](_0x40d690(0x1cb),_0x55a6e2=>{const _0x2763a7=_0x40d690;if(validateAccess(_0x55a6e2,_0x2a8bd0)[_0x2763a7(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x2763a7(0x2d9)]({'function':_0x2763a7(0x203),'args':null});}else logger[_0x2763a7(0x167)](_0x2763a7(0x300));}),_0x5ec555['on'](_0x40d690(0x2b2),_0x5efd01=>{const _0x466fe=_0x40d690;if(validateAccess(_0x5efd01,_0x2a8bd0)[_0x466fe(0x324)]){if(pid[_0x721b91])pid[_0x721b91][_0x466fe(0x2d9)]({'function':_0x466fe(0x192),'args':null});}else logger['full'](_0x466fe(0x22b));}),_0x5ec555['on'](_0x40d690(0x22a),_0x2286f4=>{const _0x52c6b8=_0x40d690;if(validateAccess(_0x2286f4,_0x2a8bd0)[_0x52c6b8(0x324)])updateBB(_0x52c6b8(0x1ed));else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot');}),_0x5ec555['on'](_0x40d690(0x19f),_0x45df8c=>{const _0x55f606=_0x40d690;if(validateAccess(_0x45df8c,_0x2a8bd0)[_0x55f606(0x324)])getMessages();else logger[_0x55f606(0x167)](_0x55f606(0x317));}),_0x5ec555['on'](_0x40d690(0x341),(_0x2fb3d1,_0x382d1b)=>{const _0x2c5ff1=_0x40d690;if(validateAccess(_0x382d1b,_0x2a8bd0)[_0x2c5ff1(0x324)])confirmMessage(_0x2fb3d1);else logger[_0x2c5ff1(0x167)](_0x2c5ff1(0x146));}),_0x5ec555['on'](_0x40d690(0x249),_0x3d8927=>{const _0x447d3e=_0x40d690;if(validateAccess(_0x3d8927,_0x2a8bd0)[_0x447d3e(0x324)]){if(devices[_0x2a8bd0][_0x447d3e(0x13d)])clearTimeout(devices[_0x2a8bd0]['pidRefreshToken']);if(devices[_0x2a8bd0][_0x447d3e(0x1bc)])clearTimeout(devices[_0x2a8bd0]['pidExpireLogin']);removeSocketListeners(getClient(_0x5ec555['id'])[_0x447d3e(0x1f4)]),addBlacklist(_0x2a8bd0),devices[_0x2a8bd0][_0x447d3e(0x232)]=null,devices[_0x2a8bd0]['telegram2FaApproval']=null,devices[_0x2a8bd0]['access'][_0x447d3e(0x234)]=null,logger['debug'](_0x447d3e(0x18e)+_0x2a8bd0[_0x447d3e(0x137)](-0x8)),io['to'](getClient(_0x5ec555['id'])[_0x447d3e(0x1f4)])[_0x447d3e(0x22c)]('status',{'access':{'allow':![],'reason':_0x447d3e(0x2ec),'token':null}});}else logger[_0x447d3e(0x167)](_0x447d3e(0x21b));});}function removeSocketListeners(_0x1bba51){const _0x4b6587=_0xaea5c;getClientsWithUuid(_0x1bba51)[_0x4b6587(0x2be)](_0x553a91=>{const _0x2061c0=_0x4b6587;getSocket(_0x553a91['id'])[_0x2061c0(0x2bb)]();});}function cleanSettings(){const _0x12f680=_0xaea5c;let _0x1a2fb8=settings;return settings['telegramToken']&&settings[_0x12f680(0x28d)]!=''&&(_0x1a2fb8={..._0x1a2fb8,'telegramToken':_0x12f680(0x257)}),settings['bbPassword']&&settings[_0x12f680(0x244)]!=''&&(_0x1a2fb8={..._0x1a2fb8,'bbPassword':_0x12f680(0x257)}),settings[_0x12f680(0x345)]&&settings[_0x12f680(0x345)]!=''&&(_0x1a2fb8={..._0x1a2fb8,'marketcapApi':_0x12f680(0x257)}),(settings[_0x12f680(0x244)]&&settings[_0x12f680(0x244)]==_0x12f680(0x29d)||settings['telegramToken']&&settings['telegramToken']==_0x12f680(0x29d)||settings[_0x12f680(0x345)]&&settings[_0x12f680(0x345)]=='***')&&(_0x1a2fb8={..._0x1a2fb8,'restored':{'password':settings[_0x12f680(0x244)]==_0x12f680(0x29d),'telegram':settings[_0x12f680(0x28d)]=='***','marketcap':settings[_0x12f680(0x345)]==_0x12f680(0x29d)}}),_0x1a2fb8;}async function updateBB(_0x3333ef){const _0x13ac2d=_0xaea5c;await backupConfigFiles(),installingUpdate=!![],config[_0x13ac2d(0x2be)](_0x37a163=>{const _0xad6f34=_0x13ac2d;restartBot(_0x37a163[_0xad6f34(0x136)]);});if(_0x3333ef==_0x13ac2d(0x1ed))process[_0x13ac2d(0x2d9)]({'update':!![],'environment':environment},_0x1044ec=>{});else _0x3333ef==_0x13ac2d(0x261)&&process[_0x13ac2d(0x2d9)]({'reinstall':!![],'environment':environment},_0x3d0627=>{});}function startBot(_0x38c9b7,_0x4195c7,_0x4b533f){const _0x552f0f=_0xaea5c;if(debugging)_0x38c9b7[_0x552f0f(0x2f1)]('-d');if(recreate)_0x38c9b7[_0x552f0f(0x2f1)]('-r');let _0x1a1f4d=![];const _0x40ae4e=_0x38c9b7[0x0];_0x4195c7={..._0x4195c7,'stdio':[_0x552f0f(0x30d),_0x552f0f(0x30d),_0x552f0f(0x30d),_0x552f0f(0x281)]},pid[_0x40ae4e]=childProcess[_0x552f0f(0x17a)](botfile,_0x38c9b7,_0x4195c7),pid[_0x40ae4e]['on'](_0x552f0f(0x2ae),_0x11feef=>{const _0x4c383d=_0x552f0f;switch(Object['keys'](_0x11feef)[0x0]){case _0x4c383d(0x1da):updateBotName(_0x40ae4e,_0x11feef[_0x4c383d(0x1da)]);break;case _0x4c383d(0x2e5):updateBotManager();break;case _0x4c383d(0x2e7):updateStatus(_0x40ae4e,_0x11feef[_0x4c383d(0x2e7)]);break;case _0x4c383d(0x193):updateLive(_0x40ae4e,_0x11feef[_0x4c383d(0x193)]);break;case _0x4c383d(0x24f):updateLive(_0x40ae4e,_0x11feef[_0x4c383d(0x24f)]),io['to'](_0x40ae4e)[_0x4c383d(0x22c)](_0x4c383d(0x2e7),{'access':{'allow':![],'reason':_0x4c383d(0x15c),'token':null}});break;case _0x4c383d(0x156):_0x11feef[_0x4c383d(0x156)]==_0x4c383d(0x2fb)&&restartBot(_0x40ae4e);_0x11feef[_0x4c383d(0x156)]==_0x4c383d(0x208)&&toggleBot(_0x40ae4e,_0x4c383d(0x1d5),'stopped');break;case _0x4c383d(0x1f2):sendTelegramBot(_0x40ae4e,_0x11feef[_0x4c383d(0x1f2)]);break;case _0x4c383d(0x266):sendTelegramMsg(_0x11feef[_0x4c383d(0x266)]);break;case _0x4c383d(0x350):io['to'](_0x40ae4e)[_0x4c383d(0x22c)](_0x11feef['function'],_0x11feef[_0x4c383d(0x312)]);break;}}),pid[_0x40ae4e]['on'](_0x552f0f(0x1c3),function(_0x1bdfac){if(_0x1a1f4d)return;_0x1a1f4d=!![],_0x4b533f(_0x1bdfac);}),pid[_0x40ae4e]['on']('exit',async function(_0x4b726f){const _0x28bc54=_0x552f0f;if(terminating)return;if(installingUpdate){io['close']();return;}if(_0x1a1f4d)return;_0x1a1f4d=!![],_0x4b533f(null);const _0xdb90b0=dbConfig[_0x28bc54(0x1b8)](_0x28bc54(0x315))[_0x28bc54(0x322)]({'botID':_0x40ae4e})[_0x28bc54(0x1ee)]();_0xdb90b0&&(_0xdb90b0['status']==_0x28bc54(0x1f6)||_0xdb90b0[_0x28bc54(0x2e7)]==_0x28bc54(0x276))&&(await sleep(0x3e8),updateLive(_0x40ae4e,_0x28bc54(0x298)),logger[_0x28bc54(0x167)](_0x28bc54(0x2ad)+botRef(_0x40ae4e)),startBot([_0x40ae4e,userID],{'cwd':bbpath},function(_0x1e8837){const _0x278cd5=_0x28bc54;if(_0x1e8837)logger[_0x278cd5(0x167)](_0x1e8837);}));});}function stopBot(_0x4784d5){const _0x42f723=_0xaea5c;getClientsWithBotID(_0x4784d5)[_0x42f723(0x2be)](_0x919007=>{const _0x3112bd=_0x42f723;getSocket(_0x919007['id'])[_0x3112bd(0x173)](!![]),removeClient(_0x919007['id']);}),pid[_0x4784d5]&&(pid[_0x4784d5][_0x42f723(0x208)](),pid[_0x4784d5]=null);}function stopAllBots(){const _0x573813=_0xaea5c;terminating=!![];const _0x223fd4=getEnabledBots();_0x223fd4[_0x573813(0x2be)](_0x4b63b=>{const _0x109d43=_0x573813;stopBot(_0x4b63b[_0x109d43(0x136)]);});}function restartBot(_0x48331c){const _0x2b1227=_0xaea5c;if(pid[_0x48331c])pid[_0x48331c][_0x2b1227(0x208)]();}function addBot(){const _0x1ed270=_0xaea5c;let _0x1c6539;for(let _0x5b2958=0x1;_0x5b2958<0x3e9;_0x5b2958++){_0x1c6539=_0x5b2958['toString']()[_0x1ed270(0x1a2)](0x3,'0');let _0x427274=config[_0x1ed270(0x322)](_0x264f41=>_0x264f41[_0x1ed270(0x136)]==_0x1c6539);if(!_0x427274)break;}if(_0x1c6539===_0x1ed270(0x195)){logger['full']('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger[_0x1ed270(0x167)](_0x1ed270(0x326)+_0x1c6539),dbConfig[_0x1ed270(0x1b8)](_0x1ed270(0x315))[_0x1ed270(0x2f1)]({'botID':_0x1c6539,'botname':'Bot\x20'+_0x1c6539,'status':_0x1ed270(0x276),'live':''})['write'](),startBot([_0x1c6539,userID],{'cwd':bbpath},function(_0x40d714){const _0x14e862=_0x1ed270;if(_0x40d714)logger[_0x14e862(0x167)](_0x40d714);}),config=getConfiguration(),io['to'](_0x1ed270(0x2a7))[_0x1ed270(0x22c)]('bots',config),broadcastToBots('bots',JSON[_0x1ed270(0x1c1)](config));}function deleteBot(_0x3de28f){const _0x35fbf0=_0xaea5c;getClientsWithBotID(_0x3de28f)[_0x35fbf0(0x2be)](_0x5e33bc=>{const _0x13e5a2=_0x35fbf0;getSocket(_0x5e33bc['id'])[_0x13e5a2(0x173)](!![]),removeClient(_0x5e33bc['id']);}),dbConfig[_0x35fbf0(0x1b8)](_0x35fbf0(0x315))[_0x35fbf0(0x256)]({'botID':_0x3de28f})[_0x35fbf0(0x18b)](),logger[_0x35fbf0(0x167)](_0x35fbf0(0x202)+_0x3de28f),stopBot(_0x3de28f);try{if(fs[_0x35fbf0(0x29c)](path[_0x35fbf0(0x1de)](configpath,_0x35fbf0(0x2a0)+_0x3de28f+_0x35fbf0(0x2d5))))fs[_0x35fbf0(0x160)](path[_0x35fbf0(0x1de)](configpath,'bot-'+_0x3de28f+_0x35fbf0(0x2d5)));if(fs['existsSync'](path[_0x35fbf0(0x1de)](configpath,'bot-'+_0x3de28f+'-events.json')))fs[_0x35fbf0(0x160)](path['join'](configpath,'bot-'+_0x3de28f+'-events.json'));if(fs['existsSync'](path[_0x35fbf0(0x1de)](configpath,_0x35fbf0(0x2a0)+_0x3de28f+_0x35fbf0(0x201))))fs[_0x35fbf0(0x160)](path[_0x35fbf0(0x1de)](configpath,_0x35fbf0(0x2a0)+_0x3de28f+'-performance.json'));if(fs[_0x35fbf0(0x29c)](path[_0x35fbf0(0x1de)](configpath,_0x35fbf0(0x2a0)+_0x3de28f+_0x35fbf0(0x302))))fs[_0x35fbf0(0x160)](path[_0x35fbf0(0x1de)](configpath,_0x35fbf0(0x2a0)+_0x3de28f+_0x35fbf0(0x302)));}catch(_0x217c8b){if(_0x217c8b)logger['full'](_0x35fbf0(0x2c0),_0x217c8b);}config=getConfiguration(),io['to'](_0x35fbf0(0x2a7))[_0x35fbf0(0x22c)](_0x35fbf0(0x315),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleBot(_0x3fcdc9,_0x4c3fe6,_0x280995){const _0x28b221=_0xaea5c;dbConfig['get'](_0x28b221(0x315))['find']({'botID':_0x3fcdc9})[_0x28b221(0x33c)]({'status':_0x4c3fe6})[_0x28b221(0x33c)]({'live':_0x280995})[_0x28b221(0x18b)]();const _0x2eccae=botRef(_0x3fcdc9);if(_0x4c3fe6==_0x28b221(0x1f6)||_0x4c3fe6==_0x28b221(0x276))logger['full'](_0x28b221(0x2f2)+_0x2eccae),startBot([_0x3fcdc9,userID],{'cwd':bbpath},function(_0x5b7912){const _0x11223d=_0x28b221;if(_0x5b7912)logger[_0x11223d(0x167)](_0x5b7912);});else(_0x4c3fe6=='disabled'||_0x4c3fe6==_0x28b221(0x17b))&&(logger['full']('Disabled\x20'+_0x2eccae),stopBot(_0x3fcdc9));config=getConfiguration(),io['to'](_0x28b221(0x2a7))['emit']('bots',config),broadcastToBots(_0x28b221(0x315),JSON[_0x28b221(0x1c1)](config));}function toggleStatus(_0x553933){const _0x91ce42=_0xaea5c;let _0x3f3d64=dbConfig[_0x91ce42(0x1b8)](_0x91ce42(0x315))[_0x91ce42(0x322)]({'botID':_0x553933})['value'](),_0x55ba30;if(_0x3f3d64['status']==='enabled')_0x55ba30=_0x91ce42(0x1d5);else{if(_0x3f3d64[_0x91ce42(0x2e7)]===_0x91ce42(0x276))_0x55ba30='new-disabled';else{if(_0x3f3d64[_0x91ce42(0x2e7)]===_0x91ce42(0x17b))_0x55ba30='new';else{if(_0x3f3d64[_0x91ce42(0x2e7)]===_0x91ce42(0x1d5))_0x55ba30='enabled';}}}return _0x55ba30;}function updateStatus(_0x2aba93,_0x1cfad){const _0x518574=_0xaea5c;dbConfig[_0x518574(0x1b8)](_0x518574(0x315))[_0x518574(0x322)]({'botID':_0x2aba93})[_0x518574(0x33c)]({'status':_0x1cfad})['write'](),config=getConfiguration(),io['to'](_0x518574(0x2a7))[_0x518574(0x22c)]('bots',config),broadcastToBots('bots',JSON[_0x518574(0x1c1)](config));}function updateLive(_0x12155d,_0x2584ea){const _0x13aa58=_0xaea5c;dbConfig[_0x13aa58(0x1b8)]('bots')[_0x13aa58(0x322)]({'botID':_0x12155d})[_0x13aa58(0x33c)]({'live':_0x2584ea})[_0x13aa58(0x18b)](),config=getConfiguration(),io['to'](_0x13aa58(0x2a7))[_0x13aa58(0x22c)](_0x13aa58(0x315),config),broadcastToBots(_0x13aa58(0x315),JSON[_0x13aa58(0x1c1)](config));}function updateBotName(_0x2bff16,_0x2f2d07){const _0x43efa4=_0xaea5c;dbConfig[_0x43efa4(0x1b8)](_0x43efa4(0x315))[_0x43efa4(0x322)]({'botID':_0x2bff16})[_0x43efa4(0x33c)]({'botname':_0x2f2d07})[_0x43efa4(0x18b)](),config=getConfiguration(),io['to']('botmanager')['emit'](_0x43efa4(0x315),config),broadcastToBots(_0x43efa4(0x315),JSON[_0x43efa4(0x1c1)](config));}function updateBotManager(){const _0x5e9877=_0xaea5c;config=getConfiguration(),io['to']('botmanager')['emit'](_0x5e9877(0x315),config),broadcastToBots(_0x5e9877(0x315),JSON['stringify'](config));}function toggleBotMode(_0x59df08){const _0x4176b6=_0xaea5c;if(pid[_0x59df08])pid[_0x59df08]['send']({'function':_0x4176b6(0x1d0),'args':null});else{const _0x12ff8f=configpath+_0x4176b6(0x2a0)+_0x59df08+_0x4176b6(0x2d5),_0x5cca74=fs[_0x4176b6(0x339)](_0x12ff8f),_0x4cff28=JSON[_0x4176b6(0x18c)](_0x5cca74),_0x5b73a6=_0x4cff28[_0x4176b6(0x130)][0x0][_0x4176b6(0x285)];_0x4cff28[_0x4176b6(0x130)][0x0][_0x4176b6(0x285)]=!_0x5b73a6;const _0x4a2011=JSON[_0x4176b6(0x1c1)](_0x4cff28,null,0x2);fs[_0x4176b6(0x2f8)](_0x12ff8f,_0x4a2011),config=getConfiguration(),io['to']('botmanager')['emit'](_0x4176b6(0x315),config),broadcastToBots(_0x4176b6(0x315),JSON['stringify'](config));}}function validateTelegram(_0x45f80b){const _0x45d6ad=_0xaea5c;if(_0x45f80b['from']['username']!=settings[_0x45d6ad(0x332)]&&'@'+_0x45f80b[_0x45d6ad(0x226)]['username']!=settings[_0x45d6ad(0x332)]||_0x45f80b[_0x45d6ad(0x2ce)]['id']!=settings[_0x45d6ad(0x1e4)])return sendTelegram(_0x45f80b['chat']['id'],_0x45d6ad(0x1a6),{'parse_mode':_0x45d6ad(0x342)}),![];return!![];}function botRef(_0x4600b7){const _0x240cd9=_0xaea5c,_0x46ca3f=getBotAttributes(_0x4600b7),_0xb97e9e=_0x46ca3f[_0x240cd9(0x220)]?_0x46ca3f[_0x240cd9(0x1da)]:_0x240cd9(0x2b5)+_0x4600b7;return _0xb97e9e;}async function initTelegram(){const _0x23a5ad=_0xaea5c;tgBot&&(await tgBot[_0x23a5ad(0x156)](),await sleep(0x7d0));tgBot=new Telegraf(settings['telegramToken']);let _0x3a673b=_0x23a5ad(0x27b);_0x3a673b+='\x0a',_0x3a673b+=_0x23a5ad(0x148),_0x3a673b+='/disable\x20-\x20disable\x20notifications\x0a',_0x3a673b+=_0x23a5ad(0x14d),_0x3a673b+=_0x23a5ad(0x152),_0x3a673b+='/on\x20-\x20start\x20bot(s)\x0a',_0x3a673b+=_0x23a5ad(0x273),_0x3a673b+=_0x23a5ad(0x2ba),_0x3a673b+=_0x23a5ad(0x34e),_0x3a673b+=_0x23a5ad(0x2c7),_0x3a673b+='/metrics\x20-\x20show\x20bot\x20performance\x0a',_0x3a673b+=_0x23a5ad(0x264),_0x3a673b+=_0x23a5ad(0x240),_0x3a673b+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x3a673b+=_0x23a5ad(0x2e6),_0x3a673b+=_0x23a5ad(0x1ae),_0x3a673b+=_0x23a5ad(0x328);let _0x7bff96=_0x23a5ad(0x1dd);_0x7bff96+='\x0a',_0x7bff96+=_0x3a673b,tgBot[_0x23a5ad(0x287)]((_0xf56dca,_0x2c9c8e)=>{const _0x522067=_0x23a5ad;logger[_0x522067(0x197)](getTimeStamp()+_0x522067(0x2d0)),logger[_0x522067(0x182)](_0x522067(0x198),_0xf56dca);}),tgBot[_0x23a5ad(0x153)](async(_0x163bc2,_0x5487ac)=>{const _0x29c1c9=_0x23a5ad;if(settings[_0x29c1c9(0x1e4)]||_0x163bc2[_0x29c1c9(0x1ed)]['message'][_0x29c1c9(0x141)]!=_0x29c1c9(0x23c)){if(!validateTelegram(_0x163bc2))return;}_0x5487ac();}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x155),async _0x3b3228=>{const _0x533e08=_0x23a5ad;if(_0x3b3228['from']['username']==settings['telegramUsername']||'@'+_0x3b3228['from'][_0x533e08(0x1f8)]==settings[_0x533e08(0x332)]){if(!settings['telegramChatId'])updateSetting(_0x533e08(0x1e4),_0x3b3228[_0x533e08(0x2ce)]['id']);else{if(!validateTelegram(_0x3b3228))return;}}else{if(!validateTelegram(_0x3b3228))return;}updateSetting(_0x533e08(0x12a),!![]),await sendTelegram(_0x3b3228[_0x533e08(0x2ce)]['id'],_0x7bff96);}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x25f),async _0x622d2a=>{const _0x111e33=_0x23a5ad;updateSetting(_0x111e33(0x12a),!![]),await sendTelegram(_0x622d2a[_0x111e33(0x2ce)]['id'],_0x111e33(0x25d));}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x1c0),async _0x52bd3d=>{const _0x3a21da=_0x23a5ad;await sendTelegram(_0x52bd3d[_0x3a21da(0x2ce)]['id'],_0x3a21da(0x1c6)),updateSetting(_0x3a21da(0x12a),![]);}),tgBot[_0x23a5ad(0x1ca)]('config',async _0x54d21b=>{const _0x1d4c51=_0x23a5ad,_0x3b3bef=Markup[_0x1d4c51(0x190)]([Markup[_0x1d4c51(0x268)][_0x1d4c51(0x2ff)](_0x1d4c51(0x321),_0x1d4c51(0x1ce)),Markup[_0x1d4c51(0x268)][_0x1d4c51(0x2ff)](_0x1d4c51(0x2f6),_0x1d4c51(0x330)),Markup[_0x1d4c51(0x268)][_0x1d4c51(0x2ff)](_0x1d4c51(0x185),'config_all')]);_0x54d21b[_0x1d4c51(0x2b4)](_0x1d4c51(0x239),_0x3b3bef);}),tgBot[_0x23a5ad(0x17e)](_0x23a5ad(0x1ce),async _0x11b20d=>{const _0x265d23=_0x23a5ad;_0x11b20d[_0x265d23(0x2f5)](),updateSetting(_0x265d23(0x14f),'orders'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x11b20d[_0x265d23(0x2ce)]['id'],_0x265d23(0x21a));}),tgBot[_0x23a5ad(0x17e)]('config_alerts',async _0x10a60a=>{const _0x3b6b2b=_0x23a5ad;_0x10a60a['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x3b6b2b(0x253)),updateSetting(_0x3b6b2b(0x12a),!![]),await sendTelegram(_0x10a60a[_0x3b6b2b(0x2ce)]['id'],_0x3b6b2b(0x187));}),tgBot[_0x23a5ad(0x17e)](_0x23a5ad(0x179),async _0x8f845b=>{const _0x305d34=_0x23a5ad;_0x8f845b[_0x305d34(0x2f5)](),updateSetting('telegramEvents',_0x305d34(0x2ca)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x8f845b[_0x305d34(0x2ce)]['id'],_0x305d34(0x2e2));}),tgBot['command'](_0x23a5ad(0x2e7),async _0x3c85dd=>{const _0x6cc3b7=_0x23a5ad,_0x169bad=getBotsWithMode();let _0x7c8873=_0x6cc3b7(0x13e);config[_0x6cc3b7(0x2be)](_0x3e6ba9=>{const _0x275b67=_0x6cc3b7,_0x21d076=_0x169bad['find'](_0xaca17f=>_0xaca17f[_0x275b67(0x136)]==_0x3e6ba9[_0x275b67(0x136)])[_0x275b67(0x32d)];_0x7c8873+='Bot\x20'+_0x3e6ba9[_0x275b67(0x136)]+':\x20'+_0x3e6ba9['status']+_0x275b67(0x1b3)+_0x21d076+_0x275b67(0x1b3)+_0x3e6ba9[_0x275b67(0x193)]+'\x0a';}),_0x7c8873+='\x0a',_0x7c8873+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x7c8873+=!settings['telegramEnabled']?_0x6cc3b7(0x1a7):_0x6cc3b7(0x227),_0x7c8873+=settings['telegramEnabled']?settings['telegramEvents']==_0x6cc3b7(0x2ca)?_0x6cc3b7(0x1db):_0x6cc3b7(0x297)+settings[_0x6cc3b7(0x14f)]+_0x6cc3b7(0x20e):'',await sendTelegram(_0x3c85dd[_0x6cc3b7(0x2ce)]['id'],_0x7c8873,{'parse_mode':'HTML'});}),tgBot['command'](_0x23a5ad(0x2fb),async _0x149648=>{const _0x55f755=_0x23a5ad,_0x58d469=getEnabledBots();if(_0x58d469['length']==0x0)await sendTelegram(_0x149648[_0x55f755(0x2ce)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x58d469[_0x55f755(0x2f9)]>0x1)_0x58d469[_0x55f755(0x2f1)]({'botID':_0x55f755(0x2ca)});let _0x3f1fe7=[],_0x1d9b22=[];const _0x2d050a=_0x58d469['length']%0x4==0x0||_0x58d469[_0x55f755(0x2f9)]%0x4==0x3||_0x58d469[_0x55f755(0x2f9)]%0x3==0x1?0x4:0x3;let _0x21f2f1=0x0;_0x58d469[_0x55f755(0x2be)]((_0x50ae7e,_0x3e491b)=>{const _0x112a2d=_0x55f755;if(_0x3e491b%_0x2d050a==0x0)_0x1d9b22=[];_0x1d9b22[_0x112a2d(0x2f1)](Markup[_0x112a2d(0x268)][_0x112a2d(0x2ff)](_0x50ae7e['botID']==_0x112a2d(0x2ca)?'All\x20bots':botRef(_0x50ae7e['botID']),_0x112a2d(0x16f)+_0x50ae7e['botID'])),_0x3e491b%_0x2d050a==0x0&&(_0x3f1fe7[_0x21f2f1]=_0x1d9b22,_0x21f2f1++);});const _0x39117b=Markup[_0x55f755(0x190)](_0x3f1fe7);_0x149648[_0x55f755(0x2b4)]('Which\x20bot\x20do\x20you\x20want\x20to\x20restart?',_0x39117b);}}),tgBot[_0x23a5ad(0x17e)](/restart_(.+)/,async _0x40e9fb=>{const _0x232299=_0x23a5ad,_0x2c9d2e=_0x40e9fb[_0x232299(0x1a3)][0x1];_0x40e9fb['editMessageReplyMarkup'](),_0x2c9d2e==_0x232299(0x2ca)?config['forEach'](_0x38447e=>{restartBot(_0x38447e['botID']);}):restartBot(_0x2c9d2e);}),tgBot['command']('on',async _0x5e5ede=>{const _0x18ea66=_0x23a5ad,_0x532b56=getDisabledBots();if(_0x532b56[_0x18ea66(0x2f9)]==0x0)await sendTelegram(_0x5e5ede[_0x18ea66(0x2ce)]['id'],_0x18ea66(0x20a));else{if(_0x532b56['length']>0x1)_0x532b56[_0x18ea66(0x2f1)]({'botID':'all'});let _0x4d8483=[],_0x25a234=[];const _0x53bcac=_0x532b56[_0x18ea66(0x2f9)]%0x4==0x0||_0x532b56[_0x18ea66(0x2f9)]%0x4==0x3||_0x532b56[_0x18ea66(0x2f9)]%0x3==0x1?0x4:0x3;let _0x11587c=0x0;_0x532b56[_0x18ea66(0x2be)]((_0x2ded6f,_0x1af6fd)=>{const _0x290947=_0x18ea66;if(_0x1af6fd%_0x53bcac==0x0)_0x25a234=[];_0x25a234[_0x290947(0x2f1)](Markup['button'][_0x290947(0x2ff)](_0x2ded6f[_0x290947(0x136)]==_0x290947(0x2ca)?'All\x20bots':botRef(_0x2ded6f[_0x290947(0x136)]),_0x290947(0x309)+_0x2ded6f[_0x290947(0x136)])),_0x1af6fd%_0x53bcac==0x0&&(_0x4d8483[_0x11587c]=_0x25a234,_0x11587c++);});const _0x305734=Markup['inlineKeyboard'](_0x4d8483);_0x5e5ede[_0x18ea66(0x2b4)](_0x18ea66(0x2f7),_0x305734);}}),tgBot[_0x23a5ad(0x17e)](/on_(.+)/,async _0xf75668=>{const _0x4ab4b4=_0x23a5ad,_0x2731d6=_0xf75668[_0x4ab4b4(0x1a3)][0x1];_0xf75668[_0x4ab4b4(0x2f5)]();if(_0x2731d6==_0x4ab4b4(0x2ca)){const _0x160744=getDisabledBots();await sendTelegram(_0xf75668[_0x4ab4b4(0x2ce)]['id'],_0x4ab4b4(0x164)),_0x160744[_0x4ab4b4(0x2be)](_0x87b3a5=>{const _0x473fd6=_0x4ab4b4;if(_0x87b3a5[_0x473fd6(0x136)]!=_0x473fd6(0x2ca))toggleBot(_0x87b3a5[_0x473fd6(0x136)],toggleStatus(_0x87b3a5[_0x473fd6(0x136)]),_0x473fd6(0x298));});}else await sendTelegram(_0xf75668['chat']['id'],_0x4ab4b4(0x12b)+botRef(_0x2731d6)),toggleBot(_0x2731d6,toggleStatus(_0x2731d6),_0x4ab4b4(0x298));}),tgBot['command'](_0x23a5ad(0x2cb),async _0x3bd695=>{const _0x4d83f9=_0x23a5ad,_0x28e4cd=getEnabledBots();if(_0x28e4cd[_0x4d83f9(0x2f9)]==0x0)await sendTelegram(_0x3bd695['chat']['id'],_0x4d83f9(0x2a3));else{if(_0x28e4cd[_0x4d83f9(0x2f9)]>0x1)_0x28e4cd[_0x4d83f9(0x2f1)]({'botID':_0x4d83f9(0x2ca)});let _0x2cbcd6=[],_0x873ecc=[];const _0x4b7d31=_0x28e4cd[_0x4d83f9(0x2f9)]%0x4==0x0||_0x28e4cd[_0x4d83f9(0x2f9)]%0x4==0x3||_0x28e4cd[_0x4d83f9(0x2f9)]%0x3==0x1?0x4:0x3;let _0xd9917b=0x0;_0x28e4cd[_0x4d83f9(0x2be)]((_0x59d40e,_0x596faf)=>{const _0x5afa08=_0x4d83f9;if(_0x596faf%_0x4b7d31==0x0)_0x873ecc=[];_0x873ecc[_0x5afa08(0x2f1)](Markup[_0x5afa08(0x268)]['callback'](_0x59d40e['botID']=='all'?_0x5afa08(0x1e5):botRef(_0x59d40e[_0x5afa08(0x136)]),_0x5afa08(0x16b)+_0x59d40e[_0x5afa08(0x136)])),_0x596faf%_0x4b7d31==0x0&&(_0x2cbcd6[_0xd9917b]=_0x873ecc,_0xd9917b++);});const _0x372ba3=Markup['inlineKeyboard'](_0x2cbcd6);_0x3bd695[_0x4d83f9(0x2b4)](_0x4d83f9(0x2c8),_0x372ba3);}}),tgBot[_0x23a5ad(0x17e)](/off_(.+)/,async _0x3ab437=>{const _0x410c0e=_0x23a5ad,_0x160074=_0x3ab437['match'][0x1];_0x3ab437[_0x410c0e(0x2f5)]();if(_0x160074=='all'){const _0x2ba7c2=getEnabledBots();await sendTelegram(_0x3ab437[_0x410c0e(0x2ce)]['id'],_0x410c0e(0x135)),_0x2ba7c2[_0x410c0e(0x2be)](_0x9a13e6=>{const _0x5341c9=_0x410c0e;if(_0x9a13e6[_0x5341c9(0x136)]!=_0x5341c9(0x2ca))toggleBot(_0x9a13e6[_0x5341c9(0x136)],toggleStatus(_0x9a13e6['botID']),_0x5341c9(0x298));});}else await sendTelegram(_0x3ab437['chat']['id'],_0x410c0e(0x32f)+botRef(_0x160074)),toggleBot(_0x160074,toggleStatus(_0x160074),_0x410c0e(0x298));}),tgBot['command'](_0x23a5ad(0x158),async _0x1efa23=>{const _0x2961b0=_0x23a5ad,_0x3050ce=getEnabledBots();if(_0x3050ce[_0x2961b0(0x2f9)]==0x0)await sendTelegram(_0x1efa23[_0x2961b0(0x2ce)]['id'],_0x2961b0(0x2a3));else{if(_0x3050ce['length']>0x1){let _0x5f5cc8=[],_0x5f1025=[];const _0x214fdf=_0x3050ce[_0x2961b0(0x2f9)]%0x4==0x0||_0x3050ce[_0x2961b0(0x2f9)]%0x4==0x3||_0x3050ce[_0x2961b0(0x2f9)]%0x3==0x1?0x4:0x3;let _0x69f824=0x0;_0x3050ce[_0x2961b0(0x2be)]((_0x11ea4b,_0x1a2b66)=>{const _0x2d835b=_0x2961b0;if(_0x1a2b66%_0x214fdf==0x0)_0x5f1025=[];_0x5f1025[_0x2d835b(0x2f1)](Markup[_0x2d835b(0x268)][_0x2d835b(0x2ff)](botRef(_0x11ea4b[_0x2d835b(0x136)]),_0x2d835b(0x23a)+_0x11ea4b[_0x2d835b(0x136)])),_0x1a2b66%_0x214fdf==0x0&&(_0x5f5cc8[_0x69f824]=_0x5f1025,_0x69f824++);});const _0x4f4d62=Markup[_0x2961b0(0x190)](_0x5f5cc8);_0x1efa23[_0x2961b0(0x2b4)](_0x2961b0(0x259),_0x4f4d62);}else{const _0x3fb6ee=_0x3050ce[0x0][_0x2961b0(0x136)];if(pid[_0x3fb6ee])pid[_0x3fb6ee][_0x2961b0(0x2d9)]({'function':_0x2961b0(0x344),'args':null});}}}),tgBot['action'](/metrics_(.+)/,async _0x440cf2=>{const _0x1ae714=_0x23a5ad,_0x30c174=_0x440cf2['match'][0x1];_0x440cf2[_0x1ae714(0x2f5)]();if(pid[_0x30c174])pid[_0x30c174][_0x1ae714(0x2d9)]({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x1d6),async _0x38b0e9=>{const _0xe850da=_0x23a5ad,_0x373d4e=getEnabledBots();if(_0x373d4e[_0xe850da(0x2f9)]==0x0)await sendTelegram(_0x38b0e9[_0xe850da(0x2ce)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x373d4e[_0xe850da(0x2f9)]>0x1){let _0xc7f88a=[],_0x5f06f7=[];const _0x273b12=_0x373d4e[_0xe850da(0x2f9)]%0x4==0x0||_0x373d4e[_0xe850da(0x2f9)]%0x4==0x3||_0x373d4e[_0xe850da(0x2f9)]%0x3==0x1?0x4:0x3;let _0x4261d4=0x0;_0x373d4e['forEach']((_0x316daa,_0x2a7d75)=>{const _0x115401=_0xe850da;if(_0x2a7d75%_0x273b12==0x0)_0x5f06f7=[];_0x5f06f7[_0x115401(0x2f1)](Markup[_0x115401(0x268)][_0x115401(0x2ff)](botRef(_0x316daa[_0x115401(0x136)]),_0x115401(0x2ed)+_0x316daa[_0x115401(0x136)])),_0x2a7d75%_0x273b12==0x0&&(_0xc7f88a[_0x4261d4]=_0x5f06f7,_0x4261d4++);});const _0xfcf166=Markup[_0xe850da(0x190)](_0xc7f88a);_0x38b0e9['reply'](_0xe850da(0x26c),_0xfcf166);}else{const _0x3656b0=_0x373d4e[0x0]['botID'];if(pid[_0x3656b0])pid[_0x3656b0][_0xe850da(0x2d9)]({'function':_0xe850da(0x163),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x5bd026=>{const _0x1d3c6d=_0x23a5ad,_0x512838=_0x5bd026[_0x1d3c6d(0x1a3)][0x1];_0x5bd026[_0x1d3c6d(0x2f5)]();if(pid[_0x512838])pid[_0x512838]['send']({'function':_0x1d3c6d(0x163),'args':null});}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x254),async _0x476371=>{const _0x3289c=_0x23a5ad,_0x29526b=_0x3289c(0x254);await zipFiles(_0x29526b);const _0x2aec5f=zippath+(_0x29526b+'.zip');_0x476371[_0x3289c(0x352)]({'source':_0x2aec5f})['then'](()=>{})[_0x3289c(0x287)](_0x56972e=>logger[_0x3289c(0x182)](_0x3289c(0x25a)+_0x29526b+_0x3289c(0x331),_0x56972e));}),tgBot['command'](_0x23a5ad(0x12c),async _0x28c24f=>{const _0x29fbf0=_0x23a5ad,_0x5a847e=_0x29fbf0(0x12c);await backupConfigFiles(),await zipFiles(_0x5a847e);const _0x5015e4=zippath+(_0x5a847e+_0x29fbf0(0x138));_0x28c24f['replyWithDocument']({'source':_0x5015e4})['then'](()=>{})[_0x29fbf0(0x287)](_0x3c960e=>logger['debug']('Error\x20sending\x20'+_0x5a847e+_0x29fbf0(0x331),_0x3c960e));}),tgBot['command'](_0x23a5ad(0x1ed),async _0x366427=>{const _0x20300a=_0x23a5ad;await getMessages();if(!updateAvailable)await sendTelegram(_0x366427['chat']['id'],_0x20300a(0x17c));else{if(!validInstallation)await sendTelegram(_0x366427['chat']['id'],_0x20300a(0x28c));else{const _0x5903ea=Markup[_0x20300a(0x190)]([Markup[_0x20300a(0x268)][_0x20300a(0x2ff)](_0x20300a(0x2a2),_0x20300a(0x2dc)),Markup[_0x20300a(0x268)][_0x20300a(0x2ff)]('No',_0x20300a(0x16c))]);_0x366427[_0x20300a(0x2b4)](_0x20300a(0x1ec),_0x5903ea);}}}),tgBot[_0x23a5ad(0x17e)](/update_(.+)/,async _0x3482bd=>{const _0x268480=_0x23a5ad,_0x2f50a5=_0x3482bd[_0x268480(0x1a3)][0x1];_0x3482bd[_0x268480(0x2f5)](),_0x2f50a5==_0x268480(0x1d7)&&(await sendTelegram(_0x3482bd['chat']['id'],_0x268480(0x235)),updateBB(_0x268480(0x1ed))),_0x2f50a5=='no'&&await sendTelegram(_0x3482bd[_0x268480(0x2ce)]['id'],_0x268480(0x296));}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x261),async _0x42101d=>{const _0x168271=_0x23a5ad;if(!validInstallation)await sendTelegram(_0x42101d['chat']['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x4099d1=Markup['inlineKeyboard']([Markup[_0x168271(0x268)]['callback']('Yes',_0x168271(0x1d3)),Markup[_0x168271(0x268)][_0x168271(0x2ff)]('No',_0x168271(0x191))]);_0x42101d[_0x168271(0x2b4)]('Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?',_0x4099d1);}}),tgBot[_0x23a5ad(0x17e)](/reinstall_(.+)/,async _0x3302a0=>{const _0x82113b=_0x23a5ad,_0x61d609=_0x3302a0[_0x82113b(0x1a3)][0x1];_0x3302a0[_0x82113b(0x2f5)](),_0x61d609==_0x82113b(0x1d7)&&(await sendTelegram(_0x3302a0[_0x82113b(0x2ce)]['id'],_0x82113b(0x1a5)),updateBB(_0x82113b(0x261))),_0x61d609=='no'&&await sendTelegram(_0x3302a0[_0x82113b(0x2ce)]['id'],_0x82113b(0x1cc));}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x282),async _0xa69f43=>{const _0x4a3975=_0x23a5ad,_0x559290=getBotsWithMode();if(_0x559290[_0x4a3975(0x2f9)]==0x0)await sendTelegram(_0xa69f43[_0x4a3975(0x2ce)]['id'],_0x4a3975(0x2a3));else{let _0x1d6518=[],_0x50d77d=[];const _0x348906=0x2;let _0x56ec1b=0x0;_0x559290[_0x4a3975(0x2be)]((_0xf23a4f,_0x5c3397)=>{const _0x303fee=_0x4a3975;if(_0x5c3397%_0x348906==0x0)_0x50d77d=[];_0x50d77d[_0x303fee(0x2f1)](Markup[_0x303fee(0x268)]['callback'](botRef(_0xf23a4f['botID'])+'\x20('+_0xf23a4f[_0x303fee(0x32d)]+')',_0x303fee(0x1b5)+_0xf23a4f[_0x303fee(0x136)])),_0x5c3397%_0x348906==0x0&&(_0x1d6518[_0x56ec1b]=_0x50d77d,_0x56ec1b++);});const _0x36a32e=Markup[_0x4a3975(0x190)](_0x1d6518);_0xa69f43[_0x4a3975(0x2b4)](_0x4a3975(0x1ea),_0x36a32e);}}),tgBot['action'](/toggle_(.+)/,async _0x3e47b2=>{const _0x1971c6=_0x23a5ad,_0x55bd3d=_0x3e47b2['match'][0x1];_0x3e47b2[_0x1971c6(0x2f5)]();const _0x21ce01=getBotsWithMode(),_0x59a850=_0x21ce01['find'](_0x5a2a09=>_0x5a2a09['botID']==_0x55bd3d),_0x589008=_0x59a850[_0x1971c6(0x32d)]=='auto'?_0x1971c6(0x2d7):_0x1971c6(0x184);await sendTelegram(_0x3e47b2[_0x1971c6(0x2ce)]['id'],'Bot\x20Mgr\x20>\x20Toggling\x20'+botRef(_0x59a850[_0x1971c6(0x136)])+'\x20to\x20'+_0x589008+_0x1971c6(0x2a6)),toggleBotMode(_0x55bd3d);}),tgBot[_0x23a5ad(0x1ca)](_0x23a5ad(0x15f),async _0x5d2fee=>{const _0xefb273=_0x23a5ad;let _0x25e11d='';config[_0xefb273(0x2be)](_0x42bf80=>{const _0x51ae34=_0xefb273;_0x25e11d+=_0x51ae34(0x2b5)+_0x42bf80[_0x51ae34(0x136)]+':\x20'+_0x42bf80[_0x51ae34(0x1da)]+'\x0a';}),await sendTelegram(_0x5d2fee[_0xefb273(0x2ce)]['id'],_0x25e11d,{'parse_mode':_0xefb273(0x342)});}),tgBot['command'](_0x23a5ad(0x23f),async _0x451958=>{const _0x24b0a1=_0x23a5ad;await sendTelegram(_0x451958[_0x24b0a1(0x2ce)]['id'],_0x3a673b);}),process[_0x23a5ad(0x308)](_0x23a5ad(0x2d1),()=>tgBot[_0x23a5ad(0x156)]('SIGINT')),process[_0x23a5ad(0x308)](_0x23a5ad(0x30f),()=>tgBot[_0x23a5ad(0x156)]('SIGTERM')),tgBot[_0x23a5ad(0x22d)]();}function disableTelegram(){const _0x8d72ac=_0xaea5c;tgBot&&tgBot[_0x8d72ac(0x156)]();}async function sendTelegram(_0x40fda1,_0x183bf8,_0x180be9){const _0x11d467=_0xaea5c;_0x180be9={..._0x180be9,'disable_web_page_preview':!![]};try{await tgBot[_0x11d467(0x1f2)][_0x11d467(0x25e)](_0x40fda1,_0x183bf8,_0x180be9);}catch(_0x1a007d){logger[_0x11d467(0x182)]('Telegram\x20error:',_0x1a007d);}}async function sendTelegramBot(_0x55b7b6,_0x2a9606){const _0x671079=_0xaea5c;if(settings[_0x671079(0x12a)]){if(settings[_0x671079(0x14f)]==_0x671079(0x2ca)||(_0x2a9606[_0x671079(0x2a8)]==_0x671079(0x1c3)||_0x2a9606['type']=='warning'||_0x2a9606[_0x671079(0x2a8)]==_0x671079(0x216))&&settings[_0x671079(0x14f)]==_0x671079(0x253)||_0x2a9606[_0x671079(0x2a8)]==_0x671079(0x295)&&settings['telegramEvents']==_0x671079(0x304)){if(tgBot&&settings[_0x671079(0x1e4)]){if(_0x2a9606[_0x671079(0x220)])await sendTelegram(settings['telegramChatId'],_0x2a9606[_0x671079(0x1da)]+_0x671079(0x21f)+_0x2a9606[_0x671079(0x1c9)]);else await sendTelegram(settings[_0x671079(0x1e4)],_0x671079(0x2b5)+_0x55b7b6+_0x671079(0x21f)+_0x2a9606['event']);}}}}async function sendTelegramMsg(_0x212ecb,_0x131235=_0xaea5c(0x342)){const _0xe75157=_0xaea5c;return tgBot&&settings[_0xe75157(0x1e4)]?(await sendTelegram(settings['telegramChatId'],_0x212ecb,{'parse_mode':_0x131235}),!![]):![];}function getDeviceWithIp(_0x29f8cb){const _0x276c7e=_0xaea5c;return devices[_0x276c7e(0x322)](_0x912060=>_0x912060['ip']===_0x29f8cb);}async function temporaryAccess2FA(_0x290b4c,_0x4e72bf){const _0x23c02c=_0xaea5c;let _0xa3ebea=new Date(),_0x1ff02d=![];if(lastIpApproval){if(_0xa3ebea-lastIpApproval<0x1388)_0x1ff02d=!![];}lastIpApproval=new Date();if(_0x1ff02d)return;if(tgBot&&settings[_0x23c02c(0x1e4)]){const _0x3c684a=uuidRandom();tmpStorage[_0x3c684a]={'uuid':_0x290b4c,'externalip':_0x4e72bf};const _0x3415fa=Markup[_0x23c02c(0x190)]([Markup[_0x23c02c(0x268)][_0x23c02c(0x2ff)](_0x23c02c(0x12f),_0x23c02c(0x1bd)+_0x3c684a),Markup[_0x23c02c(0x268)][_0x23c02c(0x2ff)](_0x23c02c(0x215),_0x23c02c(0x262)+_0x3c684a),Markup['button'][_0x23c02c(0x2ff)](_0x23c02c(0x2d8),_0x23c02c(0x2cc)+_0x3c684a),Markup['button']['callback'](_0x23c02c(0x265),_0x23c02c(0x14e)+_0x3c684a)]);await sendTelegram(settings[_0x23c02c(0x1e4)],_0x23c02c(0x230)+normalizeIP(_0x4e72bf)[_0x23c02c(0x171)]+'\x20?',_0x3415fa),tgBot['action'](/tempaccess_(.+)_(.+)/,async _0xdb7780=>{const _0x4fd042=_0x23c02c,_0x2e8883=_0xdb7780[_0x4fd042(0x1a3)][0x1],_0x41062e=_0xdb7780[_0x4fd042(0x1a3)][0x2],{uuid:_0x20b34f,externalip:_0x44e0bc}=tmpStorage[_0x41062e];delete tmpStorage[_0x41062e],_0xdb7780['editMessageReplyMarkup'](),devices[_0x20b34f]['telegramIpApproval']={'clientip':_0x44e0bc,'timestamp':new Date()[_0x4fd042(0x1f3)](),'expiry':_0x2e8883},_0x2e8883!=_0x4fd042(0x265)?(await sendTelegram(_0xdb7780[_0x4fd042(0x2ce)]['id'],'Access\x20enabled\x20for\x20'+_0x2e8883+_0x4fd042(0x2b8),{'parse_mode':_0x4fd042(0x342)}),io['to'](_0x20b34f)[_0x4fd042(0x22c)]('status',{'access':{'allow':![],'reason':_0x4fd042(0x15c),'token':null}})):(await sendTelegram(_0xdb7780[_0x4fd042(0x2ce)]['id'],_0x4fd042(0x251)),io['to'](_0x20b34f)[_0x4fd042(0x22c)](_0x4fd042(0x2e7),{'access':{'allow':![],'reason':'temporary\x20access\x20rejected','token':null}}));});}}async function loginAccess2FA(_0x5bd72e,_0x1cbb28){const _0x525d2c=_0xaea5c;if(tgBot&&settings[_0x525d2c(0x1e4)]){const _0x1c910d=uuidRandom();tmpStorage[_0x1c910d]={'uuid':_0x5bd72e,'externalip':_0x1cbb28};const _0x3c5a72=Markup[_0x525d2c(0x190)]([Markup[_0x525d2c(0x268)]['callback'](_0x525d2c(0x2f4),_0x525d2c(0x1d2)+loginExpiry+'_'+_0x1c910d),Markup[_0x525d2c(0x268)]['callback'](_0x525d2c(0x265),_0x525d2c(0x245)+_0x1c910d)]);await sendTelegram(settings[_0x525d2c(0x1e4)],_0x525d2c(0x1a0)+normalizeIP(_0x1cbb28)['show']+'\x20?',_0x3c5a72),tgBot[_0x525d2c(0x17e)](/login2fa_(.+)_(.+)/,async _0x50892c=>{const _0x243ed6=_0x525d2c,_0x495d1e=_0x50892c[_0x243ed6(0x1a3)][0x1],_0x99ff6=_0x50892c[_0x243ed6(0x1a3)][0x2],{uuid:_0x30b774,externalip:_0x1392ae}=tmpStorage[_0x99ff6];delete tmpStorage[_0x99ff6],_0x50892c['editMessageReplyMarkup'](),devices[_0x30b774][_0x243ed6(0x1e9)]={'clientip':_0x1392ae,'timestamp':new Date()['getTime'](),'expiry':_0x495d1e},_0x495d1e!=_0x243ed6(0x265)?(await sendTelegram(_0x50892c[_0x243ed6(0x2ce)]['id'],'Login\x20accepted',{'parse_mode':_0x243ed6(0x342)}),io['to'](_0x30b774)[_0x243ed6(0x22c)](_0x243ed6(0x2e7),{'access':{'allow':![],'reason':_0x243ed6(0x15c),'token':null}})):(await sendTelegram(_0x50892c['chat']['id'],_0x243ed6(0x151)),io['to'](_0x30b774)[_0x243ed6(0x22c)](_0x243ed6(0x2e7),{'access':{'allow':![],'reason':_0x243ed6(0x27e),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x6de4ab=_0xaea5c;return dbConfig[_0x6de4ab(0x1b8)]('bots')['sortBy'](_0x6de4ab(0x136))[_0x6de4ab(0x2aa)]({'status':_0x6de4ab(0x1f6)})[_0x6de4ab(0x1ee)]()||[];}function getDisabledBots(){const _0x24128d=_0xaea5c;return dbConfig[_0x24128d(0x1b8)](_0x24128d(0x315))[_0x24128d(0x21d)](_0x24128d(0x136))[_0x24128d(0x2aa)]({'status':_0x24128d(0x1d5)})[_0x24128d(0x1ee)]()||[];}function getBotAttributes(_0x92e8da){const _0x1e2147=_0xaea5c;let _0x162862={};const _0x4d5b3e=configpath+_0x1e2147(0x2a0)+_0x92e8da+_0x1e2147(0x2d5),_0x2569a9=fs[_0x1e2147(0x29c)](_0x4d5b3e);if(_0x2569a9){const _0x1e3bea=fs['readFileSync'](_0x4d5b3e);try{const _0x5d95f7=JSON[_0x1e2147(0x18c)](_0x1e3bea),_0x536a4c=_0x5d95f7?_0x5d95f7[_0x1e2147(0x130)][0x0][_0x1e2147(0x285)]:![];_0x162862[_0x1e2147(0x32d)]=_0x536a4c?_0x1e2147(0x184):_0x1e2147(0x2d7),_0x162862[_0x1e2147(0x1da)]=_0x5d95f7?_0x5d95f7[_0x1e2147(0x130)][0x0][_0x1e2147(0x1da)]:_0x1e2147(0x2b5)+_0x92e8da,_0x162862[_0x1e2147(0x220)]=_0x5d95f7?_0x5d95f7[_0x1e2147(0x130)][0x0][_0x1e2147(0x220)]:![];}catch(_0x2eeeec){_0x162862[_0x1e2147(0x32d)]=_0x1e2147(0x2d7),_0x162862[_0x1e2147(0x1da)]='Bot\x20'+_0x92e8da,_0x162862[_0x1e2147(0x220)]=![];}}else _0x162862['mode']=_0x1e2147(0x2d7),_0x162862[_0x1e2147(0x1da)]='Bot\x20'+_0x92e8da,_0x162862[_0x1e2147(0x220)]=![];return _0x162862;}function getBotsWithMode(){const _0x442412=_0xaea5c,_0x3d4c1f=dbConfig[_0x442412(0x1b8)](_0x442412(0x315))[_0x442412(0x21d)](_0x442412(0x136))[_0x442412(0x1ee)]()||[];return _0x3d4c1f[_0x442412(0x2be)](_0x56d7a9=>{const _0x14f3af=_0x442412;let _0x538d4f=getBotAttributes(_0x56d7a9[_0x14f3af(0x136)]);_0x56d7a9[_0x14f3af(0x32d)]=_0x538d4f[_0x14f3af(0x32d)];}),_0x3d4c1f;}function getBotExchanges(){const _0x388ee5=_0xaea5c;let _0x4faccb=[];const _0x501e47=dbConfig[_0x388ee5(0x1b8)](_0x388ee5(0x315))['sortBy']('botID')[_0x388ee5(0x1ee)]()||[];_0x501e47[_0x388ee5(0x2be)](_0x5e7192=>{const _0x596a1b=_0x388ee5;if(_0x5e7192[_0x596a1b(0x2e7)]=='enabled'){const _0xd1b584=configpath+_0x596a1b(0x2a0)+_0x5e7192['botID']+_0x596a1b(0x2d5),_0x237e95=fs['existsSync'](_0xd1b584);let _0x408168;if(_0x237e95){const _0x2f1b0d=fs['readFileSync'](_0xd1b584);try{const _0x45422c=JSON[_0x596a1b(0x18c)](_0x2f1b0d);_0x408168=_0x45422c?_0x45422c[_0x596a1b(0x130)][0x0]['exchange']:null;}catch(_0x538538){}}if(_0x408168)_0x4faccb['push'](_0x408168);}});const _0x7c2c8d=[...new Set(_0x4faccb)][_0x388ee5(0x2b0)]();return _0x7c2c8d;}async function initUser(){const _0x17294b=_0xaea5c;if(!settings[_0x17294b(0x33d)]){const _0x14b888=uuidRandom();mixpanel[_0x17294b(0x2e3)](_0x14b888),updateSetting('userid',_0x14b888);}}async function initSecure(){const _0x5706e2=_0xaea5c;let _0x5c1ec0=getSecure();if(!_0x5c1ec0[_0x5706e2(0x16d)](_0x5706e2(0x34d))){let _0x4e72b0=await generateKeys();_0x5c1ec0[_0x5706e2(0x260)]=_0x4e72b0[_0x5706e2(0x260)],_0x5c1ec0[_0x5706e2(0x189)]=_0x4e72b0[_0x5706e2(0x189)],_0x5c1ec0['secret']=crypto['randomBytes'](0x20)[_0x5706e2(0x28b)]('hex');;storeSecure(_0x5c1ec0);}}function getSettings(){const _0x1f8df2=_0xaea5c;return dbSettings[_0x1f8df2(0x1b8)]('settings')[_0x1f8df2(0x1ee)]()||{};}function getSecure(){const _0x256b72=_0xaea5c;return dbSecure['get'](_0x256b72(0x149))[_0x256b72(0x1ee)]()||{};}function getBlacklist(){const _0x569ba1=_0xaea5c;return dbSecure[_0x569ba1(0x1b8)](_0x569ba1(0x329))[_0x569ba1(0x1ee)]()||[];}function broadcastToBots(_0xc49579,_0x394388){const _0x322fed=_0xaea5c;config[_0x322fed(0x2be)](_0x5a0b07=>{const _0xf8ae28=_0x322fed;if(_0x5a0b07[_0xf8ae28(0x2e7)]==_0xf8ae28(0x1f6)&&_0x5a0b07[_0xf8ae28(0x193)]==_0xf8ae28(0x31f)||_0x5a0b07[_0xf8ae28(0x2e7)]=='new'&&_0x5a0b07['live']==_0xf8ae28(0x31f)){if(pid[_0x5a0b07[_0xf8ae28(0x136)]])pid[_0x5a0b07['botID']][_0xf8ae28(0x2d9)]({[_0xc49579]:_0x394388});}});}async function storeSettings(_0x11e567,_0x399447=![]){const _0x197686=_0xaea5c;_0x11e567={...settings,..._0x11e567};if(_0x399447&&_0x11e567[_0x197686(0x244)]!='************'&&_0x11e567[_0x197686(0x244)]!=_0x197686(0x29d)&&_0x11e567['bbPassword']!=''){const _0x49af39=decryptRSA(secure[_0x197686(0x189)],_0x11e567[_0x197686(0x244)])[_0x197686(0x1b6)](_0x197686(0x157))[0x0],_0x2941c8=bcrypt[_0x197686(0x238)](_0x49af39,saltRounds);_0x11e567={..._0x11e567,'bbPassword':_0x2941c8};}if(_0x399447&&_0x11e567[_0x197686(0x28d)]!=_0x197686(0x257)&&_0x11e567[_0x197686(0x28d)]!=_0x197686(0x29d)&&_0x11e567[_0x197686(0x28d)]!=''){const _0x2f40bb=decryptRSA(secure[_0x197686(0x189)],_0x11e567[_0x197686(0x28d)])[_0x197686(0x1b6)](_0x197686(0x157))[0x0];_0x11e567={..._0x11e567,'telegramToken':_0x2f40bb};}if(_0x399447&&_0x11e567['marketcapApi']!=_0x197686(0x257)&&_0x11e567[_0x197686(0x345)]!=_0x197686(0x29d)&&_0x11e567[_0x197686(0x345)]!=''){const _0x39f6c8=decryptRSA(secure[_0x197686(0x189)],_0x11e567[_0x197686(0x345)])['split'](_0x197686(0x157))[0x0];_0x11e567={..._0x11e567,'marketcapApi':_0x39f6c8};}const _0x23f5fe=_0x11e567[_0x197686(0x28d)]!=_0x197686(0x257)&&_0x11e567[_0x197686(0x28d)]!=settings[_0x197686(0x28d)]||_0x11e567[_0x197686(0x332)]!=settings['telegramUsername'],_0x4f4293=_0x11e567[_0x197686(0x28d)]==''||_0x11e567[_0x197686(0x332)]=='',_0x2c8b71=_0x11e567[_0x197686(0x345)]&&_0x11e567['marketcapApi']!='************'&&_0x11e567['marketcapApi']!=settings['marketcapApi'];_0x23f5fe&&(_0x11e567[_0x197686(0x1e4)]=null,_0x11e567[_0x197686(0x14f)]=_0x197686(0x2ca));for(const [_0x111352,_0x3c6996]of Object[_0x197686(0x2f3)](_0x11e567)){if(_0x111352==_0x197686(0x28d)&&_0x3c6996==_0x197686(0x257)){_0x11e567[_0x197686(0x28d)]=settings['telegramToken'];continue;};if(_0x111352=='bbPassword'&&_0x3c6996=='************'){_0x11e567['bbPassword']=settings[_0x197686(0x244)];continue;};if(_0x111352==_0x197686(0x345)&&_0x3c6996==_0x197686(0x257)){_0x11e567[_0x197686(0x345)]=settings[_0x197686(0x345)];continue;};dbSettings['set'](_0x197686(0x12d)+_0x111352,_0x3c6996)[_0x197686(0x18b)]();}settings=_0x11e567,io['to'](_0x197686(0x2a7))['emit'](_0x197686(0x343),cleanSettings()),broadcastToBots(_0x197686(0x19b),settings[_0x197686(0x19b)]),broadcastToBots(_0x197686(0x1fa),settings[_0x197686(0x1fa)]),broadcastToBots(_0x197686(0x345),settings[_0x197686(0x345)]);if(_0x23f5fe&&!_0x4f4293)initTelegram();_0x23f5fe&&_0x4f4293&&(updateSetting(_0x197686(0x1e4),null),disableTelegram()),getAllClients()[_0x197686(0x2be)](_0x27a0a8=>{const _0x6e67a9=_0x197686;getSocket(_0x27a0a8['id'])[_0x6e67a9(0x22c)](_0x6e67a9(0x2e7),{'access':{'allow':![],'reason':_0x6e67a9(0x15c),'token':null}});}),_0x2c8b71&&(await sleep(0xbb8),testMarketcapApi(_0x11e567[_0x197686(0x345)]));}async function testMarketcapApi(_0xc5fcaa){const _0x1bb418=_0xaea5c,_0x3b7446=[_0x1bb418(0x31a),_0x1bb418(0x169)];try{await axios[_0x1bb418(0x1b8)](_0x1bb418(0x231),{'headers':{'X-CMC_PRO_API_KEY':_0xc5fcaa},'params':{'symbol':_0x3b7446[_0x1bb418(0x28b)]()}});}catch(_0x5e50b5){_0x5e50b5[_0x1bb418(0x28b)]()[_0x1bb418(0x2fa)](_0x1bb418(0x327))?(io['to'](_0x1bb418(0x2a7))['emit'](_0x1bb418(0x267),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x1bb418(0x167)](_0x1bb418(0x30a))):(io['to']('botmanager')[_0x1bb418(0x22c)](_0x1bb418(0x267),_0x1bb418(0x1b4)),logger[_0x1bb418(0x167)](_0x1bb418(0x1b4)),logger['debug'](_0x1bb418(0x351),_0x5e50b5[_0x1bb418(0x28b)]()+'\x20-\x20'+_0x5e50b5[_0x1bb418(0x279)]));return;}logger[_0x1bb418(0x182)]('CoinMarketCap\x20API\x20key\x20validated');}function updateSetting(_0x37aad6,_0x21feb6){const _0x1a1a9e=_0xaea5c;dbSettings['set'](_0x1a1a9e(0x12d)+_0x37aad6,_0x21feb6)[_0x1a1a9e(0x18b)](),settings=getSettings(),io['to'](_0x1a1a9e(0x2a7))['emit'](_0x1a1a9e(0x343),cleanSettings());}function storeSecure(_0x416df9){const _0x15096e=_0xaea5c;dbSecure[_0x15096e(0x1b8)](_0x15096e(0x149))['push'](_0x416df9)[_0x15096e(0x18b)](),secure=_0x416df9;}function addBlacklist(_0x3da0ee){const _0x1a1d0d=_0xaea5c;cleanBlacklist();let _0x1f93fe;devices[_0x3da0ee][_0x1a1d0d(0x232)]?_0x1f93fe=Math[_0x1a1d0d(0x225)](devices[_0x3da0ee]['telegramIpApproval'][_0x1a1d0d(0x2b1)],loginExpiry):_0x1f93fe=loginExpiry,dbSecure[_0x1a1d0d(0x1b8)]('blacklist')[_0x1a1d0d(0x2f1)]({'expiry':new Date()[_0x1a1d0d(0x1f3)]()+_0x1f93fe*0x3c*0x3e8,'token':devices[_0x3da0ee][_0x1a1d0d(0x178)][_0x1a1d0d(0x234)]})[_0x1a1d0d(0x18b)](),blacklist=dbSecure[_0x1a1d0d(0x1b8)](_0x1a1d0d(0x329))[_0x1a1d0d(0x1ee)]();}function cleanBlacklist(){const _0x56e9bd=_0xaea5c;let _0x8812ed=dbSecure[_0x56e9bd(0x1b8)]('blacklist')['cloneDeep']()['value'](),_0x1a0b55=new Date()['getTime']();_0x8812ed[_0x56e9bd(0x2be)](_0x25f91e=>{const _0x1e39d0=_0x56e9bd;_0x25f91e[_0x1e39d0(0x2b1)]<_0x1a0b55&&dbSecure[_0x1e39d0(0x1b8)](_0x1e39d0(0x329))['remove']({'expiry':_0x25f91e[_0x1e39d0(0x2b1)]})[_0x1e39d0(0x18b)]();});}function initStates(){const _0x3b6f52=_0xaea5c;let _0x3acd28=getConfiguration();_0x3acd28[_0x3b6f52(0x2be)](_0x7f5676=>{const _0x4e44b2=_0x3b6f52;_0x7f5676[_0x4e44b2(0x193)]=_0x4e44b2(0x298);}),storeConfiguration(_0x3acd28);}async function generateKeys(){const _0x25f99b=_0xaea5c,_0x1063d2=forge[_0x25f99b(0x1f1)][_0x25f99b(0x2fe)][_0x25f99b(0x186)]({'bits':0x1000,'e':0x10001}),_0x4536c7=forge['pki']['privateKeyToPem'](_0x1063d2[_0x25f99b(0x189)]),_0x164da9=forge[_0x25f99b(0x1f1)][_0x25f99b(0x1ab)](_0x1063d2[_0x25f99b(0x260)]);return{'privateKey':_0x4536c7,'publicKey':_0x164da9};}function _0x4828(){const _0x55613c=['logs',')\x20|\x20Bot\x20','remove','************','2FA\x20required','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','Error\x20sending\x20','string','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','Notifications\x20enabled','sendMessage','enable','publicKey','reinstall','tempaccess_15_','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','reject','telegrammsg','notification','button','bb/','search','\x1b[0m','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','restore_no_','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','208884EgpNwS','name','bbUsername','graphql-request','/off\x20-\x20stop\x20bot(s)\x0a','mtime','generateAsync','new','260132iQHqTy','Unauthorized\x20attempt\x20to\x20get\x20portfolio','code','deleteHistoryAlerts','You\x20can\x20use\x20the\x20following\x20commands:\x0a','bbvNew','Session\x20expired\x20for\x20user\x20...','2FA\x20login\x20rejected','Unauthorized\x20attempt\x20to\x20download\x20','toggle-bot-mode','ipc','toggle','reinstall-bb','download','headless','defaults','catch','env','_nsps','RSA-OAEP','toString','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','telegramToken','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Unauthorized\x20attempt\x20to\x20update\x20settings','3000','params','index.html','store','order','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','Notifications\x20types:\x20','stopped','File\x20uploaded','size','temporary\x20access\x20not\x20allowed','existsSync','***','login','Failed\x20to\x20download\x20','bot-',',\x20must\x20be\x20a\x204\x20digit\x20number','Yes','No\x20bots\x20running\x20right\x20now','\x20|\x20client:\x20...','2FA','\x20mode','botmanager','type','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','filter','range','sockets','Restarting\x20','message','reason','sort','expiry','show-config','backup-full@','reply','Bot\x20','\x20|\x20user:\x20...','restore_yes_','\x20minutes','version.json','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','removeAllListeners','/output-000.log','restore-backup-file','forEach','whitelist','Error\x20while\x20deleting\x20config\x20files:\x20','node','files','isDirectory','config/','reset-history','decode64','/status\x20-\x20show\x20bot(s)\x20status\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','mixpanel','all','off','tempaccess_30_','resetHistory','chat','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$',':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured','SIGINT','Network\x20Interfaces:','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','exp','-config.json','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','manual','30\x20min','send','output-003.log','getDate','update_yes','storeConfiguration','Restore\x20backup\x20file\x20','host','axios','child_process','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','alias','login\x20token\x20valid','updatebotmanager','/update\x20-\x20update\x20Balance\x20Bot\x0a','status','/upload-backup','getStartingBalances','Backup\x20file\x20unzipped\x20and\x20stored','Setting\x20access:\x20','logged\x20out','portfolio_','/:bot/performance','-----------------------------------------------------------------------------------','build','push','Enabled\x20','entries','accept','editMessageReplyMarkup','Alerts','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','writeFileSync','length','includes','restart','3aECPfy','get-starting-balances','rsa','callback','Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins','Invalid\x20authentication\x20token\x20(1)','-results.json','Idling\x20(','orders','login\x20required','User\x20has\x20been\x20validated','NTBA_FIX_319','once','on_','CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager','toIPv4MappedAddress','open','inherit','whitelistEnabled','SIGTERM','apiKey','794241PUTDpJ','args','auth','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','bots','format','Unauthorized\x20attempt\x20to\x20get\x20messages','=>\x20Go\x20to\x20#CYA#http://','data','BCT','2FA\x20login\x20required','Backup\x20file\x20uploaded','output-001.log','store-headless','running','getHours','Orders','find',')\x20\x20\x20|\x20Bot\x20','allow','44378ENdZzx','Starting\x20new\x20bot\x20|\x20Bot\x20','status\x20code\x20401','/help\x20-\x20show\x20available\x20commands\x0a','blacklist','[ip-address]','resetpw_no','track','mode','sign','Bot\x20Mgr\x20>\x20Stopping\x20','config_alerts','\x20files\x20over\x20Telegram:','telegramUsername','--------------------------------------','createWriteStream','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','async','address\x20already\x20in\x20use','ipv6','readFileSync','Logged\x20in\x20user\x20...','date-fns','assign','userid','timestamp','referer','uncaughtException','confirm-message','HTML','settings','sendMetricsTelegram','marketcapApi','Unauthorized\x20attempt\x20to\x20store\x20configuration','encryptedUuid','log','verify','6b67f3d61ee94b8f5c80b4affef4c4d9','0.0.0','Unauthorized\x20attempt\x20to\x20get\x20events','secret','/names\x20-\x20show\x20bot\x20names\x0a','http://localhost:','function','Error\x20details:','replyWithDocument','telegramEnabled','Bot\x20Mgr\x20>\x20Starting\x20','backup','settings.','headers','5\x20min','bot','/:bot','temp/','\x1b[34m','constructor','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','botID','slice','.zip','get-portfolio','Do\x20you\x20want\x20to\x20reset\x20your\x20password?','::1','backup/','pidRefreshToken','<b>Balance\x20Bot\x20Status:</b>\x0a','Server','copyFileSync','text','getMinutes','588401vAbXSS','apply','Unauthorized\x20attempt\x20to\x20add\x20bot','Unauthorized\x20attempt\x20to\x20confirm\x20message','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','/enable\x20-\x20enable\x20notifications\x0a','secure','title','#RES#\x20','zip/','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','tempaccess_reject_','telegramEvents','Invalid\x20username\x20or\x20IP\x20address','Login\x20rejected','/restart\x20-\x20restart\x20bot(s)\x0a','use','store-configuration','start','stop','|@|','metrics','storeHeadless','conn','(((.+)+)+)+$','reload','production','lowdb/adapters/FileSync','names','unlinkSync','apiSecret','request','sendPortfolioTelegram','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','getUTCHours',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','full','min','ETH','(staging)','off_','update_no','hasOwnProperty','readdirSync','restart_','lastmsgemitted','show','f2aRequired','disconnect','loadAsync','crypto','access\x20timeout','Node.js\x20v','access','config_all','fork','new-disabled','Your\x20installation\x20is\x20already\x20up\x20to\x20date','statSync','action','get-backup-files','environment','Restore\x20process\x20confirmed','debug','emitHistory','auto','All','generateKeyPair','Ok,\x20will\x20send\x20alert\x20notifications\x20only','output-000.log','privateKey','getFullYear','write','parse','bb-settings.json','Logged\x20out\x20user\x20...','socket','inlineKeyboard','reinstall_no','showConfig','live','20NDTWWU','1000','Invalid\x20authentication\x20token\x20(2)','simple','Telegraf\x20error:','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','latestversion','timeshift','address','Starting\x20(','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','get-messages','Allow\x20login\x20from\x20IP\x20address\x20','getSeconds','padStart','match','DEFLATE','Starting\x20Balance\x20Bot\x20reinstallation','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Notifications\x20disabled\x0a','keys','map','store-settings','publicKeyToPem','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','sendFile','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','Starting\x20#RED#Balance\x20Bot\x20v','*$1*','Unauthorized\x20attempt\x20to\x20update\x20bot','remoteAddress','\x20|\x20','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','toggle_','split','toIPv4Address','get','listen','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','isIPv4MappedAddress','pidExpireLogin','tempaccess_5_','binary','test','disable','stringify','/:bot/coins','error','clientip','internal','Notifications\x20disabled','/:bot/support','temporaryAccessAllowed','event','command','cancel-loading','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','messages','config_orders','Bot\x20Mgr\x20>\x20','toggleBotMode','reset-password','login2fa_','reinstall_yes','Restoring\x20bot(s)\x20from\x20backup','disabled','portfolio','yes','private','init','botname','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','login\x20not\x20required','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','join','#RES#\x20if\x20running\x20on\x20server','bot.js','temporary\x20token\x20generated','472pMWXqS','backup-full.zip','telegramChatId','All\x20bots','No\x20authentication\x20token','72645dtuiYv','util','telegram2FaApproval','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','handshake','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','update','value','isValid','$1_$2_$3','pki','telegram','getTime','uuid','number','enabled','\x1b[35m','username','login\x20token\x20generated','onepagemode','rmSync','clients','bbvReceive','any','\x20(1)','exit','-performance.json','Deleted\x20Bot\x20','cancelLoading','output-002.log','15CoEOQL','connected','build2','kill','invalid\x20credentials','All\x20bots\x20running\x20right\x20now','sha256','Running\x20#RED#Balance\x20Bot\x20v','logs/','\x20only\x0a','placeOrder','socket.io','getMonth','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','node-forge','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','15\x20min','success','replace','getPortfolio','static','Ok,\x20will\x20send\x20order\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20log\x20out','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','sortBy','127.0.0.1','\x20>\x20','showname','file','lastmsgtelegram','bb-config.json','tkn','max','from','Notifications\x20enabled\x0a','create','privateKeyFromPem','update-bb','Unauthorized\x20attempt\x20to\x20show\x20configuration','emit','launch','express-fileupload','post','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','telegramIpApproval','staging','token','Starting\x20Balance\x20Bot\x20update','#RES#','port','hashSync','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','metrics_','place-order','/start','versions','initclient','help','/logs\x20-\x20receive\x20log\x20files\x0a','loginRequired','Error:\x20Invalid\x20argument\x20','\x1b[36m','bbPassword','login2fa_reject_','Password\x20reset\x20rejected','\x20(2)','add','logout','mkdirSync','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run','24021lpIWnI','backup-full','temporary\x20access\x20timeout','started','startsWith','Temporary\x20access\x20rejected','Restore\x20process\x20aborted','alerts'];_0x4828=function(){return _0x55613c;};return _0x4828();}async function oneTimeMigration(){const _0x81afdf=_0xaea5c;let _0x576ba0=getSettings(),_0x1dd5a4=![];!_0x576ba0['hasOwnProperty'](_0x81afdf(0x222))&&(_0x576ba0[_0x81afdf(0x222)]=0x0,_0x1dd5a4=!![]);!_0x576ba0['hasOwnProperty']('lastmsgemitted')&&(_0x576ba0[_0x81afdf(0x170)]=0x0,_0x1dd5a4=!![]);!_0x576ba0['hasOwnProperty'](_0x81afdf(0x19a))&&(_0x576ba0[_0x81afdf(0x19a)]=_0x81afdf(0x34b),_0x1dd5a4=!![]);!_0x576ba0[_0x81afdf(0x16d)](_0x81afdf(0x1fa))&&(_0x576ba0[_0x81afdf(0x1fa)]=![],_0x1dd5a4=!![]);!_0x576ba0[_0x81afdf(0x16d)](_0x81afdf(0x345))&&(_0x576ba0[_0x81afdf(0x345)]='',_0x1dd5a4=!![]);if(_0x1dd5a4)storeSettings(_0x576ba0);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x81afdf(0x2be)](_0x1a2bb7=>{const _0x28ccc4=_0x81afdf;if(!_0x1a2bb7[_0x28ccc4(0x2c3)]()){if(!_0x1a2bb7[_0x28ccc4(0x270)]['startsWith'](_0x28ccc4(0x2b3)))fs[_0x28ccc4(0x160)](configbackuppath+_0x1a2bb7[_0x28ccc4(0x270)]);}else fs[_0x28ccc4(0x1fb)](configbackuppath+_0x1a2bb7[_0x28ccc4(0x270)],{'recursive':!![]});});}catch(_0x3b01eb){logger['debug']('Error\x20removing\x20old\x20backup\x20files:',_0x3b01eb);}}function storeConfiguration(_0x55c0c2){const _0x22d89b=_0xaea5c;dbConfig[_0x22d89b(0x1b8)](_0x22d89b(0x315))['remove']()[_0x22d89b(0x18b)](),dbConfig[_0x22d89b(0x1b8)](_0x22d89b(0x315))[_0x22d89b(0x2f1)](..._0x55c0c2)[_0x22d89b(0x18b)](),config=_0x55c0c2;}async function resetPassword(){const _0x5d2a1b=_0xaea5c;if(tgBot&&settings[_0x5d2a1b(0x1e4)]){const _0x1fb752=Markup['inlineKeyboard']([Markup[_0x5d2a1b(0x268)][_0x5d2a1b(0x2ff)](_0x5d2a1b(0x1d7),'resetpw_yes'),Markup[_0x5d2a1b(0x268)][_0x5d2a1b(0x2ff)]('no',_0x5d2a1b(0x32b))]);await sendTelegram(settings[_0x5d2a1b(0x1e4)],_0x5d2a1b(0x13a),_0x1fb752),tgBot[_0x5d2a1b(0x17e)](/resetpw_(.+)/,async _0x52daf5=>{const _0x488b32=_0x5d2a1b,_0x71b2b8=_0x52daf5[_0x488b32(0x1a3)][0x1];_0x52daf5[_0x488b32(0x2f5)]();if(_0x71b2b8!='no'){const _0x245afa=0xf,_0x31a9d2=_0x488b32(0x2cf),_0x57ed10=Array['from'](crypto['randomFillSync'](new Uint32Array(_0x245afa)))[_0x488b32(0x1a9)](_0x2aff22=>_0x31a9d2[_0x2aff22%_0x31a9d2[_0x488b32(0x2f9)]])[_0x488b32(0x1de)](''),_0x6b9d82=bcrypt[_0x488b32(0x238)](_0x57ed10,saltRounds);storeSettings({'bbPassword':_0x6b9d82}),await sendTelegram(_0x52daf5[_0x488b32(0x2ce)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x57ed10,{'parse_mode':_0x488b32(0x342)});}else await sendTelegram(_0x52daf5[_0x488b32(0x2ce)]['id'],_0x488b32(0x246));});}}async function confirmRestore(_0x3e0b75,_0x280f83){const _0x1f6dc7=_0xaea5c;io['to'](_0x1f6dc7(0x2a7))[_0x1f6dc7(0x22c)](_0x1f6dc7(0x267),_0x1f6dc7(0x2a9),_0x1f6dc7(0x216));if(tgBot&&settings[_0x1f6dc7(0x1e4)]){const _0x5c9650=uuidRandom();tmpStorage[_0x5c9650]={'path':_0x3e0b75,'filename':_0x280f83};const _0x52c8dd=Markup[_0x1f6dc7(0x190)]([Markup[_0x1f6dc7(0x268)]['callback'](_0x1f6dc7(0x1d7),_0x1f6dc7(0x2b7)+_0x5c9650),Markup['button'][_0x1f6dc7(0x2ff)]('no',_0x1f6dc7(0x26d)+_0x5c9650)]);await sendTelegram(settings['telegramChatId'],_0x1f6dc7(0x28f),_0x52c8dd),tgBot[_0x1f6dc7(0x17e)](/restore_(.+)_(.+)/,async _0x517224=>{const _0x55ac19=_0x1f6dc7,_0x5c90d4=_0x517224['match'][0x1],_0x22d06e=_0x517224[_0x55ac19(0x1a3)][0x2],{path:_0x32c1bf,filename:_0x3ad194}=tmpStorage[_0x22d06e];delete tmpStorage[_0x22d06e],_0x517224['editMessageReplyMarkup'](),_0x5c90d4=='yes'?(logger[_0x55ac19(0x182)](_0x55ac19(0x181)),await sendTelegram(_0x517224[_0x55ac19(0x2ce)]['id'],_0x55ac19(0x1d4),{'parse_mode':'HTML'}),unzipFile(_0x32c1bf,_0x3ad194)):(logger['debug']('Restore\x20process\x20aborted'),await sendTelegram(_0x517224[_0x55ac19(0x2ce)]['id'],_0x55ac19(0x252)));});}}function getServerTime(){const _0x2e293d=_0xaea5c,_0x19e6e1=new Date();return _0x19e6e1[_0x2e293d(0x18a)]()+'/'+(_0x19e6e1[_0x2e293d(0x211)]()+0x1)['toString']()[_0x2e293d(0x1a2)](0x2,'0')+'/'+_0x19e6e1[_0x2e293d(0x2db)]()['toString']()[_0x2e293d(0x1a2)](0x2,'0')+'\x20'+_0x19e6e1['getHours']()['toString']()[_0x2e293d(0x1a2)](0x2,'0')+':'+_0x19e6e1['getMinutes']()['toString']()[_0x2e293d(0x1a2)](0x2,'0')+':'+_0x19e6e1[_0x2e293d(0x1a1)]()[_0x2e293d(0x28b)]()[_0x2e293d(0x1a2)](0x2,'0');}function getTimeStamp(){const _0x4dd038=_0xaea5c,_0x414092=shiftedTime();return _0x414092[_0x4dd038(0x18a)]()+'/'+(_0x414092[_0x4dd038(0x211)]()+0x1)[_0x4dd038(0x28b)]()[_0x4dd038(0x1a2)](0x2,'0')+'/'+_0x414092[_0x4dd038(0x2db)]()[_0x4dd038(0x28b)]()[_0x4dd038(0x1a2)](0x2,'0')+'\x20'+_0x414092[_0x4dd038(0x320)]()[_0x4dd038(0x28b)]()[_0x4dd038(0x1a2)](0x2,'0')+':'+_0x414092[_0x4dd038(0x142)]()[_0x4dd038(0x28b)]()[_0x4dd038(0x1a2)](0x2,'0')+':'+_0x414092[_0x4dd038(0x1a1)]()[_0x4dd038(0x28b)]()['padStart'](0x2,'0');}function getCleanTimeStamp(){const _0x234460=_0xaea5c,_0x21b276=shiftedTime();return _0x21b276['getFullYear']()+(_0x21b276[_0x234460(0x211)]()+0x1)[_0x234460(0x28b)]()[_0x234460(0x1a2)](0x2,'0')+_0x21b276[_0x234460(0x2db)]()['toString']()[_0x234460(0x1a2)](0x2,'0')+'-'+_0x21b276[_0x234460(0x320)]()['toString']()[_0x234460(0x1a2)](0x2,'0')+_0x21b276[_0x234460(0x142)]()[_0x234460(0x28b)]()[_0x234460(0x1a2)](0x2,'0')+_0x21b276['getSeconds']()[_0x234460(0x28b)]()[_0x234460(0x1a2)](0x2,'0');}function shiftedTime(){const _0x30d724=_0xaea5c,_0x3d382c=new Date();let _0x1e3647=_0x3d382c;if(settings[_0x30d724(0x19b)]&&settings['timeshift']!==0x0)_0x1e3647=fns[_0x30d724(0x248)](_0x3d382c,{'hours':settings[_0x30d724(0x19b)]});return _0x1e3647;}async function startScheduler(){const _0x109b79=_0xaea5c,_0x9a647e=new Date()[_0x109b79(0x165)](),_0x2c5c10=shiftedTime()['getHours']();_0x2c5c10==0x4&&backupConfigFiles(),_0x2c5c10==0x0&&(rotateLogFiles(),logger[_0x109b79(0x182)](_0x109b79(0x333)),logger[_0x109b79(0x182)](_0x109b79(0x20c)+serverversion+'#RES#\x20'+(environment==_0x109b79(0x233)?_0x109b79(0x16a):'')),logger[_0x109b79(0x182)]('--------------------------------------')),_0x9a647e%0x6==0x0&&triggerAnalytics(),_0x9a647e%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0xf50cd3){const _0x5bd48c=_0xaea5c;logger[_0x5bd48c(0x182)](_0x5bd48c(0x2de)+_0xf50cd3);const _0x2a201f=getBotsWithMode();_0x2a201f[_0x5bd48c(0x2f9)]>0x0?confirmRestore(configbackuppath,_0xf50cd3):unzipFile(configbackuppath,_0xf50cd3);}async function getBackupFiles(_0x56cbd2=null){const _0x31644f=_0xaea5c;let _0x1c42d2=[],_0x21ae3e=fs[_0x31644f(0x16e)](configbackuppath,{'withFileTypes':!![]});_0x21ae3e[_0x31644f(0x2b0)]((_0x2a91c0,_0x53bce5)=>_0x2a91c0[_0x31644f(0x270)]<_0x53bce5['name']?0x1:_0x53bce5[_0x31644f(0x270)]<_0x2a91c0[_0x31644f(0x270)]?-0x1:0x0),_0x21ae3e[_0x31644f(0x2be)](_0x4e2928=>{const _0x500cba=_0x31644f;if(!_0x4e2928[_0x500cba(0x2c3)]()&&_0x4e2928[_0x500cba(0x270)][_0x500cba(0x250)]('backup-full@')&&_0x4e2928['name']['endsWith'](_0x500cba(0x138))){const _0x4a9bb3=formatDate(fs[_0x500cba(0x17d)](configbackuppath+_0x4e2928[_0x500cba(0x270)])[_0x500cba(0x274)]);_0x1c42d2[_0x500cba(0x2f1)]({'name':_0x4e2928[_0x500cba(0x270)],'mtime':_0x4a9bb3});}});if(_0x56cbd2)io['to'](_0x56cbd2)[_0x31644f(0x22c)]('backup-files',_0x1c42d2);else return _0x1c42d2;}async function backupConfigFiles(){const _0x266f8f=_0xaea5c;await zipFiles(_0x266f8f(0x24d));const _0x2d8d49=getCleanTimeStamp();fs[_0x266f8f(0x140)](zippath+_0x266f8f(0x1e3),configbackuppath+(_0x266f8f(0x2b3)+_0x2d8d49+'.zip'));let _0x100fd9=fs[_0x266f8f(0x16e)](configbackuppath,{'withFileTypes':!![]});_0x100fd9[_0x266f8f(0x2b0)]((_0x897b37,_0x49b907)=>_0x897b37[_0x266f8f(0x270)]<_0x49b907[_0x266f8f(0x270)]?0x1:_0x49b907['name']<_0x897b37['name']?-0x1:0x0),_0x100fd9['length']>maxBackups&&fs['unlinkSync'](configbackuppath+_0x100fd9[_0x100fd9[_0x266f8f(0x2f9)]-0x1]['name']);}function rotateLogFiles(){const _0x4cf231=_0xaea5c,_0x8c669f=fs['statSync'](logspath+_0x4cf231(0x188)),_0x2fe7af=_0x8c669f[_0x4cf231(0x29a)]/0x400;if(_0x2fe7af>0x64){let _0x448b2c=fs[_0x4cf231(0x16e)](logspath,{'withFileTypes':!![]});_0x448b2c[_0x4cf231(0x2b0)]((_0x5b34ab,_0x6a0c38)=>_0x5b34ab['name']<_0x6a0c38[_0x4cf231(0x270)]?0x1:_0x6a0c38['name']<_0x5b34ab['name']?-0x1:0x0),_0x448b2c[_0x4cf231(0x2be)](_0x47ae2f=>{const _0x472edd=_0x4cf231;if(_0x47ae2f['name']==_0x472edd(0x204))fs['copyFileSync'](logspath+_0x47ae2f['name'],logspath+_0x472edd(0x2da));if(_0x47ae2f[_0x472edd(0x270)]==_0x472edd(0x31d))fs[_0x472edd(0x140)](logspath+_0x47ae2f[_0x472edd(0x270)],logspath+'output-002.log');_0x47ae2f[_0x472edd(0x270)]==_0x472edd(0x188)&&(fs[_0x472edd(0x140)](logspath+_0x47ae2f[_0x472edd(0x270)],logspath+_0x472edd(0x31d)),fs[_0x472edd(0x2f8)](logspath+_0x47ae2f[_0x472edd(0x270)],''));});}}async function zipFiles(_0x27fd73){const _0x2588cf=_0xaea5c;let _0x2e597b;if(_0x27fd73==_0x2588cf(0x254))_0x2e597b=logspath;if(_0x27fd73==_0x2588cf(0x12c))_0x2e597b=configpath;if(_0x27fd73==_0x2588cf(0x24d))_0x2e597b=configpath;let _0x25b4a4=fs[_0x2588cf(0x16e)](_0x2e597b,{'withFileTypes':!![]});const _0x38ffbb=new JSZip();_0x25b4a4[_0x2588cf(0x2be)](_0x2fe740=>{const _0x57eace=_0x2588cf;if(!_0x2fe740[_0x57eace(0x2c3)]()){let _0x555e9d=fs[_0x57eace(0x339)](_0x2e597b+_0x2fe740['name']);if(_0x27fd73==_0x57eace(0x12c)){const _0x5efa71=/^bot-[0-9]{3}-config.json$/,_0x29bf31=_0x5efa71['test'](_0x2fe740[_0x57eace(0x270)]);if(_0x29bf31){const _0x4987d1=JSON[_0x57eace(0x18c)](_0x555e9d);if(_0x4987d1[_0x57eace(0x130)][0x0]){_0x4987d1[_0x57eace(0x130)][0x0]['apiKey']=_0x57eace(0x29d),_0x4987d1[_0x57eace(0x130)][0x0][_0x57eace(0x161)]='***';if(_0x4987d1[_0x57eace(0x130)][0x0]['apiPassword'])_0x4987d1[_0x57eace(0x130)][0x0]['apiPassword']=_0x57eace(0x29d);}_0x555e9d=JSON[_0x57eace(0x1c1)](_0x4987d1,null,0x2);}if(_0x2fe740[_0x57eace(0x270)]=='bb-settings.json'){const _0x4772f2=JSON[_0x57eace(0x18c)](_0x555e9d);if(_0x4772f2[_0x57eace(0x343)][_0x57eace(0x241)])_0x4772f2[_0x57eace(0x343)][_0x57eace(0x241)]=![];if(_0x4772f2[_0x57eace(0x343)][_0x57eace(0x244)])_0x4772f2[_0x57eace(0x343)][_0x57eace(0x244)]='***';if(_0x4772f2[_0x57eace(0x343)][_0x57eace(0x28d)])_0x4772f2[_0x57eace(0x343)][_0x57eace(0x28d)]=_0x57eace(0x29d);if(_0x4772f2[_0x57eace(0x343)][_0x57eace(0x1e4)])_0x4772f2[_0x57eace(0x343)][_0x57eace(0x1e4)]=null;if(_0x4772f2[_0x57eace(0x343)][_0x57eace(0x345)])_0x4772f2[_0x57eace(0x343)][_0x57eace(0x345)]=_0x57eace(0x29d);_0x555e9d=JSON[_0x57eace(0x1c1)](_0x4772f2,null,0x2);}if(_0x2fe740['name']!='bb-secure.json')_0x38ffbb['file'](_0x2fe740[_0x57eace(0x270)],_0x555e9d);}else _0x38ffbb[_0x57eace(0x221)](_0x2fe740['name'],_0x555e9d);}});const _0x30215e=await _0x38ffbb[_0x2588cf(0x275)]({'type':'string','base64':![],'compression':_0x2588cf(0x1a4)});fs[_0x2588cf(0x2f8)](zippath+(_0x27fd73+_0x2588cf(0x138)),_0x30215e,_0x2588cf(0x1be));}async function unzipFile(_0x1fe814,_0x427d5c){const _0xe094b3=_0xaea5c;fs[_0xe094b3(0x16e)](configpath,{'withFileTypes':!![]})[_0xe094b3(0x2be)](_0x106f53=>{const _0x192c1b=_0xe094b3;if(!_0x106f53['isDirectory']())fs[_0x192c1b(0x1fb)](configpath+_0x106f53['name']);});const _0x4d25f3=fs['readFileSync'](_0x1fe814+_0x427d5c,_0xe094b3(0x1be)),_0x489bc8=await JSZip[_0xe094b3(0x174)](_0x4d25f3,{'base64':![],'checkCRC32':!![]});for(const _0x5626b6 of Object[_0xe094b3(0x1a8)](_0x489bc8[_0xe094b3(0x2c2)])){const _0x5df07e=_0x489bc8[_0xe094b3(0x2c2)][_0x5626b6],_0xc42b5b=await _0x5df07e[_0xe094b3(0x336)]('string');fs[_0xe094b3(0x2f8)](configpath+_0x5df07e['name'],_0xc42b5b);}fs[_0xe094b3(0x16e)](temppath,{'withFileTypes':!![]})[_0xe094b3(0x2be)](_0x41ccc1=>{const _0x1102ca=_0xe094b3;if(!_0x41ccc1[_0x1102ca(0x2c3)]())fs[_0x1102ca(0x1fb)](temppath+_0x41ccc1[_0x1102ca(0x270)]);}),logger[_0xe094b3(0x182)](_0xe094b3(0x2ea)),process['send']({'restore':!![]},_0x27cda9=>{});}async function getPublicIp(){const _0x392293=_0xaea5c;try{const _0x3ce32d=await axios[_0x392293(0x1b8)]('https://api.ipify.org?format=json');publicip=_0x3ce32d[_0x392293(0x319)]['ip'];}catch(_0x1013cd){}}async function triggerAnalytics(){const _0x3c7806=_0xaea5c;if(!publicip)await getPublicIp();const _0x5341c2=getBotsWithMode();let _0x2d3cf7=0x0;_0x5341c2[_0x3c7806(0x2be)](_0x15b66b=>{const _0x2dd951=_0x3c7806;if(_0x15b66b[_0x2dd951(0x2e7)]==='enabled')_0x2d3cf7++;});const _0x23cace=getBotExchanges();mixpanel[_0x3c7806(0x32c)](_0x3c7806(0x13f),{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x5341c2[_0x3c7806(0x2f9)],'numbotsenabled':_0x2d3cf7,'exchanges':_0x23cace,'environment':environment});}async function getMessages(){const _0x5c1b7f=_0xaea5c,_0x136b74=_0x5c1b7f(0x19e),_0x1bbca4=new GraphQLClient(_0x136b74),_0xbea12c={'authorization':_0x5c1b7f(0x1ba)},_0x418faa=serverversion[_0x5c1b7f(0x1b6)]('.'),_0x33c1a5=_0x418faa[0x0]+'.'+_0x418faa[0x1],_0x47afba=Math[_0x5c1b7f(0x168)](settings[_0x5c1b7f(0x222)],settings['lastmsgemitted']),_0x574819={'last':parseInt(_0x47afba),'bbm':_0x33c1a5},_0x50119c=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x14a978;try{_0x14a978=await _0x1bbca4[_0x5c1b7f(0x162)](_0x50119c,_0x574819,_0xbea12c);}catch(_0x30293b){}if(_0x14a978&&_0x14a978[_0x5c1b7f(0x1cd)]){let _0x1c237e=settings[_0x5c1b7f(0x222)],_0x1c61f6=settings[_0x5c1b7f(0x222)];newMessages=[];for(const _0x3c551e of _0x14a978[_0x5c1b7f(0x1cd)]){newMessages[_0x5c1b7f(0x2f1)](_0x3c551e);let _0x543a00=![];_0x3c551e[_0x5c1b7f(0x27c)]&&(updateSetting(_0x5c1b7f(0x19a),_0x3c551e[_0x5c1b7f(0x27c)]),_0x543a00=isNewerVersion(serverversion,_0x3c551e[_0x5c1b7f(0x27c)])||serverversion==_0x3c551e[_0x5c1b7f(0x27c)]);if(!_0x543a00&&_0x3c551e[_0x5c1b7f(0x1f5)]>_0x1c237e){if(_0x3c551e['bbvReceive']===_0x5c1b7f(0x1fe)||serverversion['startsWith'](_0x3c551e[_0x5c1b7f(0x1fd)])){let _0x5ba322=''+_0x3c551e[_0x5c1b7f(0x14a)]+'\x0a\x0a'+_0x3c551e[_0x5c1b7f(0x2ae)];const _0x193a51=await sendTelegramMsg(toTelegramMarkdown(_0x5ba322),'Markdown');_0x1c237e=_0x3c551e[_0x5c1b7f(0x1f5)];}}_0x1c61f6=_0x3c551e[_0x5c1b7f(0x1f5)];}updateAvailable=isNewerVersion(settings[_0x5c1b7f(0x19a)],serverversion),updateSetting(_0x5c1b7f(0x222),_0x1c61f6),emitMessages();}}function emitMessages(){const _0x303d4b=_0xaea5c,_0x5a8c93=settings[_0x303d4b(0x170)];let _0x44ae76=[];newMessages[_0x303d4b(0x2be)](_0x23200d=>{const _0x85cdae=_0x303d4b;_0x23200d[_0x85cdae(0x1f5)]>_0x5a8c93&&_0x44ae76[_0x85cdae(0x2f1)](_0x23200d);}),_0x44ae76['length']>0x0&&getAllClients()[_0x303d4b(0x2be)](_0x35cbda=>{const _0x5f34c4=_0x303d4b;getSocket(_0x35cbda['id'])['emit'](_0x5f34c4(0x2ae),_0x44ae76);});}function confirmMessage(_0x2b1a35){const _0x5e1b51=_0xaea5c;updateSetting(_0x5e1b51(0x170),Number(_0x2b1a35));}function isNewerVersion(_0x73862b,_0x2e31d8){const _0x2c09aa=_0xaea5c,_0x92e1d5=_0x2e31d8['split']('.'),_0x5d9f05=_0x73862b['split']('.');for(var _0x3d04c9=0x0;_0x3d04c9<_0x5d9f05[_0x2c09aa(0x2f9)];_0x3d04c9++){const _0x357624=~~_0x5d9f05[_0x3d04c9],_0x338acf=~~_0x92e1d5[_0x3d04c9];if(_0x357624>_0x338acf)return!![];if(_0x357624<_0x338acf)return![];}return![];}function toTelegramMarkdown(_0x5233c7){const _0x18217d=_0xaea5c,_0x39cdf2=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x3cc2ee=/\*{2}(.+?)\*{2}/gim;return _0x5233c7=_0x5233c7[_0x18217d(0x217)](_0x39cdf2,_0x18217d(0x1f0))['replace'](_0x3cc2ee,_0x18217d(0x1b0)),_0x5233c7;}async function validateConfigFile(){const _0x2dceca=_0xaea5c,_0x341bb9=dbConfig[_0x2dceca(0x1b8)]('bots')[_0x2dceca(0x21d)]('botID')['value']()||[];if(_0x341bb9[_0x2dceca(0x2f9)]==0x0){let _0x4114f6=0x0,_0x5ac8ab=[];const _0x2729a3=/^bot-([0-9]{3})-config.json$/,_0x1eb72e=fs[_0x2dceca(0x16e)](configpath);_0x1eb72e[_0x2dceca(0x2be)](_0x42b875=>{const _0x58f0d9=_0x2dceca,_0x5ade9c=_0x2729a3['exec'](_0x42b875);if(_0x5ade9c){const _0x10f93a=_0x5ade9c[0x1];let _0x50f3f2=getBotAttributes(_0x10f93a);_0x5ac8ab[_0x58f0d9(0x2f1)]({'botID':_0x10f93a,'botname':_0x50f3f2[_0x58f0d9(0x1da)],'status':_0x58f0d9(0x1d5),'live':'stopped'}),_0x4114f6++;}}),_0x4114f6!=0x0&&(dbConfig[_0x2dceca(0x1b8)](_0x2dceca(0x315))[_0x2dceca(0x33c)](_0x5ac8ab)[_0x2dceca(0x18b)](),config=_0x5ac8ab,restoredConfigFile=_0x4114f6);}}async function restoreConfigNotify(_0x32ee2b){const _0x35bbb7=_0xaea5c;let _0x145bc3;if(restoredConfigFile==0x1)_0x145bc3=_0x35bbb7(0x24b);else _0x145bc3='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x32ee2b)io['to'](_0x35bbb7(0x2a7))[_0x35bbb7(0x22c)](_0x35bbb7(0x267),_0x145bc3);else{logger[_0x35bbb7(0x197)](_0x35bbb7(0x2ef)),logger['simple'](_0x145bc3),logger['simple']('-----------------------------------------------------------------------------------'),logger['simple']('');if(tgBot&&settings['telegramChatId']&&settings['telegramEvents']!=_0x35bbb7(0x304))await sendTelegram(settings[_0x35bbb7(0x1e4)],_0x35bbb7(0x1cf)+_0x145bc3);}}function decryptRSA(_0x53159f,_0x5630f9){const _0x44fb04=_0xaea5c,_0x3d6f5e=forge['pki'][_0x44fb04(0x229)](_0x53159f),_0x16c11f=_0x3d6f5e['decrypt'](forge[_0x44fb04(0x1e8)][_0x44fb04(0x2c6)](_0x5630f9),_0x44fb04(0x28a),{'md':forge['md'][_0x44fb04(0x20b)][_0x44fb04(0x228)](),'mgf1':{'md':forge['md'][_0x44fb04(0x20b)][_0x44fb04(0x228)]()}});return _0x16c11f;}function validateCredentials(_0x1154bb,_0x2455d9){const _0xe5087=_0xaea5c;if(_0x1154bb[_0xe5087(0x1f8)]==settings['bbUsername']&&bcrypt['compareSync'](_0x1154bb['password'],settings[_0xe5087(0x244)])){if(settings[_0xe5087(0x172)])return{'allow':![],'reason':_0xe5087(0x31b),'token':null};else{const _0x224fcb=generateLoginToken(_0x2455d9);return{'allow':!![],'reason':_0xe5087(0x1f9),'token':_0x224fcb};}}else return{'allow':![],'reason':'invalid\x20credentials','token':null};}function refreshToken(_0x5cd32b){const _0x3f81ad=_0xaea5c,_0x49d436=generateLoginToken(_0x5cd32b);return{'allow':!![],'reason':_0x3f81ad(0x1f9),'token':_0x49d436};}function validateAccess(_0x2ff896,_0x2c58a7,_0x392b6e){const _0x55f004=_0xaea5c,_0x226821=_0x392b6e?_0x392b6e:devices[_0x2c58a7]['ip'];let _0x494edd;const _0x170ded=_0x452ab1=>{const _0x169aad=_0x5771;if(settings[_0x169aad(0x241)]){if(settings[_0x169aad(0x172)]){if(telegram2FaApproved(_0x2c58a7)){const _0x3f491e=generateLoginToken(_0x2c58a7);return{'allow':!![],'reason':'2FA\x20login\x20token\x20generated','token':_0x3f491e};}else return{'allow':![],'reason':_0x169aad(0x305),'token':null};}else return _0x494edd=validToken(_0x452ab1,_0x2c58a7),_0x494edd[_0x169aad(0x16d)](_0x169aad(0x216))?{'allow':!![],'reason':_0x169aad(0x2e4),'token':_0x452ab1}:{'allow':![],'reason':_0x169aad(0x305),'token':null};}else return{'allow':!![],'reason':_0x169aad(0x1dc),'token':null};};if(settings[_0x55f004(0x30e)]){let _0x5a4850=[...settings[_0x55f004(0x2bf)],_0x55f004(0x13b),'::ffff:127.0.0.1',_0x55f004(0x21e),'::ffff:7f00:1'];if(_0x5a4850['includes'](_0x226821))return _0x170ded(_0x2ff896);else{_0x494edd=validToken(_0x2ff896,_0x2c58a7);if(_0x494edd[_0x55f004(0x16d)](_0x55f004(0x216)))return _0x170ded(_0x2ff896);else{if(telegramIpApproved(_0x2c58a7)){const _0x5bd809=generateToken(_0x2c58a7);return _0x494edd=_0x170ded(_0x2ff896),_0x494edd['allow']?{'allow':!![],'reason':_0x55f004(0x1e1),'token':_0x5bd809}:_0x494edd;}else return settings[_0x55f004(0x1c8)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x55f004(0x29b),'token':null};}}}else return _0x170ded(_0x2ff896);}function timelyDecrypt(_0x90c154,_0x70b544,_0x938fb0='@'){const _0x288f6a=_0xaea5c;if(_0x90c154)try{const _0x42a10d=decryptRSA(secure[_0x288f6a(0x189)],_0x90c154),_0x4731cc=_0x42a10d['split'](_0x938fb0)[0x0],_0x1dd4a4=_0x42a10d[_0x288f6a(0x1b6)](_0x938fb0)[0x1],_0x544dff=new Date()[_0x288f6a(0x1f3)]();if(_0x70b544){if(_0x544dff-_0x1dd4a4<maxSecretAge*0x3e8)return _0x4731cc;else return![];}else return _0x4731cc;}catch(_0x35ab7a){return![];}else return![];}const validToken=(_0x1e8649,_0x576cae)=>{const _0x1b8c73=_0xaea5c,_0x17e892=devices[_0x576cae]['ip'];if(!_0x1e8649)return{'error':_0x1b8c73(0x1e6)};for(let _0x1ee6d2 of blacklist){if(_0x1ee6d2['token']==_0x1e8649)return{'error':'Token\x20blacklisted'};}let _0x208c16;try{_0x208c16=jwt[_0x1b8c73(0x349)](_0x1e8649,secure['secret']+_0x576cae);}catch{return{'error':_0x1b8c73(0x301)};}if(!_0x208c16[_0x1b8c73(0x16d)]('clientip')&&!_0x208c16['hasOwnProperty'](_0x1b8c73(0x1f8))||!_0x208c16['hasOwnProperty'](_0x1b8c73(0x2d4)))return{'error':_0x1b8c73(0x196)};if(!_0x208c16['hasOwnProperty'](_0x1b8c73(0x1f8))&&_0x208c16[_0x1b8c73(0x16d)]('clientip')){const {clientip:_0x156f7d}=_0x208c16;return _0x17e892==_0x156f7d?{'success':'User\x20has\x20been\x20validated'}:{'error':'Invalid\x20IP\x20address'};}else{if(_0x208c16[_0x1b8c73(0x16d)](_0x1b8c73(0x1f8))&&_0x208c16['hasOwnProperty'](_0x1b8c73(0x1c4))){const {username:_0x130288,clientip:_0x116441}=_0x208c16;return settings[_0x1b8c73(0x271)]==_0x130288&&_0x17e892==_0x116441?{'success':_0x1b8c73(0x306)}:{'error':_0x1b8c73(0x150)};}}},generateLoginToken=_0x173b92=>{const _0x25a656=_0xaea5c;if(_0x173b92){const _0x1a3ec2=devices[_0x173b92]['ip'];return jwt[_0x25a656(0x32e)]({'username':settings[_0x25a656(0x271)],'clientip':_0x1a3ec2},secure[_0x25a656(0x34d)]+_0x173b92,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x4eb35a=>{const _0x25c559=_0xaea5c;if(_0x4eb35a){const _0x486098=devices[_0x4eb35a]['ip'];return jwt['sign']({'clientip':_0x486098},secure[_0x25c559(0x34d)]+_0x4eb35a,{'expiresIn':devices[_0x4eb35a][_0x25c559(0x232)][_0x25c559(0x2b1)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x396d97=>{const _0x204430=_0xaea5c;let _0x3493a3=![];return devices[_0x396d97][_0x204430(0x232)]&&devices[_0x396d97]['telegramIpApproval'][_0x204430(0x2b1)]!=_0x204430(0x265)&&(_0x3493a3=devices[_0x396d97][_0x204430(0x232)][_0x204430(0x1c4)]==devices[_0x396d97]['ip']&&new Date()['getTime']()-devices[_0x396d97][_0x204430(0x232)][_0x204430(0x33e)]<devices[_0x396d97][_0x204430(0x232)]['expiry']*0x3c*0x3e8),_0x3493a3;},telegram2FaApproved=_0x157bb2=>{const _0x3850be=_0xaea5c;let _0x512827=![];return devices[_0x157bb2][_0x3850be(0x1e9)]&&devices[_0x157bb2][_0x3850be(0x1e9)]['expiry']!=_0x3850be(0x265)&&(_0x512827=devices[_0x157bb2][_0x3850be(0x1e9)][_0x3850be(0x1c4)]==devices[_0x157bb2]['ip']&&new Date()[_0x3850be(0x1f3)]()-devices[_0x157bb2][_0x3850be(0x1e9)]['timestamp']<devices[_0x157bb2][_0x3850be(0x1e9)][_0x3850be(0x2b1)]*0x3c*0x3e8),_0x512827;},normalizeIP=_0x4c86ce=>{const _0x138452=_0xaea5c;let _0x1e3b0e=null,_0x23fe2c=null;if(ipaddr[_0x138452(0x1ef)](_0x4c86ce)){const _0x4e5764=ipaddr[_0x138452(0x18c)](_0x4c86ce);_0x4e5764['kind']()===_0x138452(0x338)?(_0x4e5764[_0x138452(0x1bb)]()&&(_0x1e3b0e=_0x4e5764[_0x138452(0x1b7)]()[_0x138452(0x28b)]()),_0x23fe2c=_0x4e5764[_0x138452(0x28b)]()):(_0x1e3b0e=_0x4e5764['toString'](),_0x23fe2c=_0x4e5764[_0x138452(0x30b)]()['toString']());}return{'show':_0x1e3b0e?_0x1e3b0e:_0x23fe2c,'store':_0x23fe2c};};function formatDate(_0x374501){const _0x1d733f=_0xaea5c;return _0x374501[_0x1d733f(0x18a)]()+'/'+(_0x374501[_0x1d733f(0x211)]()+0x1)[_0x1d733f(0x28b)]()[_0x1d733f(0x1a2)](0x2,'0')+'/'+_0x374501[_0x1d733f(0x2db)]()[_0x1d733f(0x28b)]()[_0x1d733f(0x1a2)](0x2,'0')+'\x20'+_0x374501[_0x1d733f(0x320)]()[_0x1d733f(0x28b)]()[_0x1d733f(0x1a2)](0x2,'0')+':'+_0x374501[_0x1d733f(0x142)]()[_0x1d733f(0x28b)]()['padStart'](0x2,'0')+':'+_0x374501[_0x1d733f(0x1a1)]()['toString']()[_0x1d733f(0x1a2)](0x2,'0');}function sleep(_0x1a0278){return new Promise(_0x52fb05=>setTimeout(_0x52fb05,_0x1a0278));}