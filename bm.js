const _0x57d2a7=_0x3846;(function(_0x10cdce,_0x455d7b){const _0x539f6e=_0x3846,_0x17fe7d=_0x10cdce();while(!![]){try{const _0xaef896=parseInt(_0x539f6e(0x114))/0x1*(-parseInt(_0x539f6e(0x2e7))/0x2)+parseInt(_0x539f6e(0x24a))/0x3+parseInt(_0x539f6e(0x179))/0x4+-parseInt(_0x539f6e(0x10d))/0x5*(parseInt(_0x539f6e(0x2f5))/0x6)+parseInt(_0x539f6e(0x2b0))/0x7+-parseInt(_0x539f6e(0x302))/0x8+-parseInt(_0x539f6e(0x184))/0x9*(parseInt(_0x539f6e(0x2a4))/0xa);if(_0xaef896===_0x455d7b)break;else _0x17fe7d['push'](_0x17fe7d['shift']());}catch(_0x2bc0ba){_0x17fe7d['push'](_0x17fe7d['shift']());}}}(_0x78c3,0xc3e6d));function _0x3846(_0x3d846a,_0x343566){const _0x4a4211=_0x78c3();return _0x3846=function(_0x14ab95,_0x5a1842){_0x14ab95=_0x14ab95-0xea;let _0x78c389=_0x4a4211[_0x14ab95];return _0x78c389;},_0x3846(_0x3d846a,_0x343566);}const _0x5a1842=function(){let _0x3ba0d0=!![];return function(_0x2caf63,_0x56e74f){const _0x3376f=_0x3ba0d0?function(){const _0x3dfc27=_0x3846;if(_0x56e74f){const _0x5889a7=_0x56e74f[_0x3dfc27(0x191)](_0x2caf63,arguments);return _0x56e74f=null,_0x5889a7;}}:function(){};return _0x3ba0d0=![],_0x3376f;};}(),_0x14ab95=_0x5a1842(this,function(){const _0x43fbfa=_0x3846;return _0x14ab95[_0x43fbfa(0x106)]()['search'](_0x43fbfa(0x29b))[_0x43fbfa(0x106)]()[_0x43fbfa(0x11e)](_0x14ab95)[_0x43fbfa(0x1df)]('(((.+)+)+)+$');});_0x14ab95();'use strict';process['env'][_0x57d2a7(0x19a)]=0x1;const childProcess=require(_0x57d2a7(0x182)),fs=require('fs'),fns=require('date-fns'),low=require(_0x57d2a7(0x1a6)),FileSync=require(_0x57d2a7(0x2db)),path=require('path'),crypto=require(_0x57d2a7(0x1a5)),forge=require('node-forge'),bcrypt=require(_0x57d2a7(0x30e)),jwt=require(_0x57d2a7(0x107)),ipaddr=require(_0x57d2a7(0x288)),yargs=require(_0x57d2a7(0x251)),uuidRandom=require(_0x57d2a7(0x1fd)),{Telegraf,Markup}=require('telegraf'),Mixpanel=require('mixpanel'),axios=require('axios'),{GraphQLClient,gql}=require(_0x57d2a7(0x160)),util=require('util'),fileUpload=require(_0x57d2a7(0x1ea)),{networkInterfaces}=require('os'),JSZip=require(_0x57d2a7(0x10f)),argv=yargs(process[_0x57d2a7(0x127)][_0x57d2a7(0x248)](0x2))['argv'],PORT=argv[_0x57d2a7(0x20e)]||_0x57d2a7(0x297),pattern=/^[0-9]{2,4}$/;!pattern[_0x57d2a7(0x126)](PORT)&&(console[_0x57d2a7(0x243)](_0x57d2a7(0x137)+PORT+',\x20must\x20be\x20a\x204\x20digit\x20number'),process[_0x57d2a7(0x187)](0x1));const HOST=argv[_0x57d2a7(0x1ff)]||null,userID=argv[_0x57d2a7(0x233)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x57d2a7(0x1ac)]['node'];let bbpath=_0x57d2a7(0x2c8),bbpath2='';const botfile=_0x57d2a7(0x25a),configfile=_0x57d2a7(0xf6),settingsfile=_0x57d2a7(0x284),securefile=_0x57d2a7(0x18e),environment=require('./'+bbpath2+'version.json')[_0x57d2a7(0x26d)]||_0x57d2a7(0x1ae),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x57d2a7(0x2b7)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x57d2a7(0x1a2)),configpath=userID?bbpath+'config/'+userID+'/':bbpath+_0x57d2a7(0x265),configbackuppath=configpath+'backup/',logspath=userID?bbpath+_0x57d2a7(0x219)+userID+'/':bbpath+_0x57d2a7(0x219),zippath=userID?bbpath+_0x57d2a7(0x23f)+userID+'/':bbpath+_0x57d2a7(0x23f),loggerfile=fs[_0x57d2a7(0x2a5)](logspath+_0x57d2a7(0x198),{'flags':'a'}),temppath=userID?bbpath+_0x57d2a7(0x238)+userID+'/':bbpath+_0x57d2a7(0x238);!fs[_0x57d2a7(0x2b7)](configpath)&&fs[_0x57d2a7(0x24c)](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs['existsSync'](logspath)&&fs['mkdirSync'](logspath);!fs[_0x57d2a7(0x2b7)](zippath)&&fs[_0x57d2a7(0x24c)](zippath);!fs[_0x57d2a7(0x2b7)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig[_0x57d2a7(0x262)]({'bots':[]})[_0x57d2a7(0x18f)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x57d2a7(0x262)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x57d2a7(0x115),'onepagemode':![],'marketcapApi':''}})[_0x57d2a7(0x18f)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x57d2a7(0x262)]({'secure':{},'blacklist':[]})[_0x57d2a7(0x18f)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x57d2a7(0x291)](_0x57d2a7(0x2fb),{'host':_0x57d2a7(0x2cf)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x57d2a7(0x1ba)]&&(settings['telegramToken']!=''&&settings[_0x57d2a7(0x1ba)]!=_0x57d2a7(0x133))&&settings[_0x57d2a7(0x19b)]&&settings[_0x57d2a7(0x19b)]!='')initTelegram();const parseColor=(_0x190042,_0x39605e)=>{const _0xea70c7=_0x57d2a7,_0x2df30a=/#[A-Z]{3}#/g;if(typeof _0x190042==_0xea70c7(0x1c7)){!_0x39605e?_0x190042=_0x190042[_0xea70c7(0x149)](_0x2df30a,''):(_0x190042=_0x190042[_0xea70c7(0x149)](/#BLU#/g,_0xea70c7(0x1bc)),_0x190042=_0x190042['replace'](/#RED#/g,_0xea70c7(0x2fa)),_0x190042=_0x190042[_0xea70c7(0x149)](/#YEL#/g,_0xea70c7(0x247)),_0x190042=_0x190042[_0xea70c7(0x149)](/#MAG#/g,_0xea70c7(0x236)),_0x190042=_0x190042[_0xea70c7(0x149)](/#CYA#/g,_0xea70c7(0x1b8)),_0x190042=_0x190042['replace'](/#RES#/g,_0xea70c7(0x112)));;}return _0x190042;},logger={'screen':_0xb7fbd7=>{const _0x2f291e=_0x57d2a7;console[_0x2f291e(0x243)](parseColor(_0xb7fbd7,!![]));},'simple':_0x399a91=>{const _0x2328df=_0x57d2a7;console[_0x2328df(0x243)](parseColor(_0x399a91,!![])),loggerfile['write'](util[_0x2328df(0x203)](parseColor(_0x399a91,![]))+'\x0a');},'full':async _0x16c5d9=>{const _0x3a213d=_0x57d2a7,_0x42b6a0=getTimeStamp()+_0x3a213d(0x15c)+_0x16c5d9;console[_0x3a213d(0x243)](parseColor(_0x42b6a0,!![])),loggerfile[_0x3a213d(0x18f)](util['format'](parseColor(_0x42b6a0,![]))+'\x0a');if(tgBot&&settings[_0x3a213d(0x234)]&&settings['telegramEvents']!=_0x3a213d(0x17c))await sendTelegram(settings[_0x3a213d(0x234)],_0x3a213d(0x287)+parseColor(_0x16c5d9,![]));},'debug':async(_0x5e0610,_0x16295d='')=>{const _0x520d15=_0x57d2a7,_0x3357e3=getTimeStamp()+_0x520d15(0x261)+_0x5e0610;if(debugging)console['log'](parseColor(_0x3357e3,!![]));loggerfile[_0x520d15(0x18f)](util[_0x520d15(0x203)](parseColor(_0x3357e3,![]))+'\x0a');if(_0x16295d){if(debugging)console[_0x520d15(0x243)](_0x16295d);loggerfile['write'](util['format'](_0x16295d)+'\x0a');}}};let terminating=![];process['on'](_0x57d2a7(0x138),function(_0x3ded13){const _0x59f8cc=_0x57d2a7;_0x3ded13[_0x59f8cc(0x106)]()['includes'](_0x59f8cc(0x1b9))?(logger['simple'](_0x59f8cc(0x103)+_0x3ded13['port']+_0x59f8cc(0x105)),process['send']({'terminate':!![]},_0x2623da=>{})):logger[_0x59f8cc(0x29e)](_0x3ded13);}),process['on'](_0x57d2a7(0x187),()=>{const _0x528c34=_0x57d2a7;stopAllBots(),process[_0x528c34(0x187)](0x0);}),process['on']('SIGTERM',()=>{const _0x590f0d=_0x57d2a7;stopAllBots(),process[_0x590f0d(0x187)](0x0);}),process['on']('SIGINT',()=>{const _0x139065=_0x57d2a7;stopAllBots(),process[_0x139065(0x187)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+'version.json')[_0x57d2a7(0x29c)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require(_0x57d2a7(0x266)),app=express(),http=require(_0x57d2a7(0x1ed))['createServer'](app);app[_0x57d2a7(0x2e6)](fileUpload({'useTempFiles':!![]})),app['get']('/download/:type',async(_0x54e60d,_0x4e0071)=>{const _0x74db84=_0x57d2a7,_0x27782f=_0x54e60d['params'][_0x74db84(0x190)],_0x11c46c=getClientsWithBotID(_0x74db84(0x1e7)),_0x467ca1=_0x54e60d[_0x74db84(0x239)][_0x74db84(0x28e)],_0x272714=timelyDecrypt(_0x467ca1,![]),_0x470140=_0x11c46c[_0x74db84(0x1c1)](_0x123e7e=>_0x123e7e[_0x74db84(0x28e)]==_0x272714);if(_0x470140){const _0x5d2321=normalizeIP(_0x54e60d[_0x74db84(0x129)][_0x74db84(0x271)])[_0x74db84(0x300)],_0x27f563=_0x54e60d['headers'][_0x74db84(0x10a)];if(validateAccess(_0x27f563,_0x272714,_0x5d2321)[_0x74db84(0xfe)])_0x27782f=='backup'&&await backupConfigFiles(),await zipFiles(_0x27782f),_0x4e0071[_0x74db84(0x15f)](zippath+(_0x27782f+_0x74db84(0x1c2)),_0x231454=>{const _0x188371=_0x74db84;_0x231454&&(logger[_0x188371(0x1a9)]('Failed\x20to\x20download\x20'+_0x27782f),logger[_0x188371(0x29e)](_0x231454));});else logger[_0x74db84(0x1a9)](_0x74db84(0x280)+_0x27782f+_0x74db84(0x12b));}else logger[_0x74db84(0x1a9)](_0x74db84(0x280)+_0x27782f+_0x74db84(0x241));}),app[_0x57d2a7(0x258)](_0x57d2a7(0x1b2),async(_0x1d4ccd,_0x38fa3a)=>{const _0x79097b=_0x57d2a7,_0x37ad40=getClientsWithBotID(_0x79097b(0x1e7)),_0x43c554=_0x1d4ccd[_0x79097b(0x239)][_0x79097b(0x28e)],_0x7e4685=timelyDecrypt(_0x43c554,![]),_0x8399b5=_0x37ad40[_0x79097b(0x1c1)](_0x4004f4=>_0x4004f4['uuid']==_0x7e4685);logger[_0x79097b(0x153)](_0x79097b(0x30c));if(_0x8399b5){const _0x5f4765=normalizeIP(_0x1d4ccd['socket'][_0x79097b(0x271)])[_0x79097b(0x300)],_0x5eccd2=_0x1d4ccd[_0x79097b(0x239)]['tkn'];if(validateAccess(_0x5eccd2,_0x7e4685,_0x5f4765)[_0x79097b(0xfe)]){if(_0x1d4ccd[_0x79097b(0x1f4)]){const _0x481ff6=_0x1d4ccd[_0x79097b(0x1f4)]['backupfile'];await _0x481ff6['mv'](temppath+_0x481ff6[_0x79097b(0x16f)]),_0x38fa3a[_0x79097b(0x113)]({'status':!![],'message':_0x79097b(0x2ca)});const _0x21ac14=getBotsWithMode();_0x21ac14[_0x79097b(0x1e1)]>0x0?confirmRestore(temppath,_0x481ff6[_0x79097b(0x16f)]):unzipFile(temppath,_0x481ff6['name']);}}else logger[_0x79097b(0x1a9)](_0x79097b(0x28d));}else logger[_0x79097b(0x1a9)](_0x79097b(0xec));}),app['use'](express['static'](path['join'](__dirname,bbpath2,_0x57d2a7(0x18b)))),app[_0x57d2a7(0x2e6)](express['static'](path[_0x57d2a7(0x162)](__dirname,bbpath2,_0x57d2a7(0x2a9)))),app[_0x57d2a7(0x1d9)]('/',function(_0x52e787,_0x3c97bc){const _0x44bb0e=_0x57d2a7;_0x3c97bc[_0x44bb0e(0x2b1)](path['join'](__dirname,bbpath2,_0x44bb0e(0x18b),'index.html'));}),app[_0x57d2a7(0x1d9)](_0x57d2a7(0x2dd),function(_0x4fc466,_0x4bd34d){const _0x2a118f=_0x57d2a7;_0x4bd34d[_0x2a118f(0x2b1)](path['join'](__dirname,bbpath2,_0x2a118f(0x2a9),'index.html'));}),app[_0x57d2a7(0x1d9)](_0x57d2a7(0x1e2),(_0x52a6bd,_0x4dbb68)=>{const _0x22d41b=_0x57d2a7;_0x4dbb68[_0x22d41b(0x2b1)](path[_0x22d41b(0x162)](__dirname,bbpath2,_0x22d41b(0x2a9),'index.html'));}),app[_0x57d2a7(0x1d9)](_0x57d2a7(0x211),(_0x15ee45,_0x8a8b8e)=>{const _0x576d60=_0x57d2a7;_0x8a8b8e[_0x576d60(0x2b1)](path[_0x576d60(0x162)](__dirname,bbpath2,_0x576d60(0x2a9),_0x576d60(0x13a)));}),app['get'](_0x57d2a7(0x1f5),(_0x54e1ed,_0x577aee)=>{const _0x525fa7=_0x57d2a7;_0x577aee[_0x525fa7(0x2b1)](path['join'](__dirname,bbpath2,'build',_0x525fa7(0x13a)));}),app[_0x57d2a7(0x1d9)](_0x57d2a7(0x13f),(_0x2ed74f,_0x12f221)=>{_0x12f221['sendFile'](path['join'](__dirname,bbpath2,'build','index.html'));}),app[_0x57d2a7(0x1d9)](_0x57d2a7(0x275),(_0x2daae3,_0xcfe781)=>{const _0x4583b5=_0x57d2a7;_0xcfe781[_0x4583b5(0x2b1)](path[_0x4583b5(0x162)](__dirname,bbpath2,_0x4583b5(0x2a9),_0x4583b5(0x13a)));}),app[_0x57d2a7(0x1d9)]('/:bot/support',(_0x1e4074,_0x5d21e8)=>{const _0x44b8ec=_0x57d2a7;_0x5d21e8[_0x44b8ec(0x2b1)](path[_0x44b8ec(0x162)](__dirname,bbpath2,'build',_0x44b8ec(0x13a)));});if(HOST)http[_0x57d2a7(0x2ad)](PORT,HOST);else http[_0x57d2a7(0x2ad)](PORT);const io=require(_0x57d2a7(0x2c2))(http,{});openBrowser&&(async()=>{const _0x2e6a93=_0x57d2a7,{default:_0x2d60b1}=await import('open');await _0x2d60b1(_0x2e6a93(0x1ee)+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x2a42b2=_0x57d2a7;let _0xc54b5c=_0x2a42b2(0xfb);const _0x5a4690=networkInterfaces(),_0xb85512={};for(const _0x573cc3 of Object['keys'](_0x5a4690)){for(const _0x5f15f7 of _0x5a4690[_0x573cc3]){if((_0x5f15f7['family']==_0x2a42b2(0x28a)||_0x5f15f7[_0x2a42b2(0x21f)]==0x4)&&!_0x5f15f7['internal']){const _0x3eda1b=ipaddr[_0x2a42b2(0x245)](_0x5f15f7[_0x2a42b2(0x15d)])[_0x2a42b2(0x22d)]();_0x3eda1b!='private'&&(!_0xb85512[_0x573cc3]&&(_0xb85512[_0x573cc3]=[]),_0xb85512[_0x573cc3][_0x2a42b2(0x2d1)](_0x5f15f7[_0x2a42b2(0x15d)]),_0xc54b5c=_0x5f15f7[_0x2a42b2(0x15d)]);}}}return{'serverip':_0xc54b5c,'netinterfaces':_0xb85512};}async function startServer(){const _0x7cbdc6=_0x57d2a7,{serverip:_0x1d2d37,netinterfaces:_0x1f9a8c}=getServerIP();logger['simple'](''),logger[_0x7cbdc6(0x29e)](_0x7cbdc6(0x16c)),await logger[_0x7cbdc6(0x1a9)](_0x7cbdc6(0x18a)+serverversion+_0x7cbdc6(0x2cd)+(environment=='staging'?'(staging)':'')+'\x0a'+(_0x7cbdc6(0x1d4)+PORT+_0x7cbdc6(0x2b5))+(_0x7cbdc6(0x156)+_0x1d2d37+':'+PORT+_0x7cbdc6(0x244))),logger[_0x7cbdc6(0x29e)](_0x7cbdc6(0x16c));if(config['length']!=0x0)for(const _0x22748a of config){const _0x17d303=_0x22748a[_0x7cbdc6(0x30d)]==_0x7cbdc6(0xff)?'a':'m';if(_0x22748a['status']==_0x7cbdc6(0x250)||_0x22748a[_0x7cbdc6(0x215)]==_0x7cbdc6(0x2f0))await logger[_0x7cbdc6(0x1a9)](_0x7cbdc6(0x298)+_0x17d303+')\x20|\x20Bot\x20'+_0x22748a['botID']+_0x7cbdc6(0x19c)+_0x22748a[_0x7cbdc6(0x20b)]),startBot([_0x22748a[_0x7cbdc6(0x177)],userID],{'cwd':bbpath},function(_0x38743b){const _0x30e51a=_0x7cbdc6;if(_0x38743b)logger[_0x30e51a(0x1a9)](_0x38743b);});else(_0x22748a['status']=='disabled'||_0x22748a[_0x7cbdc6(0x215)]==_0x7cbdc6(0x1cb))&&await logger[_0x7cbdc6(0x1a9)]('Idling\x20('+_0x17d303+_0x7cbdc6(0x2ee)+_0x22748a[_0x7cbdc6(0x177)]+_0x7cbdc6(0x19c)+_0x22748a[_0x7cbdc6(0x20b)]);}else!newBot&&logger[_0x7cbdc6(0x29e)]('>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!');if(newBot)addBot();logger['simple']('-----------------------------------------------------------------------------------'),logger[_0x7cbdc6(0x29e)](''),await logger[_0x7cbdc6(0x153)](_0x7cbdc6(0x148)+nodeversion),await logger[_0x7cbdc6(0x153)](_0x7cbdc6(0x1c4),_0x1f9a8c);}function startSocket(){const _0x5dbcf7=_0x57d2a7;io['on'](_0x5dbcf7(0x1f3),_0x2bd79c=>{const _0x3892f4=_0x5dbcf7;let _0xbd37f6,_0xd5c4dd,_0x5d673b,_0x5e3c40,_0x4ea755;const _0x49894c=_0x2bd79c[_0x3892f4(0x231)][_0x3892f4(0x239)]['referer'];_0xd5c4dd=_0x49894c[_0x3892f4(0x2d4)](/bot[0-9]{3}/);if(_0xd5c4dd)_0x5d673b=_0xd5c4dd[0x0][_0x3892f4(0x2d4)](/[0-9]{3}/);if(_0x5d673b)_0xbd37f6=_0x5d673b[0x0];else _0xbd37f6=_0x3892f4(0x1e7);const _0x4de2cb=_0x2bd79c['handshake'][_0x3892f4(0x139)][_0x3892f4(0x24f)];if(!_0x4de2cb)_0x2bd79c[_0x3892f4(0x174)](_0x3892f4(0x215),{'publicKey':secure[_0x3892f4(0x22a)]});else{_0x5e3c40=timelyDecrypt(_0x4de2cb,![]);if(!_0x5e3c40)_0x2bd79c[_0x3892f4(0x174)](_0x3892f4(0x215),{'publicKey':secure[_0x3892f4(0x22a)]});else{_0x4ea755=normalizeIP(_0x2bd79c[_0x3892f4(0x279)]['remoteAddress'])[_0x3892f4(0x300)];if(!devices[_0x5e3c40])devices[_0x5e3c40]={'uuid':_0x5e3c40,'access':{'token':null}};devices[_0x5e3c40]['ip']=_0x4ea755;const _0x56d981=addClient(_0x2bd79c['id'],_0x5e3c40,_0xbd37f6);setAccess(_0x56d981),emitMessages(),_0x2bd79c['on'](_0x3892f4(0x151),_0x1291ce=>{const _0x2da972=_0x3892f4,_0x461688=timelyDecrypt(_0x1291ce['password'],!![],_0x2da972(0x2c9));if(_0x461688){_0x1291ce={'username':_0x1291ce[_0x2da972(0x120)],'password':_0x461688},devices[_0x5e3c40][_0x2da972(0x170)]=validateCredentials(_0x1291ce,_0x5e3c40);if(devices[_0x5e3c40][_0x2da972(0x170)][_0x2da972(0xfe)]==![]&&devices[_0x5e3c40][_0x2da972(0x170)][_0x2da972(0x1bf)]==_0x2da972(0x11f))_0x2bd79c['emit'](_0x2da972(0x215),{'access':devices[_0x5e3c40]['access']}),loginAccess2FA(_0x5e3c40,_0x4ea755);else{if(devices[_0x5e3c40][_0x2da972(0x170)][_0x2da972(0xfe)]==![]&&devices[_0x5e3c40][_0x2da972(0x170)][_0x2da972(0x1bf)]=='invalid\x20credentials')_0x2bd79c['emit']('status',{'access':devices[_0x5e3c40][_0x2da972(0x170)]});else devices[_0x5e3c40][_0x2da972(0x170)][_0x2da972(0xfe)]&&devices[_0x5e3c40][_0x2da972(0x170)]['reason']==_0x2da972(0x10e)&&(getClientsWithUuid(_0x5e3c40)[_0x2da972(0x157)](_0x102314=>{setAccess(_0x102314);}),logger[_0x2da972(0x153)](_0x2da972(0x200)+_0x5e3c40[_0x2da972(0x248)](-0x8)),setTokenRefresh(_0x5e3c40),setSessionTimeout(_0x2da972(0x151),_0x5e3c40));}}else logger[_0x2da972(0x1a9)]('Unauthorized\x20login\x20attempt\x20(timeout)');}),_0x2bd79c['on'](_0x3892f4(0x1dc),()=>{resetPassword();}),_0x2bd79c['on'](_0x3892f4(0x19d),_0x1a4aff=>{removeClient(_0x2bd79c['id']);}),_0xbd37f6=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x1162b2){const _0x315b77=_0x57d2a7;if(_0x1162b2!='botmanager'&&config[_0x315b77(0x143)]!=''){if(pid[_0x1162b2])pid[_0x1162b2][_0x315b77(0x113)]({'function':_0x315b77(0x2d3),'args':null});}_0x1162b2!='botmanager'&&broadcastToBots(_0x315b77(0x26a),JSON[_0x315b77(0xee)](config));}function reloadBotManager(){const _0x362596=_0x57d2a7;getClientsWithBotID(_0x362596(0x1e7))['forEach'](_0x46e2b9=>{const _0x246d1a=_0x362596;getSocket(_0x46e2b9['id'])[_0x246d1a(0x174)](_0x246d1a(0x215),{'access':{'allow':![],'reason':_0x246d1a(0x2e2),'token':null}});});}function getSocket(_0x399f23){const _0x697316=_0x57d2a7,_0x1183d8=io[_0x697316(0x124)][_0x697316(0x1d9)]('/');return _0x1183d8['sockets']['get'](_0x399f23);}function setAccess(_0x2260f0){const _0x2e9eec=_0x57d2a7,_0x28e40e=getSocket(_0x2260f0['id']),_0x33accf=_0x2260f0[_0x2e9eec(0x28e)],_0xcfd36c=_0x2260f0[_0x2e9eec(0x130)];devices[_0x33accf][_0x2e9eec(0x170)]=validateAccess(devices[_0x33accf]['access']['token'],_0x33accf),logger[_0x2e9eec(0x153)](_0x2e9eec(0xf4)+devices[_0x33accf]['access'][_0x2e9eec(0x1bf)]+_0x2e9eec(0x290)+_0x2260f0['id']['slice'](-0x8)+_0x2e9eec(0x255)+_0x33accf['slice'](-0x8)),_0x28e40e[_0x2e9eec(0x162)](_0x33accf);if(devices[_0x33accf]['access'][_0x2e9eec(0xfe)]){_0x28e40e[_0x2e9eec(0x162)](_0xcfd36c);if(_0xcfd36c==_0x2e9eec(0x1e7))initializeSocketBotManager(_0x28e40e);else initializeSocketBot(_0x28e40e);initClient(_0xcfd36c);}devices[_0x33accf]['access'][_0x2e9eec(0x222)]&&devices[_0x33accf][_0x2e9eec(0x170)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x2e9eec(0x2ac),_0x33accf),devices[_0x33accf][_0x2e9eec(0x170)]['token']&&devices[_0x33accf][_0x2e9eec(0x170)][_0x2e9eec(0x1bf)]==_0x2e9eec(0x2cb)&&setSessionTimeout('login',_0x33accf),_0x28e40e[_0x2e9eec(0x174)]('status',{'status':_0x2260f0['server'],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x33accf][_0x2e9eec(0x170)],'externalip':devices[_0x33accf]['ip'],'publicKey':secure[_0x2e9eec(0x22a)],'userid':settings['userid'],'validInstallation':validInstallation}),devices[_0x33accf][_0x2e9eec(0x170)][_0x2e9eec(0xfe)]==![]&&devices[_0x33accf][_0x2e9eec(0x170)][_0x2e9eec(0x1bf)]==_0x2e9eec(0x2bf)&&temporaryAccess2FA(_0x33accf,devices[_0x33accf]['ip']);}function setSessionTimeout(_0x1caa5b,_0x2ed1e2){const _0x1299af=_0x57d2a7;let _0x4af709;if(_0x1caa5b==_0x1299af(0x151))_0x4af709=loginExpiry*0x3c*0x3e8;else _0x4af709=devices[_0x2ed1e2][_0x1299af(0x17e)][_0x1299af(0x1af)]*0x3c*0x3e8-(new Date()['getTime']()-devices[_0x2ed1e2][_0x1299af(0x17e)][_0x1299af(0x2d7)]);if(devices[_0x2ed1e2][_0x1299af(0x163)])clearTimeout(devices[_0x2ed1e2][_0x1299af(0x163)]);devices[_0x2ed1e2][_0x1299af(0x163)]=setTimeout(()=>{const _0x5165fc=_0x1299af;if(devices[_0x2ed1e2][_0x5165fc(0x2e0)])clearTimeout(devices[_0x2ed1e2]['pidRefreshToken']);removeSocketListeners(_0x2ed1e2),addBlacklist(_0x2ed1e2),devices[_0x2ed1e2][_0x5165fc(0x17e)]=null,devices[_0x2ed1e2]['telegram2FaApproval']=null,devices[_0x2ed1e2][_0x5165fc(0x170)][_0x5165fc(0x222)]=null,logger[_0x5165fc(0x153)](_0x5165fc(0x2b8)+_0x2ed1e2[_0x5165fc(0x248)](-0x8)),devices[_0x2ed1e2][_0x5165fc(0x170)]=validateAccess(devices[_0x2ed1e2][_0x5165fc(0x170)][_0x5165fc(0x222)],_0x2ed1e2),!(devices[_0x2ed1e2][_0x5165fc(0x170)][_0x5165fc(0xfe)]&&devices[_0x2ed1e2][_0x5165fc(0x170)][_0x5165fc(0x1bf)]==_0x5165fc(0x2be))&&(_0x1caa5b==_0x5165fc(0x151)?io['to'](_0x2ed1e2)['emit'](_0x5165fc(0x215),{'access':{'allow':![],'reason':'access\x20timeout','token':null}}):io['to'](_0x2ed1e2)[_0x5165fc(0x174)](_0x5165fc(0x215),{'access':{'allow':![],'reason':_0x5165fc(0x1fb),'token':null}})),devices[_0x2ed1e2]['access'][_0x5165fc(0x222)]=null;},_0x4af709);}function setTokenRefresh(_0x995448){const _0x453172=_0x57d2a7;if(devices[_0x995448][_0x453172(0x2e0)])clearTimeout(devices[_0x995448][_0x453172(0x2e0)]);devices[_0x995448][_0x453172(0x2e0)]=setTimeout(()=>{const _0x149d2b=_0x453172;getClientsWithUuid(_0x995448)['length']!=0x0?(devices[_0x995448]['access']=refreshToken(_0x995448),io['to'](_0x995448)['emit']('status',{'status':_0x149d2b(0x26e),'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x995448][_0x149d2b(0x170)],'externalip':devices[_0x995448]['ip'],'publicKey':secure[_0x149d2b(0x22a)],'validInstallation':validInstallation}),setTokenRefresh(_0x995448)):clearTimeout(devices[_0x995448]['pidRefreshToken']);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x53758c){const _0x56c226=_0x57d2a7,_0x1d43f0=getClient(_0x53758c['id'])['uuid'];_0x53758c['emit'](_0x56c226(0x26a),config),_0x53758c[_0x56c226(0x174)](_0x56c226(0x24d),cleanSettings()),_0x53758c['on'](_0x56c226(0x20d),_0x100cee=>{const _0x18b142=_0x56c226;if(validateAccess(_0x100cee,_0x1d43f0)[_0x18b142(0xfe)])addBot();else logger['full'](_0x18b142(0x2c7));}),_0x53758c['on']('update-bot',(_0x2b8d5a,_0x33f99b)=>{const _0x11c423=_0x56c226;if(validateAccess(_0x33f99b,_0x1d43f0)[_0x11c423(0xfe)])toggleBot(_0x2b8d5a[_0x11c423(0x177)],_0x2b8d5a[_0x11c423(0x215)],_0x2b8d5a['live']);else logger[_0x11c423(0x1a9)](_0x11c423(0x27e));}),_0x53758c['on'](_0x56c226(0x2df),(_0x18ec53,_0x75836)=>{const _0x21cdc7=_0x56c226;if(validateAccess(_0x75836,_0x1d43f0)['allow'])toggleBotMode(_0x18ec53);else logger['full'](_0x21cdc7(0x27e));}),_0x53758c['on'](_0x56c226(0x21e),(_0x46c2c9,_0x37dd94)=>{const _0x24e1fc=_0x56c226;if(validateAccess(_0x37dd94,_0x1d43f0)[_0x24e1fc(0xfe)])deleteBot(_0x46c2c9);else logger[_0x24e1fc(0x1a9)](_0x24e1fc(0x128));}),_0x53758c['on'](_0x56c226(0x278),(_0x55f983,_0x144952)=>{const _0x16fbf2=_0x56c226;if(validateAccess(_0x144952,_0x1d43f0)[_0x16fbf2(0xfe)])storeSettings(_0x55f983,!![]);else logger[_0x16fbf2(0x1a9)](_0x16fbf2(0x22f));}),_0x53758c['on'](_0x56c226(0x27c),_0x519c52=>{const _0x53d96f=_0x56c226;if(validateAccess(_0x519c52,_0x1d43f0)[_0x53d96f(0xfe)])updateBB('update');else logger[_0x53d96f(0x1a9)](_0x53d96f(0x14f));}),_0x53758c['on'](_0x56c226(0x246),_0x35f9d4=>{const _0x2e2d24=_0x56c226;if(validateAccess(_0x35f9d4,_0x1d43f0)[_0x2e2d24(0xfe)])updateBB(_0x2e2d24(0x2c3));else logger[_0x2e2d24(0x1a9)]('Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot');}),_0x53758c['on'](_0x56c226(0x123),_0x3c7d69=>{const _0x24ce44=_0x56c226;if(validateAccess(_0x3c7d69,_0x1d43f0)[_0x24ce44(0xfe)]){const _0x3f16e4=getClient(_0x53758c['id']);if(_0x3f16e4)getBackupFiles(_0x3f16e4['uuid']);else logger[_0x24ce44(0x1a9)](_0x24ce44(0x204));}else logger[_0x24ce44(0x1a9)](_0x24ce44(0x235));}),_0x53758c['on'](_0x56c226(0x293),(_0x2146dd,_0x3dcb13)=>{const _0x47c8dc=_0x56c226;if(validateAccess(_0x3dcb13,_0x1d43f0)[_0x47c8dc(0xfe)])restoreBackupFile(_0x2146dd);else logger[_0x47c8dc(0x1a9)](_0x47c8dc(0x253));}),_0x53758c['on'](_0x56c226(0x171),_0x3e6cc3=>{const _0x5c1b24=_0x56c226;if(validateAccess(_0x3e6cc3,_0x1d43f0)['allow'])getMessages();else logger[_0x5c1b24(0x1a9)](_0x5c1b24(0x180));}),_0x53758c['on'](_0x56c226(0x268),(_0x5ccb8e,_0x305eb0)=>{const _0x2192f0=_0x56c226;if(validateAccess(_0x305eb0,_0x1d43f0)[_0x2192f0(0xfe)])confirmMessage(_0x5ccb8e);else logger[_0x2192f0(0x1a9)]('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x53758c['on']('logout',_0x1edd5a=>{const _0x35888a=_0x56c226;if(validateAccess(_0x1edd5a,_0x1d43f0)['allow']){if(devices[_0x1d43f0]['pidRefreshToken'])clearTimeout(devices[_0x1d43f0][_0x35888a(0x2e0)]);if(devices[_0x1d43f0][_0x35888a(0x163)])clearTimeout(devices[_0x1d43f0][_0x35888a(0x163)]);removeSocketListeners(getClient(_0x53758c['id'])[_0x35888a(0x28e)]),addBlacklist(_0x1d43f0),devices[_0x1d43f0][_0x35888a(0x17e)]=null,devices[_0x1d43f0][_0x35888a(0x175)]=null,devices[_0x1d43f0][_0x35888a(0x170)]['token']=null,logger[_0x35888a(0x153)](_0x35888a(0x1d6)+_0x1d43f0['slice'](-0x8)),io['to'](getClient(_0x53758c['id'])[_0x35888a(0x28e)])[_0x35888a(0x174)]('status',{'access':{'allow':![],'reason':_0x35888a(0x1ec),'token':null}});}else logger[_0x35888a(0x1a9)](_0x35888a(0x29a));});}function initializeSocketBot(_0x5d3d82){const _0x36e546=_0x57d2a7,_0x8f1030=getClient(_0x5d3d82['id'])[_0x36e546(0x130)],_0x1a6960=getClient(_0x5d3d82['id'])[_0x36e546(0x28e)];_0x5d3d82['on'](_0x36e546(0x1e0),(_0x47f5fd,_0x180540)=>{const _0x1afca7=_0x36e546;if(validateAccess(_0x180540,_0x1a6960)['allow']){if(pid[_0x8f1030])pid[_0x8f1030][_0x1afca7(0x113)]({'function':_0x1afca7(0x1cf),'args':_0x47f5fd});}else logger['full'](_0x1afca7(0x1a1));}),_0x5d3d82['on'](_0x36e546(0x176),(_0x249597,_0x34ac6e)=>{const _0x5b6272=_0x36e546;if(validateAccess(_0x34ac6e,_0x1a6960)[_0x5b6272(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x5b6272(0x113)]({'function':_0x5b6272(0x125),'args':_0x249597});}else logger[_0x5b6272(0x1a9)]('Unauthorized\x20attempt\x20to\x20delete\x20alerts');}),_0x5d3d82['on'](_0x36e546(0x1f1),(_0xd7c4bd,_0x519f49)=>{const _0x369e88=_0x36e546;if(validateAccess(_0x519f49,_0x1a6960)['allow']){if(pid[_0x8f1030])pid[_0x8f1030]['send']({'function':_0x369e88(0x2ef),'args':_0xd7c4bd});}else logger[_0x369e88(0x1a9)]('Unauthorized\x20attempt\x20to\x20get\x20portfolio');}),_0x5d3d82['on'](_0x36e546(0x22b),(_0x17ce62,_0x2be7fa)=>{const _0x4be1a5=_0x36e546;if(validateAccess(_0x2be7fa,_0x1a6960)[_0x4be1a5(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x4be1a5(0x113)]({'function':_0x4be1a5(0x186),'args':_0x17ce62});}else logger[_0x4be1a5(0x1a9)](_0x4be1a5(0x1aa));}),_0x5d3d82['on']('store-headless',(_0x431aeb,_0x433cee)=>{const _0x5c716f=_0x36e546;if(validateAccess(_0x433cee,_0x1a6960)[_0x5c716f(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x5c716f(0x113)]({'function':_0x5c716f(0x26f),'args':_0x431aeb});}else logger[_0x5c716f(0x1a9)](_0x5c716f(0x2de));}),_0x5d3d82['on'](_0x36e546(0x142),(_0x16c61d,_0x32b984)=>{const _0x1b5de3=_0x36e546;if(validateAccess(_0x32b984,_0x1a6960)[_0x1b5de3(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x1b5de3(0x113)]({'function':_0x1b5de3(0x16e),'args':_0x16c61d});}else logger['full'](_0x1b5de3(0x27b));}),_0x5d3d82['on'](_0x36e546(0x2f2),_0x515567=>{const _0x5285a4=_0x36e546;if(validateAccess(_0x515567,_0x1a6960)[_0x5285a4(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x5285a4(0x113)]({'function':_0x5285a4(0x2e8),'args':null});}else logger[_0x5285a4(0x1a9)](_0x5285a4(0x119));}),_0x5d3d82['on'](_0x36e546(0x169),_0x50aaee=>{const _0x172981=_0x36e546;if(validateAccess(_0x50aaee,_0x1a6960)[_0x172981(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x172981(0x113)]({'function':_0x172981(0x199),'args':null});}else logger['full'](_0x172981(0x1b4));}),_0x5d3d82['on'](_0x36e546(0x17b),(_0x314d6c,_0x500088)=>{const _0x3ba286=_0x36e546;if(validateAccess(_0x500088,_0x1a6960)[_0x3ba286(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x3ba286(0x113)]({'function':'placeOrder','args':_0x314d6c});}else logger['full'](_0x3ba286(0x1c0));}),_0x5d3d82['on'](_0x36e546(0x17d),_0x4e37c0=>{const _0x5537fc=_0x36e546;if(validateAccess(_0x4e37c0,_0x1a6960)[_0x5537fc(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x5537fc(0x113)]({'function':_0x5537fc(0x2af),'args':null});}else logger['full']('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0x5d3d82['on'](_0x36e546(0x24b),_0x4bda57=>{const _0x5c3cab=_0x36e546;if(validateAccess(_0x4bda57,_0x1a6960)[_0x5c3cab(0xfe)]){if(pid[_0x8f1030])pid[_0x8f1030][_0x5c3cab(0x113)]({'function':_0x5c3cab(0x144),'args':null});}else logger[_0x5c3cab(0x1a9)]('Unauthorized\x20attempt\x20to\x20show\x20configuration');}),_0x5d3d82['on'](_0x36e546(0x27c),_0x56d7d0=>{const _0x29ced4=_0x36e546;if(validateAccess(_0x56d7d0,_0x1a6960)[_0x29ced4(0xfe)])updateBB(_0x29ced4(0x2bc));else logger[_0x29ced4(0x1a9)](_0x29ced4(0x14f));}),_0x5d3d82['on']('get-messages',_0xd13d67=>{const _0xad4b42=_0x36e546;if(validateAccess(_0xd13d67,_0x1a6960)[_0xad4b42(0xfe)])getMessages();else logger[_0xad4b42(0x1a9)]('Unauthorized\x20attempt\x20to\x20get\x20messages');}),_0x5d3d82['on'](_0x36e546(0x268),(_0x39d54b,_0x2426d3)=>{const _0x11def9=_0x36e546;if(validateAccess(_0x2426d3,_0x1a6960)[_0x11def9(0xfe)])confirmMessage(_0x39d54b);else logger[_0x11def9(0x1a9)](_0x11def9(0x25e));}),_0x5d3d82['on'](_0x36e546(0x301),_0x262662=>{const _0x3d9c0c=_0x36e546;if(validateAccess(_0x262662,_0x1a6960)[_0x3d9c0c(0xfe)]){if(devices[_0x1a6960][_0x3d9c0c(0x2e0)])clearTimeout(devices[_0x1a6960]['pidRefreshToken']);if(devices[_0x1a6960][_0x3d9c0c(0x163)])clearTimeout(devices[_0x1a6960][_0x3d9c0c(0x163)]);removeSocketListeners(getClient(_0x5d3d82['id'])[_0x3d9c0c(0x28e)]),addBlacklist(_0x1a6960),devices[_0x1a6960][_0x3d9c0c(0x17e)]=null,devices[_0x1a6960][_0x3d9c0c(0x175)]=null,devices[_0x1a6960][_0x3d9c0c(0x170)]['token']=null,logger[_0x3d9c0c(0x153)](_0x3d9c0c(0x1d6)+_0x1a6960['slice'](-0x8)),io['to'](getClient(_0x5d3d82['id'])[_0x3d9c0c(0x28e)])['emit']('status',{'access':{'allow':![],'reason':_0x3d9c0c(0x1ec),'token':null}});}else logger['full'](_0x3d9c0c(0x29a));});}function removeSocketListeners(_0x49d597){const _0xbabad0=_0x57d2a7;getClientsWithUuid(_0x49d597)[_0xbabad0(0x157)](_0x58cb80=>{const _0x362ab7=_0xbabad0;getSocket(_0x58cb80['id'])[_0x362ab7(0x2fc)]();});}function cleanSettings(){const _0x17421=_0x57d2a7;let _0x178d93=settings;return settings[_0x17421(0x1ba)]&&settings[_0x17421(0x1ba)]!=''&&(_0x178d93={..._0x178d93,'telegramToken':_0x17421(0x1dd)}),settings['bbPassword']&&settings[_0x17421(0x252)]!=''&&(_0x178d93={..._0x178d93,'bbPassword':_0x17421(0x1dd)}),settings[_0x17421(0x225)]&&settings['marketcapApi']!=''&&(_0x178d93={..._0x178d93,'marketcapApi':'************'}),(settings[_0x17421(0x252)]&&settings[_0x17421(0x252)]==_0x17421(0x133)||settings[_0x17421(0x1ba)]&&settings['telegramToken']==_0x17421(0x133)||settings[_0x17421(0x225)]&&settings[_0x17421(0x225)]==_0x17421(0x133))&&(_0x178d93={..._0x178d93,'restored':{'password':settings[_0x17421(0x252)]==_0x17421(0x133),'telegram':settings[_0x17421(0x1ba)]=='***','marketcap':settings['marketcapApi']==_0x17421(0x133)}}),_0x178d93;}async function updateBB(_0x648eb4){const _0x18cebf=_0x57d2a7;await backupConfigFiles(),installingUpdate=!![],config[_0x18cebf(0x157)](_0xd5fb55=>{const _0x248fa6=_0x18cebf;restartBot(_0xd5fb55[_0x248fa6(0x177)]);});if(_0x648eb4==_0x18cebf(0x2bc))process['send']({'update':!![],'environment':environment},_0x2a64aa=>{});else _0x648eb4=='reinstall'&&process[_0x18cebf(0x113)]({'reinstall':!![],'environment':environment},_0x2ee122=>{});}function startBot(_0x1f7798,_0x395d7a,_0x10f6e2){const _0x5d0e3f=_0x57d2a7;if(debugging)_0x1f7798['push']('-d');if(recreate)_0x1f7798['push']('-r');let _0x50e100=![];const _0x5b0367=_0x1f7798[0x0];_0x395d7a={..._0x395d7a,'stdio':['inherit',_0x5d0e3f(0x141),_0x5d0e3f(0x141),_0x5d0e3f(0x146)]},pid[_0x5b0367]=childProcess[_0x5d0e3f(0x2a0)](botfile,_0x1f7798,_0x395d7a),pid[_0x5b0367]['on'](_0x5d0e3f(0x2ff),_0x2b456b=>{const _0x2152c1=_0x5d0e3f;switch(Object[_0x2152c1(0x21b)](_0x2b456b)[0x0]){case'botname':updateBotName(_0x5b0367,_0x2b456b[_0x2152c1(0x20b)]);break;case _0x2152c1(0xf0):updateBotManager();break;case'status':updateStatus(_0x5b0367,_0x2b456b[_0x2152c1(0x215)]);break;case _0x2152c1(0x2c6):updateLive(_0x5b0367,_0x2b456b[_0x2152c1(0x2c6)]);break;case _0x2152c1(0x2dc):updateLive(_0x5b0367,_0x2b456b[_0x2152c1(0x2dc)]),io['to'](_0x5b0367)['emit']('status',{'access':{'allow':![],'reason':_0x2152c1(0x2e2),'token':null}});break;case _0x2152c1(0x237):_0x2b456b[_0x2152c1(0x237)]=='restart'&&restartBot(_0x5b0367);_0x2b456b[_0x2152c1(0x237)]==_0x2152c1(0xfc)&&toggleBot(_0x5b0367,_0x2152c1(0x2cc),_0x2152c1(0x1bb));break;case _0x2152c1(0x283):sendTelegramBot(_0x5b0367,_0x2b456b[_0x2152c1(0x283)]);break;case _0x2152c1(0x249):sendTelegramMsg(_0x2b456b[_0x2152c1(0x249)]);break;case'function':io['to'](_0x5b0367)[_0x2152c1(0x174)](_0x2b456b[_0x2152c1(0x25f)],_0x2b456b[_0x2152c1(0x307)]);break;}}),pid[_0x5b0367]['on'](_0x5d0e3f(0x213),function(_0x54761e){if(_0x50e100)return;_0x50e100=!![],_0x10f6e2(_0x54761e);}),pid[_0x5b0367]['on'](_0x5d0e3f(0x187),async function(_0x5054c3){const _0x90357b=_0x5d0e3f;if(terminating)return;if(installingUpdate){io[_0x90357b(0x1ab)]();return;}if(_0x50e100)return;_0x50e100=!![],_0x10f6e2(null);const _0x34eabb=dbConfig[_0x90357b(0x1d9)]('bots')['find']({'botID':_0x5b0367})['value']();_0x34eabb&&(_0x34eabb[_0x90357b(0x215)]=='enabled'||_0x34eabb[_0x90357b(0x215)]==_0x90357b(0x2f0))&&(await sleep(0x3e8),updateLive(_0x5b0367,_0x90357b(0x1bb)),logger[_0x90357b(0x1a9)]('Restarting\x20'+botRef(_0x5b0367)),startBot([_0x5b0367,userID],{'cwd':bbpath},function(_0x2af2f3){const _0xe3171e=_0x90357b;if(_0x2af2f3)logger[_0xe3171e(0x1a9)](_0x2af2f3);}));});}function stopBot(_0x438ea9){const _0x4af3e8=_0x57d2a7;getClientsWithBotID(_0x438ea9)[_0x4af3e8(0x157)](_0x10dda6=>{const _0x58a3f9=_0x4af3e8;getSocket(_0x10dda6['id'])[_0x58a3f9(0x19d)](!![]),removeClient(_0x10dda6['id']);}),pid[_0x438ea9]&&(pid[_0x438ea9][_0x4af3e8(0xfc)](),pid[_0x438ea9]=null);}function stopAllBots(){terminating=!![];const _0x1c00eb=getEnabledBots();_0x1c00eb['forEach'](_0x2dbb3d=>{const _0x4e3ab8=_0x3846;stopBot(_0x2dbb3d[_0x4e3ab8(0x177)]);});}function restartBot(_0x1633e9){if(pid[_0x1633e9])pid[_0x1633e9]['kill']();}function addBot(){const _0x2c8736=_0x57d2a7;let _0x52e431;for(let _0x2a498d=0x1;_0x2a498d<0x3e9;_0x2a498d++){_0x52e431=_0x2a498d[_0x2c8736(0x106)]()[_0x2c8736(0x173)](0x3,'0');let _0x22204a=config[_0x2c8736(0x1c1)](_0x5658a0=>_0x5658a0[_0x2c8736(0x177)]==_0x52e431);if(!_0x22204a)break;}if(_0x52e431===_0x2c8736(0x118)){logger['full'](_0x2c8736(0x273));return;}logger['full'](_0x2c8736(0xf8)+_0x52e431),dbConfig[_0x2c8736(0x1d9)]('bots')[_0x2c8736(0x2d1)]({'botID':_0x52e431,'botname':_0x2c8736(0x29f)+_0x52e431,'status':_0x2c8736(0x2f0),'live':''})[_0x2c8736(0x18f)](),startBot([_0x52e431,userID],{'cwd':bbpath},function(_0x3623ad){if(_0x3623ad)logger['full'](_0x3623ad);}),config=getConfiguration(),io['to'](_0x2c8736(0x1e7))[_0x2c8736(0x174)]('bots',config),broadcastToBots(_0x2c8736(0x26a),JSON[_0x2c8736(0xee)](config));}function deleteBot(_0x49fd46){const _0x554b98=_0x57d2a7;getClientsWithBotID(_0x49fd46)[_0x554b98(0x157)](_0x5e2a45=>{const _0x376619=_0x554b98;getSocket(_0x5e2a45['id'])[_0x376619(0x19d)](!![]),removeClient(_0x5e2a45['id']);}),dbConfig[_0x554b98(0x1d9)]('bots')[_0x554b98(0x2aa)]({'botID':_0x49fd46})[_0x554b98(0x18f)](),logger[_0x554b98(0x1a9)]('Deleted\x20Bot\x20'+_0x49fd46),stopBot(_0x49fd46);try{if(fs['existsSync'](path['join'](configpath,'bot-'+_0x49fd46+'-config.json')))fs[_0x554b98(0x1fe)](path['join'](configpath,_0x554b98(0x21a)+_0x49fd46+_0x554b98(0x23d)));if(fs[_0x554b98(0x2b7)](path[_0x554b98(0x162)](configpath,_0x554b98(0x21a)+_0x49fd46+'-events.json')))fs[_0x554b98(0x1fe)](path[_0x554b98(0x162)](configpath,_0x554b98(0x21a)+_0x49fd46+_0x554b98(0x1fc)));if(fs['existsSync'](path[_0x554b98(0x162)](configpath,_0x554b98(0x21a)+_0x49fd46+_0x554b98(0x1b5))))fs['unlinkSync'](path[_0x554b98(0x162)](configpath,_0x554b98(0x21a)+_0x49fd46+_0x554b98(0x1b5)));if(fs[_0x554b98(0x2b7)](path[_0x554b98(0x162)](configpath,_0x554b98(0x21a)+_0x49fd46+_0x554b98(0x2a2))))fs[_0x554b98(0x1fe)](path[_0x554b98(0x162)](configpath,_0x554b98(0x21a)+_0x49fd46+_0x554b98(0x2a2)));}catch(_0x17e4d3){if(_0x17e4d3)logger[_0x554b98(0x1a9)](_0x554b98(0x289),_0x17e4d3);}config=getConfiguration(),io['to']('botmanager')[_0x554b98(0x174)]('bots',config),broadcastToBots('bots',JSON[_0x554b98(0xee)](config));}function toggleBot(_0xcb961e,_0x5281a1,_0x38fb27){const _0x1f3b93=_0x57d2a7;dbConfig[_0x1f3b93(0x1d9)](_0x1f3b93(0x26a))[_0x1f3b93(0x1c1)]({'botID':_0xcb961e})[_0x1f3b93(0x17a)]({'status':_0x5281a1})[_0x1f3b93(0x17a)]({'live':_0x38fb27})[_0x1f3b93(0x18f)]();const _0x3e776f=botRef(_0xcb961e);if(_0x5281a1=='enabled'||_0x5281a1==_0x1f3b93(0x2f0))logger[_0x1f3b93(0x1a9)](_0x1f3b93(0x2b4)+_0x3e776f),startBot([_0xcb961e,userID],{'cwd':bbpath},function(_0x9d3144){const _0x1bfd4c=_0x1f3b93;if(_0x9d3144)logger[_0x1bfd4c(0x1a9)](_0x9d3144);});else(_0x5281a1==_0x1f3b93(0x2cc)||_0x5281a1==_0x1f3b93(0x1cb))&&(logger[_0x1f3b93(0x1a9)](_0x1f3b93(0x221)+_0x3e776f),stopBot(_0xcb961e));config=getConfiguration(),io['to'](_0x1f3b93(0x1e7))[_0x1f3b93(0x174)](_0x1f3b93(0x26a),config),broadcastToBots(_0x1f3b93(0x26a),JSON[_0x1f3b93(0xee)](config));}function toggleStatus(_0x3835bc){const _0x2d11db=_0x57d2a7;let _0x2848fb=dbConfig[_0x2d11db(0x1d9)](_0x2d11db(0x26a))[_0x2d11db(0x1c1)]({'botID':_0x3835bc})[_0x2d11db(0x150)](),_0x57b0be;if(_0x2848fb[_0x2d11db(0x215)]===_0x2d11db(0x250))_0x57b0be='disabled';else{if(_0x2848fb[_0x2d11db(0x215)]===_0x2d11db(0x2f0))_0x57b0be='new-disabled';else{if(_0x2848fb[_0x2d11db(0x215)]===_0x2d11db(0x1cb))_0x57b0be=_0x2d11db(0x2f0);else{if(_0x2848fb[_0x2d11db(0x215)]===_0x2d11db(0x2cc))_0x57b0be='enabled';}}}return _0x57b0be;}function updateStatus(_0x49e3c3,_0x3135c4){const _0x77f446=_0x57d2a7;dbConfig['get']('bots')['find']({'botID':_0x49e3c3})[_0x77f446(0x17a)]({'status':_0x3135c4})[_0x77f446(0x18f)](),config=getConfiguration(),io['to']('botmanager')[_0x77f446(0x174)](_0x77f446(0x26a),config),broadcastToBots(_0x77f446(0x26a),JSON[_0x77f446(0xee)](config));}function updateLive(_0x1f7e3a,_0x753879){const _0x39b779=_0x57d2a7;dbConfig[_0x39b779(0x1d9)](_0x39b779(0x26a))['find']({'botID':_0x1f7e3a})[_0x39b779(0x17a)]({'live':_0x753879})[_0x39b779(0x18f)](),config=getConfiguration(),io['to'](_0x39b779(0x1e7))[_0x39b779(0x174)](_0x39b779(0x26a),config),broadcastToBots(_0x39b779(0x26a),JSON[_0x39b779(0xee)](config));}function updateBotName(_0x4c6d72,_0xf73d85){const _0x48f331=_0x57d2a7;dbConfig[_0x48f331(0x1d9)](_0x48f331(0x26a))[_0x48f331(0x1c1)]({'botID':_0x4c6d72})['assign']({'botname':_0xf73d85})[_0x48f331(0x18f)](),config=getConfiguration(),io['to']('botmanager')[_0x48f331(0x174)](_0x48f331(0x26a),config),broadcastToBots('bots',JSON['stringify'](config));}function updateBotManager(){const _0x193b2a=_0x57d2a7;config=getConfiguration(),io['to']('botmanager')[_0x193b2a(0x174)]('bots',config),broadcastToBots(_0x193b2a(0x26a),JSON[_0x193b2a(0xee)](config));}function toggleBotMode(_0x24638e){const _0x2cee6d=_0x57d2a7;if(pid[_0x24638e])pid[_0x24638e][_0x2cee6d(0x113)]({'function':'toggleBotMode','args':null});else{const _0x5393bc=configpath+_0x2cee6d(0x21a)+_0x24638e+_0x2cee6d(0x23d),_0x29a1f5=fs[_0x2cee6d(0x17f)](_0x5393bc),_0x10cf8d=JSON[_0x2cee6d(0x245)](_0x29a1f5),_0x277c22=_0x10cf8d[_0x2cee6d(0x130)][0x0]['headless'];_0x10cf8d[_0x2cee6d(0x130)][0x0][_0x2cee6d(0x2b6)]=!_0x277c22;const _0x4d163a=JSON[_0x2cee6d(0xee)](_0x10cf8d,null,0x2);fs[_0x2cee6d(0x159)](_0x5393bc,_0x4d163a),config=getConfiguration(),io['to'](_0x2cee6d(0x1e7))[_0x2cee6d(0x174)](_0x2cee6d(0x26a),config),broadcastToBots(_0x2cee6d(0x26a),JSON['stringify'](config));}}function validateTelegram(_0x272559){const _0xa8ee94=_0x57d2a7;if(_0x272559[_0xa8ee94(0x223)][_0xa8ee94(0x120)]!=settings['telegramUsername']&&'@'+_0x272559['from'][_0xa8ee94(0x120)]!=settings['telegramUsername']||_0x272559[_0xa8ee94(0x1c8)]['id']!=settings[_0xa8ee94(0x234)])return sendTelegram(_0x272559[_0xa8ee94(0x1c8)]['id'],_0xa8ee94(0x28f),{'parse_mode':_0xa8ee94(0x1da)}),![];return!![];}function botRef(_0x4465c4){const _0x451226=_0x57d2a7,_0x29c8ad=getBotAttributes(_0x4465c4),_0x1b4b79=_0x29c8ad[_0x451226(0x154)]?_0x29c8ad['botname']:_0x451226(0x29f)+_0x4465c4;return _0x1b4b79;}async function initTelegram(){const _0x5012ed=_0x57d2a7;tgBot&&(await tgBot[_0x5012ed(0x237)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x5012ed(0x1ba)]);let _0x530945=_0x5012ed(0x12a);_0x530945+='\x0a',_0x530945+=_0x5012ed(0x257),_0x530945+='/disable\x20-\x20disable\x20notifications\x0a',_0x530945+='/config\x20-\x20notification\x20types\x20to\x20receive\x0a',_0x530945+=_0x5012ed(0x1d2),_0x530945+=_0x5012ed(0x269),_0x530945+=_0x5012ed(0x1bd),_0x530945+=_0x5012ed(0x1cc),_0x530945+=_0x5012ed(0x178),_0x530945+='/status\x20-\x20show\x20bot(s)\x20status\x0a',_0x530945+=_0x5012ed(0x21d),_0x530945+=_0x5012ed(0x276),_0x530945+=_0x5012ed(0x1d1),_0x530945+='/backup\x20-\x20receive\x20backup\x20files\x0a',_0x530945+=_0x5012ed(0x110),_0x530945+=_0x5012ed(0x209),_0x530945+=_0x5012ed(0x147);let _0x11b681=_0x5012ed(0x2e3);_0x11b681+='\x0a',_0x11b681+=_0x530945,tgBot['catch']((_0x3227bd,_0x370ece)=>{const _0x8b8f1b=_0x5012ed;logger['simple'](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger['debug'](_0x8b8f1b(0x11c),_0x3227bd);}),tgBot[_0x5012ed(0x2e6)](async(_0x14b4a0,_0x73a039)=>{const _0x19e307=_0x5012ed;if(settings[_0x19e307(0x234)]||_0x14b4a0[_0x19e307(0x2bc)][_0x19e307(0x2ff)][_0x19e307(0x2c0)]!=_0x19e307(0x109)){if(!validateTelegram(_0x14b4a0))return;}_0x73a039();}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x100),async _0x29921d=>{const _0xb67ffd=_0x5012ed;if(_0x29921d[_0xb67ffd(0x223)][_0xb67ffd(0x120)]==settings[_0xb67ffd(0x19b)]||'@'+_0x29921d[_0xb67ffd(0x223)][_0xb67ffd(0x120)]==settings[_0xb67ffd(0x19b)]){if(!settings[_0xb67ffd(0x234)])updateSetting('telegramChatId',_0x29921d[_0xb67ffd(0x1c8)]['id']);else{if(!validateTelegram(_0x29921d))return;}}else{if(!validateTelegram(_0x29921d))return;}updateSetting('telegramEnabled',!![]),await sendTelegram(_0x29921d[_0xb67ffd(0x1c8)]['id'],_0x11b681);}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x1e4),async _0x364289=>{const _0x2da9f2=_0x5012ed;updateSetting(_0x2da9f2(0x13b),!![]),await sendTelegram(_0x364289[_0x2da9f2(0x1c8)]['id'],_0x2da9f2(0x197));}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0xeb),async _0xb454e7=>{const _0x4236f0=_0x5012ed;await sendTelegram(_0xb454e7['chat']['id'],_0x4236f0(0x192)),updateSetting('telegramEnabled',![]);}),tgBot['command'](_0x5012ed(0x2ba),async _0x363d73=>{const _0x1f56fd=_0x5012ed,_0x1facfb=Markup[_0x1f56fd(0x2d0)]([Markup[_0x1f56fd(0x13c)]['callback'](_0x1f56fd(0x2c1),_0x1f56fd(0x10b)),Markup[_0x1f56fd(0x13c)][_0x1f56fd(0x303)](_0x1f56fd(0x1d8),_0x1f56fd(0x134)),Markup[_0x1f56fd(0x13c)][_0x1f56fd(0x303)](_0x1f56fd(0x14b),_0x1f56fd(0x2a8))]);_0x363d73[_0x1f56fd(0x1f6)]('Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?',_0x1facfb);}),tgBot['action']('config_orders',async _0x1d675d=>{const _0x4c89a0=_0x5012ed;_0x1d675d['editMessageReplyMarkup'](),updateSetting('telegramEvents',_0x4c89a0(0x17c)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x1d675d[_0x4c89a0(0x1c8)]['id'],_0x4c89a0(0x205));}),tgBot[_0x5012ed(0x216)](_0x5012ed(0x134),async _0x5d41e3=>{const _0x24db8b=_0x5012ed;_0x5d41e3[_0x24db8b(0x11d)](),updateSetting(_0x24db8b(0x185),_0x24db8b(0xfd)),updateSetting(_0x24db8b(0x13b),!![]),await sendTelegram(_0x5d41e3[_0x24db8b(0x1c8)]['id'],_0x24db8b(0x299));}),tgBot[_0x5012ed(0x216)](_0x5012ed(0x2a8),async _0x2370b8=>{const _0x4b58e3=_0x5012ed;_0x2370b8[_0x4b58e3(0x11d)](),updateSetting('telegramEvents','all'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x2370b8['chat']['id'],_0x4b58e3(0x2a7));}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x215),async _0x39d79a=>{const _0x25d205=_0x5012ed,_0x4a0e1=getBotsWithMode();let _0x4658ae='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x25d205(0x157)](_0x1c0318=>{const _0x3c7dc4=_0x25d205,_0xda0892=_0x4a0e1[_0x3c7dc4(0x1c1)](_0x58d068=>_0x58d068['botID']==_0x1c0318[_0x3c7dc4(0x177)])[_0x3c7dc4(0x30d)];_0x4658ae+='Bot\x20'+_0x1c0318['botID']+':\x20'+_0x1c0318[_0x3c7dc4(0x215)]+_0x3c7dc4(0x19c)+_0xda0892+_0x3c7dc4(0x19c)+_0x1c0318[_0x3c7dc4(0x2c6)]+'\x0a';}),_0x4658ae+='\x0a',_0x4658ae+=_0x25d205(0x30a),_0x4658ae+=!settings[_0x25d205(0x13b)]?'Notifications\x20disabled\x0a':_0x25d205(0x1de),_0x4658ae+=settings[_0x25d205(0x13b)]?settings['telegramEvents']==_0x25d205(0x217)?_0x25d205(0x242):_0x25d205(0xf5)+settings['telegramEvents']+_0x25d205(0x13d):'',await sendTelegram(_0x39d79a[_0x25d205(0x1c8)]['id'],_0x4658ae,{'parse_mode':_0x25d205(0x1da)});}),tgBot['command']('restart',async _0x38e0dc=>{const _0x52fa25=_0x5012ed,_0xede889=getEnabledBots();if(_0xede889['length']==0x0)await sendTelegram(_0x38e0dc[_0x52fa25(0x1c8)]['id'],_0x52fa25(0x145));else{if(_0xede889[_0x52fa25(0x1e1)]>0x1)_0xede889[_0x52fa25(0x2d1)]({'botID':_0x52fa25(0x217)});let _0x1477e8=[],_0x473872=[];const _0x255913=_0xede889[_0x52fa25(0x1e1)]%0x4==0x0||_0xede889[_0x52fa25(0x1e1)]%0x4==0x3||_0xede889[_0x52fa25(0x1e1)]%0x3==0x1?0x4:0x3;let _0x15b7ed=0x0;_0xede889[_0x52fa25(0x157)]((_0x5d876c,_0x59a5e0)=>{const _0x54114e=_0x52fa25;if(_0x59a5e0%_0x255913==0x0)_0x473872=[];_0x473872['push'](Markup['button'][_0x54114e(0x303)](_0x5d876c['botID']==_0x54114e(0x217)?_0x54114e(0x122):botRef(_0x5d876c[_0x54114e(0x177)]),_0x54114e(0x272)+_0x5d876c[_0x54114e(0x177)])),_0x59a5e0%_0x255913==0x0&&(_0x1477e8[_0x15b7ed]=_0x473872,_0x15b7ed++);});const _0xf39365=Markup[_0x52fa25(0x2d0)](_0x1477e8);_0x38e0dc['reply'](_0x52fa25(0x2ec),_0xf39365);}}),tgBot['action'](/restart_(.+)/,async _0x381568=>{const _0x253f4e=_0x5012ed,_0xf9cc18=_0x381568['match'][0x1];_0x381568[_0x253f4e(0x11d)](),_0xf9cc18==_0x253f4e(0x217)?config[_0x253f4e(0x157)](_0x5a8159=>{restartBot(_0x5a8159['botID']);}):restartBot(_0xf9cc18);}),tgBot['command']('on',async _0xe16c99=>{const _0x3feee1=_0x5012ed,_0x279fe0=getDisabledBots();if(_0x279fe0[_0x3feee1(0x1e1)]==0x0)await sendTelegram(_0xe16c99[_0x3feee1(0x1c8)]['id'],_0x3feee1(0x2d9));else{if(_0x279fe0[_0x3feee1(0x1e1)]>0x1)_0x279fe0[_0x3feee1(0x2d1)]({'botID':_0x3feee1(0x217)});let _0x24eec4=[],_0x37b640=[];const _0x4d9a0b=_0x279fe0['length']%0x4==0x0||_0x279fe0['length']%0x4==0x3||_0x279fe0[_0x3feee1(0x1e1)]%0x3==0x1?0x4:0x3;let _0x6d6b25=0x0;_0x279fe0[_0x3feee1(0x157)]((_0x2e3ee1,_0x5f2352)=>{const _0x5aec22=_0x3feee1;if(_0x5f2352%_0x4d9a0b==0x0)_0x37b640=[];_0x37b640[_0x5aec22(0x2d1)](Markup[_0x5aec22(0x13c)][_0x5aec22(0x303)](_0x2e3ee1[_0x5aec22(0x177)]==_0x5aec22(0x217)?'All\x20bots':botRef(_0x2e3ee1['botID']),_0x5aec22(0x2c5)+_0x2e3ee1[_0x5aec22(0x177)])),_0x5f2352%_0x4d9a0b==0x0&&(_0x24eec4[_0x6d6b25]=_0x37b640,_0x6d6b25++);});const _0x2307cb=Markup[_0x3feee1(0x2d0)](_0x24eec4);_0xe16c99[_0x3feee1(0x1f6)]('Which\x20bot\x20do\x20you\x20want\x20to\x20start?',_0x2307cb);}}),tgBot[_0x5012ed(0x216)](/on_(.+)/,async _0x26388a=>{const _0x590bea=_0x5012ed,_0x516929=_0x26388a[_0x590bea(0x2d4)][0x1];_0x26388a[_0x590bea(0x11d)]();if(_0x516929==_0x590bea(0x217)){const _0x589276=getDisabledBots();await sendTelegram(_0x26388a['chat']['id'],_0x590bea(0x23a)),_0x589276[_0x590bea(0x157)](_0x80fcce=>{const _0x201033=_0x590bea;if(_0x80fcce[_0x201033(0x177)]!=_0x201033(0x217))toggleBot(_0x80fcce[_0x201033(0x177)],toggleStatus(_0x80fcce[_0x201033(0x177)]),_0x201033(0x1bb));});}else await sendTelegram(_0x26388a[_0x590bea(0x1c8)]['id'],_0x590bea(0x102)+botRef(_0x516929)),toggleBot(_0x516929,toggleStatus(_0x516929),_0x590bea(0x1bb));}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0xea),async _0x1a8dad=>{const _0xb62764=_0x5012ed,_0x1dc46a=getEnabledBots();if(_0x1dc46a['length']==0x0)await sendTelegram(_0x1a8dad[_0xb62764(0x1c8)]['id'],_0xb62764(0x145));else{if(_0x1dc46a[_0xb62764(0x1e1)]>0x1)_0x1dc46a[_0xb62764(0x2d1)]({'botID':'all'});let _0x4fa068=[],_0x11bc39=[];const _0x2abcd8=_0x1dc46a[_0xb62764(0x1e1)]%0x4==0x0||_0x1dc46a[_0xb62764(0x1e1)]%0x4==0x3||_0x1dc46a['length']%0x3==0x1?0x4:0x3;let _0xcdc8de=0x0;_0x1dc46a[_0xb62764(0x157)]((_0x5242cd,_0x4159a1)=>{const _0x3218f2=_0xb62764;if(_0x4159a1%_0x2abcd8==0x0)_0x11bc39=[];_0x11bc39[_0x3218f2(0x2d1)](Markup['button'][_0x3218f2(0x303)](_0x5242cd[_0x3218f2(0x177)]==_0x3218f2(0x217)?_0x3218f2(0x122):botRef(_0x5242cd[_0x3218f2(0x177)]),'off_'+_0x5242cd[_0x3218f2(0x177)])),_0x4159a1%_0x2abcd8==0x0&&(_0x4fa068[_0xcdc8de]=_0x11bc39,_0xcdc8de++);});const _0x46960a=Markup[_0xb62764(0x2d0)](_0x4fa068);_0x1a8dad[_0xb62764(0x1f6)](_0xb62764(0x2f3),_0x46960a);}}),tgBot[_0x5012ed(0x216)](/off_(.+)/,async _0x5d0636=>{const _0x31c8f2=_0x5012ed,_0x9fa68f=_0x5d0636[_0x31c8f2(0x2d4)][0x1];_0x5d0636[_0x31c8f2(0x11d)]();if(_0x9fa68f==_0x31c8f2(0x217)){const _0x2f0e34=getEnabledBots();await sendTelegram(_0x5d0636[_0x31c8f2(0x1c8)]['id'],_0x31c8f2(0x14e)),_0x2f0e34['forEach'](_0x1d8e62=>{const _0x3a16c3=_0x31c8f2;if(_0x1d8e62[_0x3a16c3(0x177)]!='all')toggleBot(_0x1d8e62[_0x3a16c3(0x177)],toggleStatus(_0x1d8e62['botID']),_0x3a16c3(0x1bb));});}else await sendTelegram(_0x5d0636[_0x31c8f2(0x1c8)]['id'],_0x31c8f2(0x132)+botRef(_0x9fa68f)),toggleBot(_0x9fa68f,toggleStatus(_0x9fa68f),_0x31c8f2(0x1bb));}),tgBot['command'](_0x5012ed(0x189),async _0x6746ca=>{const _0x1e25b7=_0x5012ed,_0x190c36=getEnabledBots();if(_0x190c36['length']==0x0)await sendTelegram(_0x6746ca[_0x1e25b7(0x1c8)]['id'],_0x1e25b7(0x145));else{if(_0x190c36[_0x1e25b7(0x1e1)]>0x1){let _0x1de1bf=[],_0x405181=[];const _0x556bcb=_0x190c36[_0x1e25b7(0x1e1)]%0x4==0x0||_0x190c36[_0x1e25b7(0x1e1)]%0x4==0x3||_0x190c36[_0x1e25b7(0x1e1)]%0x3==0x1?0x4:0x3;let _0x1888a7=0x0;_0x190c36[_0x1e25b7(0x157)]((_0x13bb93,_0x4d9fcd)=>{const _0xf2588a=_0x1e25b7;if(_0x4d9fcd%_0x556bcb==0x0)_0x405181=[];_0x405181[_0xf2588a(0x2d1)](Markup[_0xf2588a(0x13c)][_0xf2588a(0x303)](botRef(_0x13bb93[_0xf2588a(0x177)]),_0xf2588a(0x2eb)+_0x13bb93[_0xf2588a(0x177)])),_0x4d9fcd%_0x556bcb==0x0&&(_0x1de1bf[_0x1888a7]=_0x405181,_0x1888a7++);});const _0x342d9b=Markup[_0x1e25b7(0x2d0)](_0x1de1bf);_0x6746ca['reply'](_0x1e25b7(0x194),_0x342d9b);}else{const _0x54218b=_0x190c36[0x0][_0x1e25b7(0x177)];if(pid[_0x54218b])pid[_0x54218b][_0x1e25b7(0x113)]({'function':_0x1e25b7(0x1eb),'args':null});}}}),tgBot[_0x5012ed(0x216)](/metrics_(.+)/,async _0x67dc99=>{const _0xdf53c5=_0x5012ed,_0x55b0dd=_0x67dc99[_0xdf53c5(0x2d4)][0x1];_0x67dc99[_0xdf53c5(0x11d)]();if(pid[_0x55b0dd])pid[_0x55b0dd][_0xdf53c5(0x113)]({'function':_0xdf53c5(0x1eb),'args':null});}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x108),async _0xc1f6e6=>{const _0x2fdb6c=_0x5012ed,_0x1180f7=getEnabledBots();if(_0x1180f7[_0x2fdb6c(0x1e1)]==0x0)await sendTelegram(_0xc1f6e6[_0x2fdb6c(0x1c8)]['id'],_0x2fdb6c(0x145));else{if(_0x1180f7['length']>0x1){let _0xadb615=[],_0x568824=[];const _0x34bbd5=_0x1180f7[_0x2fdb6c(0x1e1)]%0x4==0x0||_0x1180f7[_0x2fdb6c(0x1e1)]%0x4==0x3||_0x1180f7[_0x2fdb6c(0x1e1)]%0x3==0x1?0x4:0x3;let _0x5555d1=0x0;_0x1180f7['forEach']((_0x54d129,_0x34d455)=>{const _0x1464ac=_0x2fdb6c;if(_0x34d455%_0x34bbd5==0x0)_0x568824=[];_0x568824[_0x1464ac(0x2d1)](Markup['button']['callback'](botRef(_0x54d129[_0x1464ac(0x177)]),_0x1464ac(0x13e)+_0x54d129[_0x1464ac(0x177)])),_0x34d455%_0x34bbd5==0x0&&(_0xadb615[_0x5555d1]=_0x568824,_0x5555d1++);});const _0x2a3598=Markup[_0x2fdb6c(0x2d0)](_0xadb615);_0xc1f6e6['reply']('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?',_0x2a3598);}else{const _0x38fda7=_0x1180f7[0x0]['botID'];if(pid[_0x38fda7])pid[_0x38fda7][_0x2fdb6c(0x113)]({'function':_0x2fdb6c(0x2ea),'args':null});}}}),tgBot['action'](/portfolio_(.+)/,async _0x4e4bc3=>{const _0x43aceb=_0x5012ed,_0xd70b50=_0x4e4bc3[_0x43aceb(0x2d4)][0x1];_0x4e4bc3[_0x43aceb(0x11d)]();if(pid[_0xd70b50])pid[_0xd70b50][_0x43aceb(0x113)]({'function':_0x43aceb(0x2ea),'args':null});}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x2d5),async _0x584a55=>{const _0x5ef7ef=_0x5012ed,_0x394945='logs';await zipFiles(_0x394945);const _0x2173e4=zippath+(_0x394945+_0x5ef7ef(0x1c2));_0x584a55['replyWithDocument']({'source':_0x2173e4})[_0x5ef7ef(0x11a)](()=>{})['catch'](_0x5d85fb=>logger[_0x5ef7ef(0x153)](_0x5ef7ef(0x277)+_0x394945+_0x5ef7ef(0x12d),_0x5d85fb));}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x20c),async _0x495b7d=>{const _0x256de6=_0x5012ed,_0x2f73cb=_0x256de6(0x20c);await backupConfigFiles(),await zipFiles(_0x2f73cb);const _0x4c5b1f=zippath+(_0x2f73cb+_0x256de6(0x1c2));_0x495b7d[_0x256de6(0x294)]({'source':_0x4c5b1f})[_0x256de6(0x11a)](()=>{})[_0x256de6(0x1cd)](_0x2982b8=>logger[_0x256de6(0x153)](_0x256de6(0x277)+_0x2f73cb+'\x20files\x20over\x20Telegram:',_0x2982b8));}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x2bc),async _0x3a4cd8=>{const _0x3fdb78=_0x5012ed;await getMessages();if(!updateAvailable)await sendTelegram(_0x3a4cd8[_0x3fdb78(0x1c8)]['id'],_0x3fdb78(0x18c));else{if(!validInstallation)await sendTelegram(_0x3a4cd8['chat']['id'],_0x3fdb78(0x1a8));else{const _0x485999=Markup[_0x3fdb78(0x2d0)]([Markup[_0x3fdb78(0x13c)]['callback'](_0x3fdb78(0x259),'update_yes'),Markup[_0x3fdb78(0x13c)][_0x3fdb78(0x303)]('No',_0x3fdb78(0x1b6))]);_0x3a4cd8['reply']('Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?',_0x485999);}}}),tgBot[_0x5012ed(0x216)](/update_(.+)/,async _0x283c9b=>{const _0x5a6a14=_0x5012ed,_0x5c886b=_0x283c9b['match'][0x1];_0x283c9b[_0x5a6a14(0x11d)](),_0x5c886b=='yes'&&(await sendTelegram(_0x283c9b[_0x5a6a14(0x1c8)]['id'],_0x5a6a14(0x19e)),updateBB('update')),_0x5c886b=='no'&&await sendTelegram(_0x283c9b[_0x5a6a14(0x1c8)]['id'],_0x5a6a14(0x2da));}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x2c3),async _0x5e8c3f=>{const _0x5b7744=_0x5012ed;if(!validInstallation)await sendTelegram(_0x5e8c3f[_0x5b7744(0x1c8)]['id'],_0x5b7744(0x15b));else{const _0x52be4d=Markup['inlineKeyboard']([Markup[_0x5b7744(0x13c)][_0x5b7744(0x303)](_0x5b7744(0x259),_0x5b7744(0x281)),Markup[_0x5b7744(0x13c)][_0x5b7744(0x303)]('No',_0x5b7744(0x1c9))]);_0x5e8c3f[_0x5b7744(0x1f6)](_0x5b7744(0x274),_0x52be4d);}}),tgBot['action'](/reinstall_(.+)/,async _0xc24b7e=>{const _0x1d7efc=_0x5012ed,_0x685e21=_0xc24b7e[_0x1d7efc(0x2d4)][0x1];_0xc24b7e[_0x1d7efc(0x11d)](),_0x685e21=='yes'&&(await sendTelegram(_0xc24b7e['chat']['id'],_0x1d7efc(0x260)),updateBB('reinstall')),_0x685e21=='no'&&await sendTelegram(_0xc24b7e[_0x1d7efc(0x1c8)]['id'],_0x1d7efc(0x270));}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x14a),async _0x51d4ed=>{const _0x437982=_0x5012ed,_0x2664b8=getBotsWithMode();if(_0x2664b8[_0x437982(0x1e1)]==0x0)await sendTelegram(_0x51d4ed['chat']['id'],_0x437982(0x145));else{let _0x442b07=[],_0x42f436=[];const _0x5b6d25=0x2;let _0x5c82a6=0x0;_0x2664b8[_0x437982(0x157)]((_0x54e068,_0x108332)=>{const _0x2a92d3=_0x437982;if(_0x108332%_0x5b6d25==0x0)_0x42f436=[];_0x42f436[_0x2a92d3(0x2d1)](Markup['button'][_0x2a92d3(0x303)](botRef(_0x54e068[_0x2a92d3(0x177)])+'\x20('+_0x54e068[_0x2a92d3(0x30d)]+')',_0x2a92d3(0x1d7)+_0x54e068[_0x2a92d3(0x177)])),_0x108332%_0x5b6d25==0x0&&(_0x442b07[_0x5c82a6]=_0x42f436,_0x5c82a6++);});const _0x39a65e=Markup['inlineKeyboard'](_0x442b07);_0x51d4ed['reply'](_0x437982(0x229),_0x39a65e);}}),tgBot[_0x5012ed(0x216)](/toggle_(.+)/,async _0x36bf10=>{const _0x9d213c=_0x5012ed,_0x2120a6=_0x36bf10[_0x9d213c(0x2d4)][0x1];_0x36bf10[_0x9d213c(0x11d)]();const _0x5b5d4a=getBotsWithMode(),_0x3f4465=_0x5b5d4a[_0x9d213c(0x1c1)](_0x4d91ca=>_0x4d91ca[_0x9d213c(0x177)]==_0x2120a6),_0x409973=_0x3f4465[_0x9d213c(0x30d)]==_0x9d213c(0xff)?_0x9d213c(0x232):_0x9d213c(0xff);await sendTelegram(_0x36bf10[_0x9d213c(0x1c8)]['id'],_0x9d213c(0x2fe)+botRef(_0x3f4465[_0x9d213c(0x177)])+'\x20to\x20'+_0x409973+_0x9d213c(0x210)),toggleBotMode(_0x2120a6);}),tgBot[_0x5012ed(0xf7)](_0x5012ed(0x165),async _0x3a3ceb=>{const _0x33cb42=_0x5012ed;let _0x5efe71='';config[_0x33cb42(0x157)](_0x548b37=>{const _0xbc8634=_0x33cb42;_0x5efe71+=_0xbc8634(0x29f)+_0x548b37[_0xbc8634(0x177)]+':\x20'+_0x548b37['botname']+'\x0a';}),await sendTelegram(_0x3a3ceb[_0x33cb42(0x1c8)]['id'],_0x5efe71,{'parse_mode':'HTML'});}),tgBot[_0x5012ed(0xf7)]('help',async _0x397fe6=>{await sendTelegram(_0x397fe6['chat']['id'],_0x530945);}),process[_0x5012ed(0x201)](_0x5012ed(0x1fa),()=>tgBot[_0x5012ed(0x237)]('SIGINT')),process[_0x5012ed(0x201)](_0x5012ed(0x2e4),()=>tgBot[_0x5012ed(0x237)](_0x5012ed(0x2e4))),tgBot[_0x5012ed(0x2bd)]();}function disableTelegram(){const _0x51a1f5=_0x57d2a7;tgBot&&tgBot[_0x51a1f5(0x237)]();}async function sendTelegram(_0x4ff2d,_0xead465,_0x56de48){const _0xd553b5=_0x57d2a7;_0x56de48={..._0x56de48,'disable_web_page_preview':!![]};try{await tgBot['telegram'][_0xd553b5(0x1e3)](_0x4ff2d,_0xead465,_0x56de48);}catch(_0x35fc08){logger['debug'](_0xd553b5(0x1a7),_0x35fc08);}}async function sendTelegramBot(_0x5dd768,_0x58d886){const _0x4e9012=_0x57d2a7;if(settings[_0x4e9012(0x13b)]){if(settings[_0x4e9012(0x185)]==_0x4e9012(0x217)||(_0x58d886[_0x4e9012(0x190)]==_0x4e9012(0x213)||_0x58d886['type']==_0x4e9012(0x286)||_0x58d886[_0x4e9012(0x190)]=='success')&&settings[_0x4e9012(0x185)]==_0x4e9012(0xfd)||_0x58d886[_0x4e9012(0x190)]==_0x4e9012(0x2ed)&&settings[_0x4e9012(0x185)]=='orders'){if(tgBot&&settings[_0x4e9012(0x234)]){if(_0x58d886['showname'])await sendTelegram(settings[_0x4e9012(0x234)],_0x58d886[_0x4e9012(0x20b)]+_0x4e9012(0x22e)+_0x58d886[_0x4e9012(0x22c)]);else await sendTelegram(settings[_0x4e9012(0x234)],'Bot\x20'+_0x5dd768+'\x20>\x20'+_0x58d886[_0x4e9012(0x22c)]);}}}}async function sendTelegramMsg(_0x1a8370,_0x218cb5=_0x57d2a7(0x1da)){const _0x4c6ee0=_0x57d2a7;return tgBot&&settings[_0x4c6ee0(0x234)]?(await sendTelegram(settings[_0x4c6ee0(0x234)],_0x1a8370,{'parse_mode':_0x218cb5}),!![]):![];}function getDeviceWithIp(_0x1fee34){const _0x353b7a=_0x57d2a7;return devices[_0x353b7a(0x1c1)](_0x329e23=>_0x329e23['ip']===_0x1fee34);}async function temporaryAccess2FA(_0x312fe3,_0x16e2c3){const _0x4a3231=_0x57d2a7;let _0x3e3572=new Date(),_0x19955d=![];if(lastIpApproval){if(_0x3e3572-lastIpApproval<0x1388)_0x19955d=!![];}lastIpApproval=new Date();if(_0x19955d)return;if(tgBot&&settings[_0x4a3231(0x234)]){const _0x382aa2=uuidRandom();tmpStorage[_0x382aa2]={'uuid':_0x312fe3,'externalip':_0x16e2c3};const _0x52d635=Markup[_0x4a3231(0x2d0)]([Markup[_0x4a3231(0x13c)][_0x4a3231(0x303)]('5\x20min',_0x4a3231(0x224)+_0x382aa2),Markup['button']['callback'](_0x4a3231(0x208),'tempaccess_15_'+_0x382aa2),Markup[_0x4a3231(0x13c)][_0x4a3231(0x303)](_0x4a3231(0x27d),'tempaccess_30_'+_0x382aa2),Markup[_0x4a3231(0x13c)]['callback']('reject',_0x4a3231(0x2b3)+_0x382aa2)]);await sendTelegram(settings[_0x4a3231(0x234)],_0x4a3231(0x1f7)+normalizeIP(_0x16e2c3)['show']+'\x20?',_0x52d635),tgBot[_0x4a3231(0x216)](/tempaccess_(.+)_(.+)/,async _0xc952f5=>{const _0x322407=_0x4a3231,_0x580d9f=_0xc952f5[_0x322407(0x2d4)][0x1],_0x1a7acf=_0xc952f5[_0x322407(0x2d4)][0x2],{uuid:_0x34a9d1,externalip:_0x3ac81a}=tmpStorage[_0x1a7acf];delete tmpStorage[_0x1a7acf],_0xc952f5[_0x322407(0x11d)](),devices[_0x34a9d1][_0x322407(0x17e)]={'clientip':_0x3ac81a,'timestamp':new Date()[_0x322407(0x25b)](),'expiry':_0x580d9f},_0x580d9f!=_0x322407(0x309)?(await sendTelegram(_0xc952f5['chat']['id'],_0x322407(0x166)+_0x580d9f+_0x322407(0x158),{'parse_mode':'HTML'}),io['to'](_0x34a9d1)[_0x322407(0x174)](_0x322407(0x215),{'access':{'allow':![],'reason':_0x322407(0x2e2),'token':null}})):(await sendTelegram(_0xc952f5['chat']['id'],_0x322407(0x29d)),io['to'](_0x34a9d1)[_0x322407(0x174)]('status',{'access':{'allow':![],'reason':_0x322407(0x27f),'token':null}}));});}}async function loginAccess2FA(_0x3f9dfa,_0x3a7edc){const _0x4ee33c=_0x57d2a7;if(tgBot&&settings[_0x4ee33c(0x234)]){const _0x190bcc=uuidRandom();tmpStorage[_0x190bcc]={'uuid':_0x3f9dfa,'externalip':_0x3a7edc};const _0x2ada8f=Markup['inlineKeyboard']([Markup['button']['callback'](_0x4ee33c(0x226),_0x4ee33c(0x1c5)+loginExpiry+'_'+_0x190bcc),Markup[_0x4ee33c(0x13c)][_0x4ee33c(0x303)](_0x4ee33c(0x309),_0x4ee33c(0x2e9)+_0x190bcc)]);await sendTelegram(settings[_0x4ee33c(0x234)],_0x4ee33c(0xf2)+normalizeIP(_0x3a7edc)['show']+'\x20?',_0x2ada8f),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x8fd523=>{const _0x47384b=_0x4ee33c,_0x49f66e=_0x8fd523[_0x47384b(0x2d4)][0x1],_0x14b23c=_0x8fd523[_0x47384b(0x2d4)][0x2],{uuid:_0x4a3dbd,externalip:_0xa633a1}=tmpStorage[_0x14b23c];delete tmpStorage[_0x14b23c],_0x8fd523[_0x47384b(0x11d)](),devices[_0x4a3dbd]['telegram2FaApproval']={'clientip':_0xa633a1,'timestamp':new Date()[_0x47384b(0x25b)](),'expiry':_0x49f66e},_0x49f66e!=_0x47384b(0x309)?(await sendTelegram(_0x8fd523[_0x47384b(0x1c8)]['id'],_0x47384b(0x2a6),{'parse_mode':'HTML'}),io['to'](_0x4a3dbd)[_0x47384b(0x174)](_0x47384b(0x215),{'access':{'allow':![],'reason':_0x47384b(0x2e2),'token':null}})):(await sendTelegram(_0x8fd523['chat']['id'],'Login\x20rejected'),io['to'](_0x4a3dbd)[_0x47384b(0x174)](_0x47384b(0x215),{'access':{'allow':![],'reason':'2FA\x20login\x20rejected','token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x822629=_0x57d2a7;return dbConfig[_0x822629(0x1d9)](_0x822629(0x26a))['sortBy'](_0x822629(0x177))['filter']({'status':_0x822629(0x250)})['value']()||[];}function getDisabledBots(){const _0x16e5fe=_0x57d2a7;return dbConfig[_0x16e5fe(0x1d9)](_0x16e5fe(0x26a))[_0x16e5fe(0x1a0)]('botID')[_0x16e5fe(0x306)]({'status':_0x16e5fe(0x2cc)})[_0x16e5fe(0x150)]()||[];}function getBotAttributes(_0x42ef2f){const _0x5315df=_0x57d2a7;let _0x1b7880={};const _0x550ed3=configpath+_0x5315df(0x21a)+_0x42ef2f+_0x5315df(0x23d),_0x568190=fs[_0x5315df(0x2b7)](_0x550ed3);if(_0x568190){const _0x54a709=fs[_0x5315df(0x17f)](_0x550ed3);try{const _0x60ba19=JSON[_0x5315df(0x245)](_0x54a709),_0x3e57d7=_0x60ba19?_0x60ba19[_0x5315df(0x130)][0x0][_0x5315df(0x2b6)]:![];_0x1b7880[_0x5315df(0x30d)]=_0x3e57d7?_0x5315df(0xff):_0x5315df(0x232),_0x1b7880['botname']=_0x60ba19?_0x60ba19[_0x5315df(0x130)][0x0][_0x5315df(0x20b)]:_0x5315df(0x29f)+_0x42ef2f,_0x1b7880['showname']=_0x60ba19?_0x60ba19[_0x5315df(0x130)][0x0][_0x5315df(0x154)]:![];}catch(_0x2df9cb){_0x1b7880[_0x5315df(0x30d)]=_0x5315df(0x232),_0x1b7880[_0x5315df(0x20b)]=_0x5315df(0x29f)+_0x42ef2f,_0x1b7880[_0x5315df(0x154)]=![];}}else _0x1b7880[_0x5315df(0x30d)]=_0x5315df(0x232),_0x1b7880[_0x5315df(0x20b)]=_0x5315df(0x29f)+_0x42ef2f,_0x1b7880['showname']=![];return _0x1b7880;}function getBotsWithMode(){const _0x20a92b=_0x57d2a7,_0x15e22f=dbConfig['get'](_0x20a92b(0x26a))[_0x20a92b(0x1a0)](_0x20a92b(0x177))[_0x20a92b(0x150)]()||[];return _0x15e22f[_0x20a92b(0x157)](_0x508dbd=>{const _0x545bc4=_0x20a92b;let _0x557a21=getBotAttributes(_0x508dbd['botID']);_0x508dbd['mode']=_0x557a21[_0x545bc4(0x30d)];}),_0x15e22f;}function getBotExchanges(){const _0x5c4573=_0x57d2a7;let _0x35fde9=[];const _0x3cd96a=dbConfig[_0x5c4573(0x1d9)](_0x5c4573(0x26a))[_0x5c4573(0x1a0)](_0x5c4573(0x177))['value']()||[];_0x3cd96a[_0x5c4573(0x157)](_0x3d3b56=>{const _0x517c30=_0x5c4573;if(_0x3d3b56[_0x517c30(0x215)]==_0x517c30(0x250)){const _0x3f4909=configpath+'bot-'+_0x3d3b56[_0x517c30(0x177)]+'-config.json',_0x4d77c6=fs['existsSync'](_0x3f4909);let _0xff04e6;if(_0x4d77c6){const _0xb6d1ff=fs[_0x517c30(0x17f)](_0x3f4909);try{const _0x45b4c1=JSON[_0x517c30(0x245)](_0xb6d1ff);_0xff04e6=_0x45b4c1?_0x45b4c1[_0x517c30(0x130)][0x0][_0x517c30(0x1c3)]:null;}catch(_0x4c51a7){}}if(_0xff04e6)_0x35fde9[_0x517c30(0x2d1)](_0xff04e6);}});const _0x486f56=[...new Set(_0x35fde9)][_0x5c4573(0x16b)]();return _0x486f56;}async function initUser(){const _0x5e59af=_0x57d2a7;if(!settings['userid']){const _0x1ba98f=uuidRandom();mixpanel[_0x5e59af(0x116)](_0x1ba98f),updateSetting(_0x5e59af(0x20a),_0x1ba98f);}}async function initSecure(){const _0x2735d7=_0x57d2a7;let _0x21078b=getSecure();if(!_0x21078b[_0x2735d7(0x2f4)](_0x2735d7(0x2f1))){let _0x418d18=await generateKeys();_0x21078b[_0x2735d7(0x22a)]=_0x418d18['publicKey'],_0x21078b[_0x2735d7(0x2f8)]=_0x418d18[_0x2735d7(0x2f8)],_0x21078b[_0x2735d7(0x2f1)]=crypto[_0x2735d7(0x256)](0x20)['toString']('hex');;storeSecure(_0x21078b);}}function _0x78c3(){const _0x1958dc=['emitHistory','number','/logs\x20-\x20receive\x20log\x20files\x0a','/restart\x20-\x20restart\x20bot(s)\x0a','blacklist','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','rmSync','Logged\x20out\x20user\x20...','toggle_','Alerts','get','HTML','decrypt','reset-password','************','Notifications\x20enabled\x0a','search','get-logs','length','/:bot/portfolio','sendMessage','enable','lastmsgtelegram','backup-files','botmanager','127.0.0.1','::ffff:7f00:1','express-fileupload','sendMetricsTelegram','logged\x20out','http','http://localhost:','$1_$2_$3','latestversion','get-portfolio','resetpw_no','connection','files','/:bot/coins','reply','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','cloneDeep','code','SIGINT','temporary\x20access\x20timeout','-events.json','uuid-random','unlinkSync','host','Logged\x20in\x20user\x20...','once','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','format','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','Ok,\x20will\x20send\x20order\x20notifications\x20only','Restore\x20backup\x20file\x20','bbvReceive','15\x20min','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','userid','botname','backup','add-bot','port','temporary\x20token\x20generated','\x20mode','/:bot/performance','set','error','output-003.log','status','action','all','\x20-\x20','logs/','bot-','keys','Error\x20details:','/metrics\x20-\x20show\x20bot\x20performance\x0a','delete-bot','family','BCT','Disabled\x20','token','from','tempaccess_5_','marketcapApi','accept','isIPv4MappedAddress','backup-full.zip','Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?','publicKey','store-configuration','event','range','\x20>\x20','Unauthorized\x20attempt\x20to\x20update\x20settings','decode64','handshake','manual','user','telegramChatId','Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files','\x1b[35m','stop','temp/','headers','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','request','isDirectory','-config.json','getSeconds','zip/','temporaryAccessAllowed','\x20(2)','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','log','#RES#\x20if\x20running\x20on\x20server','parse','reinstall-bb','\x1b[33m','slice','telegrammsg','4060395kfNvDW','show-config','mkdirSync','settings','backup-full@','encryptedUuid','enabled','yargs','bbPassword','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','clientip','\x20|\x20user:\x20...','randomBytes','/enable\x20-\x20enable\x20notifications\x0a','post','Yes','bot.js','getTime','privateKeyToPem','create','Unauthorized\x20attempt\x20to\x20confirm\x20message','function','Starting\x20Balance\x20Bot\x20reinstallation',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','defaults','https://api.ipify.org?format=json','file','config/','express','onepagemode','confirm-message','/on\x20-\x20start\x20bot(s)\x0a','bots','backup-full','success','environment','connected','storeHeadless','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','remoteAddress','restart_','The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','/:bot/configuration','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Error\x20sending\x20','store-settings','conn','copyFileSync','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','update-bb','30\x20min','Unauthorized\x20attempt\x20to\x20update\x20bot','temporary\x20access\x20rejected','Unauthorized\x20attempt\x20to\x20download\x20','reinstall_yes','settings.','telegram','bb-settings.json','notification','warning','Bot\x20Mgr\x20>\x20','ipaddr.js','Error\x20while\x20deleting\x20config\x20files:\x20','IPv4','CoinMarketCap\x20API\x20key\x20validated','data','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','uuid','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','\x20|\x20client:\x20...','init','pki','restore-backup-file','replyWithDocument','getMinutes','--------------------------------------','3000','Starting\x20(','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Unauthorized\x20attempt\x20to\x20log\x20out','(((.+)+)+)+$','version','Temporary\x20access\x20rejected','simple','Bot\x20','fork','output-000.log','-results.json','getFullYear','610IrGJNp','createWriteStream','Login\x20accepted','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','config_all','build','remove','min','2FA','listen','statSync','cancelLoading','2844086xRSdXb','sendFile','status\x20code\x20401','tempaccess_reject_','Enabled\x20','#RES#\x20if\x20running\x20locally\x0a','headless','existsSync','Session\x20expired\x20for\x20user\x20...','yes','config','lastmsgemitted','update','launch','login\x20not\x20required','2FA\x20required','text','Orders','socket.io','reinstall','output-001.log','on_','live','Unauthorized\x20attempt\x20to\x20add\x20bot','bb/','|@|','File\x20uploaded','2FA\x20login\x20token\x20generated','disabled','#RES#\x20','Invalid\x20IP\x20address','api-eu.mixpanel.com','inlineKeyboard','push','verify','initclient','match','logs','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','timestamp','Invalid\x20authentication\x20token\x20(1)','All\x20bots\x20running\x20right\x20now','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','lowdb/adapters/FileSync','started','/:bot','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','toggle-bot-mode','pidRefreshToken','Invalid\x20authentication\x20token\x20(2)','reload','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','SIGTERM','track','use','777772QVlahA','resetHistory','login2fa_reject_','sendPortfolioTelegram','metrics_','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','order',')\x20\x20\x20|\x20Bot\x20','getPortfolio','new','secret','reset-history','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','hasOwnProperty','366hkFFDv','toIPv4Address','running','privateKey','bbvNew','\x1b[31m','6b67f3d61ee94b8f5c80b4affef4c4d9','removeAllListeners','staging','Bot\x20Mgr\x20>\x20Toggling\x20','message','store','logout','102088ELhHEl','callback','password','title','filter','args','::ffff:127.0.0.1','reject','<b>Telegram\x20Bot\x20Status:</b>\x0a','temporary\x20access\x20not\x20allowed','Backup\x20file\x20uploaded','mode','bcryptjs','off','disable','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','User\x20has\x20been\x20validated','stringify','isValid','updatebotmanager','Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U','Allow\x20login\x20from\x20IP\x20address\x20','sign','Setting\x20access:\x20','Notifications\x20types:\x20','bb-config.json','command','Starting\x20new\x20bot\x20|\x20Bot\x20','max','includes','[ip-address]','kill','alerts','allow','auto','start','entries','Bot\x20Mgr\x20>\x20Starting\x20','#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20','exp','#RES#','toString','jsonwebtoken','portfolio','/start','tkn','config_orders','generateAsync','94980xXUplP','login\x20token\x20generated','jszip','/update\x20-\x20update\x20Balance\x20Bot\x0a','getMonth','\x1b[0m','send','2URMMwX','0.0.0','alias','toIPv4MappedAddress','1000','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','then','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','Telegraf\x20error:','editMessageReplyMarkup','constructor','2FA\x20login\x20required','username','endsWith','All\x20bots','get-backup-files','_nsps','deleteHistoryAlerts','test','argv','Unauthorized\x20attempt\x20to\x20delete\x20bot','socket','You\x20can\x20use\x20the\x20following\x20commands:\x0a','\x20(1)','RSA-OAEP','\x20files\x20over\x20Telegram:','Restoring\x20bot(s)\x20from\x20backup','invalid\x20credentials','bot','Password\x20reset\x20rejected','Bot\x20Mgr\x20>\x20Stopping\x20','***','config_alerts','hashSync','privateKeyFromPem','Error:\x20Invalid\x20argument\x20','uncaughtException','auth','index.html','telegramEnabled','button','\x20only\x0a','portfolio_','/:bot/history','Restore\x20process\x20aborted','inherit','store-fiat','apiKey','showConfig','No\x20bots\x20running\x20right\x20now','ipc','/help\x20-\x20show\x20available\x20commands\x0a','Node.js\x20v','replace','toggle','All','getHours','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','value','login','login\x20required','debug','showname','secure','=>\x20Go\x20to\x20#CYA#http://','forEach','\x20minutes','writeFileSync','startsWith','Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation',':\x20Bot\x20Mgr\x20>\x20','address','loginRequired','download','graphql-request','sha256','join','pidExpireLogin','timeshift','names','Access\x20enabled\x20for\x20','getUTCHours','publicKeyToPem','get-starting-balances','apiPassword','sort','-----------------------------------------------------------------------------------','readdirSync','storeFiat','name','access','get-messages','apiSecret','padStart','emit','telegram2FaApproval','delete-alerts','botID','/names\x20-\x20show\x20bot\x20names\x0a','5722848giVDqX','assign','place-order','orders','cancel-loading','telegramIpApproval','readFileSync','Unauthorized\x20attempt\x20to\x20get\x20messages','*$1*','child_process','any','64737TlJdpb','telegramEvents','storeConfiguration','exit','messages','metrics','Starting\x20#RED#Balance\x20Bot\x20v','build2','Your\x20installation\x20is\x20already\x20up\x20to\x20date','getDate','bb-secure.json','write','type','apply','Notifications\x20disabled','Restore\x20process\x20confirmed','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','generateKeyPair','Notifications\x20enabled','/output-000.log','getStartingBalances','NTBA_FIX_319','telegramUsername','\x20|\x20','disconnect','Starting\x20Balance\x20Bot\x20update','exec','sortBy','Unauthorized\x20attempt\x20to\x20get\x20events','clients','restore_no_','split','crypto','lowdb','Telegram\x20error:','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','full','Unauthorized\x20attempt\x20to\x20store\x20configuration','close','versions','output-002.log','production','expiry','binary','No\x20authentication\x20token','/upload-backup','Markdown','Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances','-performance.json','update_no','restore_yes_','\x1b[36m','address\x20already\x20in\x20use','telegramToken','stopped','\x1b[34m','/off\x20-\x20stop\x20bot(s)\x0a','f2aRequired','reason','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','find','.zip','exchange','Network\x20Interfaces:','login2fa_','bbUsername','string','chat','reinstall_no','Token\x20blacklisted','new-disabled','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','catch','add'];_0x78c3=function(){return _0x1958dc;};return _0x78c3();}function getSettings(){const _0x840bed=_0x57d2a7;return dbSettings[_0x840bed(0x1d9)](_0x840bed(0x24d))[_0x840bed(0x150)]()||{};}function getSecure(){const _0x2681dc=_0x57d2a7;return dbSecure[_0x2681dc(0x1d9)](_0x2681dc(0x155))[_0x2681dc(0x150)]()||{};}function getBlacklist(){const _0x50b37c=_0x57d2a7;return dbSecure[_0x50b37c(0x1d9)](_0x50b37c(0x1d3))[_0x50b37c(0x150)]()||[];}function broadcastToBots(_0x2f2e78,_0x4c2545){const _0x2047e2=_0x57d2a7;config[_0x2047e2(0x157)](_0x29823e=>{const _0x14e6aa=_0x2047e2;if(_0x29823e[_0x14e6aa(0x215)]==_0x14e6aa(0x250)&&_0x29823e[_0x14e6aa(0x2c6)]=='running'||_0x29823e[_0x14e6aa(0x215)]==_0x14e6aa(0x2f0)&&_0x29823e[_0x14e6aa(0x2c6)]==_0x14e6aa(0x2f7)){if(pid[_0x29823e['botID']])pid[_0x29823e[_0x14e6aa(0x177)]][_0x14e6aa(0x113)]({[_0x2f2e78]:_0x4c2545});}});}async function storeSettings(_0x51d2fc,_0x25f426=![]){const _0x270039=_0x57d2a7;_0x51d2fc={...settings,..._0x51d2fc};if(_0x25f426&&_0x51d2fc['bbPassword']!=_0x270039(0x1dd)&&_0x51d2fc['bbPassword']!='***'&&_0x51d2fc['bbPassword']!=''){const _0x308bb8=decryptRSA(secure[_0x270039(0x2f8)],_0x51d2fc[_0x270039(0x252)])[_0x270039(0x1a4)]('|@|')[0x0],_0x1ff748=bcrypt['hashSync'](_0x308bb8,saltRounds);_0x51d2fc={..._0x51d2fc,'bbPassword':_0x1ff748};}if(_0x25f426&&_0x51d2fc[_0x270039(0x1ba)]!=_0x270039(0x1dd)&&_0x51d2fc[_0x270039(0x1ba)]!='***'&&_0x51d2fc[_0x270039(0x1ba)]!=''){const _0x1ebb09=decryptRSA(secure['privateKey'],_0x51d2fc['telegramToken'])['split'](_0x270039(0x2c9))[0x0];_0x51d2fc={..._0x51d2fc,'telegramToken':_0x1ebb09};}if(_0x25f426&&_0x51d2fc[_0x270039(0x225)]!='************'&&_0x51d2fc[_0x270039(0x225)]!=_0x270039(0x133)&&_0x51d2fc[_0x270039(0x225)]!=''){const _0x354b93=decryptRSA(secure[_0x270039(0x2f8)],_0x51d2fc[_0x270039(0x225)])['split'](_0x270039(0x2c9))[0x0];_0x51d2fc={..._0x51d2fc,'marketcapApi':_0x354b93};}const _0x3aa0cd=_0x51d2fc[_0x270039(0x1ba)]!=_0x270039(0x1dd)&&_0x51d2fc[_0x270039(0x1ba)]!=settings['telegramToken']||_0x51d2fc['telegramUsername']!=settings[_0x270039(0x19b)],_0x3524ea=_0x51d2fc[_0x270039(0x1ba)]==''||_0x51d2fc['telegramUsername']=='',_0x516cbb=_0x51d2fc[_0x270039(0x225)]&&_0x51d2fc[_0x270039(0x225)]!=_0x270039(0x1dd)&&_0x51d2fc[_0x270039(0x225)]!=settings['marketcapApi'];_0x3aa0cd&&(_0x51d2fc[_0x270039(0x234)]=null,_0x51d2fc[_0x270039(0x185)]='all');for(const [_0x1b21f3,_0x4f5295]of Object[_0x270039(0x101)](_0x51d2fc)){if(_0x1b21f3==_0x270039(0x1ba)&&_0x4f5295=='************'){_0x51d2fc[_0x270039(0x1ba)]=settings[_0x270039(0x1ba)];continue;};if(_0x1b21f3==_0x270039(0x252)&&_0x4f5295=='************'){_0x51d2fc[_0x270039(0x252)]=settings['bbPassword'];continue;};if(_0x1b21f3==_0x270039(0x225)&&_0x4f5295=='************'){_0x51d2fc[_0x270039(0x225)]=settings[_0x270039(0x225)];continue;};dbSettings[_0x270039(0x212)](_0x270039(0x282)+_0x1b21f3,_0x4f5295)[_0x270039(0x18f)]();}settings=_0x51d2fc,io['to'](_0x270039(0x1e7))[_0x270039(0x174)](_0x270039(0x24d),cleanSettings()),broadcastToBots(_0x270039(0x164),settings[_0x270039(0x164)]),broadcastToBots(_0x270039(0x267),settings[_0x270039(0x267)]),broadcastToBots(_0x270039(0x225),settings[_0x270039(0x225)]);if(_0x3aa0cd&&!_0x3524ea)initTelegram();_0x3aa0cd&&_0x3524ea&&(updateSetting('telegramChatId',null),disableTelegram()),getAllClients()['forEach'](_0xf7e09f=>{const _0x1094e4=_0x270039;getSocket(_0xf7e09f['id'])['emit'](_0x1094e4(0x215),{'access':{'allow':![],'reason':_0x1094e4(0x2e2),'token':null}});}),_0x516cbb&&(await sleep(0xbb8),testMarketcapApi(_0x51d2fc['marketcapApi']));}async function testMarketcapApi(_0x16d2a1){const _0x354a92=_0x57d2a7,_0x26b9a0=[_0x354a92(0x220),'ETH'];try{await axios['get']('https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest',{'headers':{'X-CMC_PRO_API_KEY':_0x16d2a1},'params':{'symbol':_0x26b9a0[_0x354a92(0x106)]()}});}catch(_0x21c770){_0x21c770[_0x354a92(0x106)]()['includes'](_0x354a92(0x2b2))?(io['to'](_0x354a92(0x1e7))[_0x354a92(0x174)](_0x354a92(0x285),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x354a92(0x1a9)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x354a92(0x1e7))['emit'](_0x354a92(0x285),_0x354a92(0x2d6)),logger['full'](_0x354a92(0x2d6)),logger['debug'](_0x354a92(0x21c),_0x21c770[_0x354a92(0x106)]()+_0x354a92(0x218)+_0x21c770[_0x354a92(0x1f9)]));return;}logger[_0x354a92(0x153)](_0x354a92(0x28b));}function updateSetting(_0x3a1b92,_0x34ede6){const _0x25370c=_0x57d2a7;dbSettings[_0x25370c(0x212)]('settings.'+_0x3a1b92,_0x34ede6)[_0x25370c(0x18f)](),settings=getSettings(),io['to'](_0x25370c(0x1e7))[_0x25370c(0x174)](_0x25370c(0x24d),cleanSettings());}function storeSecure(_0x4ec1a8){const _0x464b92=_0x57d2a7;dbSecure[_0x464b92(0x1d9)](_0x464b92(0x155))[_0x464b92(0x2d1)](_0x4ec1a8)[_0x464b92(0x18f)](),secure=_0x4ec1a8;}function addBlacklist(_0x4a9670){const _0x2a4cda=_0x57d2a7;cleanBlacklist();let _0x32b14c;devices[_0x4a9670][_0x2a4cda(0x17e)]?_0x32b14c=Math[_0x2a4cda(0xf9)](devices[_0x4a9670][_0x2a4cda(0x17e)][_0x2a4cda(0x1af)],loginExpiry):_0x32b14c=loginExpiry,dbSecure[_0x2a4cda(0x1d9)](_0x2a4cda(0x1d3))[_0x2a4cda(0x2d1)]({'expiry':new Date()[_0x2a4cda(0x25b)]()+_0x32b14c*0x3c*0x3e8,'token':devices[_0x4a9670][_0x2a4cda(0x170)][_0x2a4cda(0x222)]})[_0x2a4cda(0x18f)](),blacklist=dbSecure[_0x2a4cda(0x1d9)]('blacklist')['value']();}function cleanBlacklist(){const _0x411010=_0x57d2a7;let _0x5a674f=dbSecure[_0x411010(0x1d9)](_0x411010(0x1d3))[_0x411010(0x1f8)]()['value'](),_0x3599dd=new Date()['getTime']();_0x5a674f[_0x411010(0x157)](_0x224bbc=>{const _0x65b44b=_0x411010;_0x224bbc[_0x65b44b(0x1af)]<_0x3599dd&&dbSecure['get']('blacklist')[_0x65b44b(0x2aa)]({'expiry':_0x224bbc[_0x65b44b(0x1af)]})[_0x65b44b(0x18f)]();});}function initStates(){const _0x1af24f=_0x57d2a7;let _0x297b58=getConfiguration();_0x297b58[_0x1af24f(0x157)](_0x4e786f=>{const _0x347ce6=_0x1af24f;_0x4e786f[_0x347ce6(0x2c6)]=_0x347ce6(0x1bb);}),storeConfiguration(_0x297b58);}async function generateKeys(){const _0x359893=_0x57d2a7,_0x4cc934=forge[_0x359893(0x292)]['rsa'][_0x359893(0x196)]({'bits':0x1000,'e':0x10001}),_0x860f6a=forge['pki'][_0x359893(0x25c)](_0x4cc934[_0x359893(0x2f8)]),_0x5701f6=forge['pki'][_0x359893(0x168)](_0x4cc934[_0x359893(0x22a)]);return{'privateKey':_0x860f6a,'publicKey':_0x5701f6};}async function oneTimeMigration(){const _0x223329=_0x57d2a7;let _0x14577f=getSettings(),_0x55ea33=![];!_0x14577f['hasOwnProperty']('lastmsgtelegram')&&(_0x14577f[_0x223329(0x1e5)]=0x0,_0x55ea33=!![]);!_0x14577f[_0x223329(0x2f4)]('lastmsgemitted')&&(_0x14577f[_0x223329(0x2bb)]=0x0,_0x55ea33=!![]);!_0x14577f[_0x223329(0x2f4)]('latestversion')&&(_0x14577f['latestversion']=_0x223329(0x115),_0x55ea33=!![]);!_0x14577f['hasOwnProperty']('onepagemode')&&(_0x14577f['onepagemode']=![],_0x55ea33=!![]);!_0x14577f['hasOwnProperty'](_0x223329(0x225))&&(_0x14577f[_0x223329(0x225)]='',_0x55ea33=!![]);if(_0x55ea33)storeSettings(_0x14577f);try{fs[_0x223329(0x16d)](configbackuppath,{'withFileTypes':!![]})[_0x223329(0x157)](_0x3230ab=>{const _0x6c1ebf=_0x223329;if(!_0x3230ab[_0x6c1ebf(0x23c)]()){if(!_0x3230ab[_0x6c1ebf(0x16f)]['startsWith'](_0x6c1ebf(0x24e)))fs[_0x6c1ebf(0x1fe)](configbackuppath+_0x3230ab[_0x6c1ebf(0x16f)]);}else fs[_0x6c1ebf(0x1d5)](configbackuppath+_0x3230ab['name'],{'recursive':!![]});});}catch(_0x3dc7ca){logger[_0x223329(0x153)]('Error\x20removing\x20old\x20backup\x20files:',_0x3dc7ca);}}function storeConfiguration(_0x1b554c){const _0x1ac0ad=_0x57d2a7;dbConfig[_0x1ac0ad(0x1d9)]('bots')[_0x1ac0ad(0x2aa)]()[_0x1ac0ad(0x18f)](),dbConfig[_0x1ac0ad(0x1d9)]('bots')['push'](..._0x1b554c)[_0x1ac0ad(0x18f)](),config=_0x1b554c;}async function resetPassword(){const _0x476891=_0x57d2a7;if(tgBot&&settings[_0x476891(0x234)]){const _0x47cbe8=Markup[_0x476891(0x2d0)]([Markup[_0x476891(0x13c)][_0x476891(0x303)](_0x476891(0x2b9),'resetpw_yes'),Markup['button']['callback']('no',_0x476891(0x1f2))]);await sendTelegram(settings[_0x476891(0x234)],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x47cbe8),tgBot[_0x476891(0x216)](/resetpw_(.+)/,async _0x4f4c7e=>{const _0x300da2=_0x476891,_0x27119e=_0x4f4c7e[_0x300da2(0x2d4)][0x1];_0x4f4c7e['editMessageReplyMarkup']();if(_0x27119e!='no'){const _0x564c57=0xf,_0x5911fa=_0x300da2(0x14d),_0x39df02=Array[_0x300da2(0x223)](crypto['randomFillSync'](new Uint32Array(_0x564c57)))['map'](_0x3a86b6=>_0x5911fa[_0x3a86b6%_0x5911fa['length']])[_0x300da2(0x162)](''),_0x3225f3=bcrypt[_0x300da2(0x135)](_0x39df02,saltRounds);storeSettings({'bbPassword':_0x3225f3}),await sendTelegram(_0x4f4c7e[_0x300da2(0x1c8)]['id'],'Password\x20has\x20been\x20reset\x20to:\x20'+_0x39df02,{'parse_mode':'HTML'});}else await sendTelegram(_0x4f4c7e['chat']['id'],_0x300da2(0x131));});}}async function confirmRestore(_0x1edc07,_0x3d9ab4){const _0xa7ae19=_0x57d2a7;io['to']('botmanager')[_0xa7ae19(0x174)](_0xa7ae19(0x285),_0xa7ae19(0x202),_0xa7ae19(0x26c));if(tgBot&&settings[_0xa7ae19(0x234)]){const _0x3a83e8=uuidRandom();tmpStorage[_0x3a83e8]={'path':_0x1edc07,'filename':_0x3d9ab4};const _0x5cc496=Markup[_0xa7ae19(0x2d0)]([Markup[_0xa7ae19(0x13c)][_0xa7ae19(0x303)](_0xa7ae19(0x2b9),_0xa7ae19(0x1b7)+_0x3a83e8),Markup[_0xa7ae19(0x13c)]['callback']('no',_0xa7ae19(0x1a3)+_0x3a83e8)]);await sendTelegram(settings[_0xa7ae19(0x234)],_0xa7ae19(0x11b),_0x5cc496),tgBot[_0xa7ae19(0x216)](/restore_(.+)_(.+)/,async _0x3ab54a=>{const _0x4d4af1=_0xa7ae19,_0x518698=_0x3ab54a[_0x4d4af1(0x2d4)][0x1],_0x37fadc=_0x3ab54a['match'][0x2],{path:_0xf8fa2f,filename:_0x2645e8}=tmpStorage[_0x37fadc];delete tmpStorage[_0x37fadc],_0x3ab54a[_0x4d4af1(0x11d)](),_0x518698==_0x4d4af1(0x2b9)?(logger[_0x4d4af1(0x153)](_0x4d4af1(0x193)),await sendTelegram(_0x3ab54a['chat']['id'],_0x4d4af1(0x12e),{'parse_mode':_0x4d4af1(0x1da)}),unzipFile(_0xf8fa2f,_0x2645e8)):(logger[_0x4d4af1(0x153)](_0x4d4af1(0x140)),await sendTelegram(_0x3ab54a[_0x4d4af1(0x1c8)]['id'],_0x4d4af1(0x140)));});}}function getServerTime(){const _0x24c2b6=_0x57d2a7,_0x51adae=new Date();return _0x51adae['getFullYear']()+'/'+(_0x51adae[_0x24c2b6(0x111)]()+0x1)[_0x24c2b6(0x106)]()[_0x24c2b6(0x173)](0x2,'0')+'/'+_0x51adae[_0x24c2b6(0x18d)]()[_0x24c2b6(0x106)]()[_0x24c2b6(0x173)](0x2,'0')+'\x20'+_0x51adae[_0x24c2b6(0x14c)]()[_0x24c2b6(0x106)]()[_0x24c2b6(0x173)](0x2,'0')+':'+_0x51adae[_0x24c2b6(0x295)]()['toString']()['padStart'](0x2,'0')+':'+_0x51adae[_0x24c2b6(0x23e)]()[_0x24c2b6(0x106)]()[_0x24c2b6(0x173)](0x2,'0');}function getTimeStamp(){const _0x1ac96c=_0x57d2a7,_0x3e59ca=shiftedTime();return _0x3e59ca[_0x1ac96c(0x2a3)]()+'/'+(_0x3e59ca[_0x1ac96c(0x111)]()+0x1)['toString']()['padStart'](0x2,'0')+'/'+_0x3e59ca['getDate']()['toString']()[_0x1ac96c(0x173)](0x2,'0')+'\x20'+_0x3e59ca[_0x1ac96c(0x14c)]()['toString']()['padStart'](0x2,'0')+':'+_0x3e59ca[_0x1ac96c(0x295)]()['toString']()['padStart'](0x2,'0')+':'+_0x3e59ca['getSeconds']()[_0x1ac96c(0x106)]()[_0x1ac96c(0x173)](0x2,'0');}function getCleanTimeStamp(){const _0x4e2f84=_0x57d2a7,_0x17283f=shiftedTime();return _0x17283f[_0x4e2f84(0x2a3)]()+(_0x17283f[_0x4e2f84(0x111)]()+0x1)[_0x4e2f84(0x106)]()[_0x4e2f84(0x173)](0x2,'0')+_0x17283f[_0x4e2f84(0x18d)]()['toString']()[_0x4e2f84(0x173)](0x2,'0')+'-'+_0x17283f[_0x4e2f84(0x14c)]()[_0x4e2f84(0x106)]()[_0x4e2f84(0x173)](0x2,'0')+_0x17283f['getMinutes']()[_0x4e2f84(0x106)]()[_0x4e2f84(0x173)](0x2,'0')+_0x17283f[_0x4e2f84(0x23e)]()['toString']()['padStart'](0x2,'0');}function shiftedTime(){const _0xfed5a9=_0x57d2a7,_0x5c357e=new Date();let _0x284c88=_0x5c357e;if(settings[_0xfed5a9(0x164)]&&settings[_0xfed5a9(0x164)]!==0x0)_0x284c88=fns[_0xfed5a9(0x1ce)](_0x5c357e,{'hours':settings[_0xfed5a9(0x164)]});return _0x284c88;}async function startScheduler(){const _0x33fa0d=_0x57d2a7,_0xee8ad4=new Date()[_0x33fa0d(0x167)](),_0x2138e2=shiftedTime()[_0x33fa0d(0x14c)]();_0x2138e2==0x4&&backupConfigFiles(),_0x2138e2==0x0&&(rotateLogFiles(),logger[_0x33fa0d(0x153)](_0x33fa0d(0x296)),logger['debug']('Running\x20#RED#Balance\x20Bot\x20v'+serverversion+'#RES#\x20'+(environment==_0x33fa0d(0x2fd)?'(staging)':'')),logger[_0x33fa0d(0x153)](_0x33fa0d(0x296))),_0xee8ad4%0x6==0x0&&triggerAnalytics(),_0xee8ad4%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x2d0d40){const _0x27fce3=_0x57d2a7;logger[_0x27fce3(0x153)](_0x27fce3(0x206)+_0x2d0d40);const _0xefef8c=getBotsWithMode();_0xefef8c[_0x27fce3(0x1e1)]>0x0?confirmRestore(configbackuppath,_0x2d0d40):unzipFile(configbackuppath,_0x2d0d40);}async function getBackupFiles(_0x1ca03d=null){const _0x1aaa57=_0x57d2a7;let _0x14fcaf=[],_0x37759f=fs[_0x1aaa57(0x16d)](configbackuppath,{'withFileTypes':!![]});_0x37759f[_0x1aaa57(0x16b)]((_0x3bb166,_0xa492af)=>_0x3bb166[_0x1aaa57(0x16f)]<_0xa492af['name']?0x1:_0xa492af[_0x1aaa57(0x16f)]<_0x3bb166[_0x1aaa57(0x16f)]?-0x1:0x0),_0x37759f['forEach'](_0x2a6482=>{const _0x2e1b84=_0x1aaa57;if(!_0x2a6482[_0x2e1b84(0x23c)]()&&_0x2a6482[_0x2e1b84(0x16f)][_0x2e1b84(0x15a)](_0x2e1b84(0x24e))&&_0x2a6482['name'][_0x2e1b84(0x121)]('.zip')){const _0x3fcb6c=formatDate(fs[_0x2e1b84(0x2ae)](configbackuppath+_0x2a6482['name'])['mtime']);_0x14fcaf['push']({'name':_0x2a6482['name'],'mtime':_0x3fcb6c});}});if(_0x1ca03d)io['to'](_0x1ca03d)[_0x1aaa57(0x174)](_0x1aaa57(0x1e6),_0x14fcaf);else return _0x14fcaf;}async function backupConfigFiles(){const _0x2e7fcb=_0x57d2a7;await zipFiles(_0x2e7fcb(0x26b));const _0x3045c9=getCleanTimeStamp();fs['copyFileSync'](zippath+_0x2e7fcb(0x228),configbackuppath+(_0x2e7fcb(0x24e)+_0x3045c9+_0x2e7fcb(0x1c2)));let _0x20f6d8=fs[_0x2e7fcb(0x16d)](configbackuppath,{'withFileTypes':!![]});_0x20f6d8[_0x2e7fcb(0x16b)]((_0x49384d,_0x73b92a)=>_0x49384d[_0x2e7fcb(0x16f)]<_0x73b92a['name']?0x1:_0x73b92a['name']<_0x49384d[_0x2e7fcb(0x16f)]?-0x1:0x0),_0x20f6d8[_0x2e7fcb(0x1e1)]>maxBackups&&fs[_0x2e7fcb(0x1fe)](configbackuppath+_0x20f6d8[_0x20f6d8['length']-0x1]['name']);}function rotateLogFiles(){const _0x2ad6c3=_0x57d2a7,_0x7fdc97=fs[_0x2ad6c3(0x2ae)](logspath+_0x2ad6c3(0x2a1)),_0x37fb0c=_0x7fdc97['size']/0x400;if(_0x37fb0c>0x64){let _0xdcb944=fs[_0x2ad6c3(0x16d)](logspath,{'withFileTypes':!![]});_0xdcb944[_0x2ad6c3(0x16b)]((_0x1fb696,_0x4c5e94)=>_0x1fb696[_0x2ad6c3(0x16f)]<_0x4c5e94[_0x2ad6c3(0x16f)]?0x1:_0x4c5e94[_0x2ad6c3(0x16f)]<_0x1fb696[_0x2ad6c3(0x16f)]?-0x1:0x0),_0xdcb944['forEach'](_0x235710=>{const _0x55adff=_0x2ad6c3;if(_0x235710[_0x55adff(0x16f)]==_0x55adff(0x1ad))fs['copyFileSync'](logspath+_0x235710['name'],logspath+_0x55adff(0x214));if(_0x235710['name']==_0x55adff(0x2c4))fs[_0x55adff(0x27a)](logspath+_0x235710[_0x55adff(0x16f)],logspath+'output-002.log');_0x235710[_0x55adff(0x16f)]==_0x55adff(0x2a1)&&(fs['copyFileSync'](logspath+_0x235710['name'],logspath+_0x55adff(0x2c4)),fs[_0x55adff(0x159)](logspath+_0x235710[_0x55adff(0x16f)],''));});}}async function zipFiles(_0x3a3c03){const _0x4b9983=_0x57d2a7;let _0x44c993;if(_0x3a3c03==_0x4b9983(0x2d5))_0x44c993=logspath;if(_0x3a3c03==_0x4b9983(0x20c))_0x44c993=configpath;if(_0x3a3c03==_0x4b9983(0x26b))_0x44c993=configpath;let _0x4e6eea=fs[_0x4b9983(0x16d)](_0x44c993,{'withFileTypes':!![]});const _0x1c0a3e=new JSZip();_0x4e6eea[_0x4b9983(0x157)](_0x583fe8=>{const _0x5c6f9e=_0x4b9983;if(!_0x583fe8[_0x5c6f9e(0x23c)]()){let _0x1a37c9=fs[_0x5c6f9e(0x17f)](_0x44c993+_0x583fe8[_0x5c6f9e(0x16f)]);if(_0x3a3c03=='backup'){const _0x58d0ac=/^bot-[0-9]{3}-config.json$/,_0xb786a8=_0x58d0ac[_0x5c6f9e(0x126)](_0x583fe8[_0x5c6f9e(0x16f)]);if(_0xb786a8){const _0x347522=JSON[_0x5c6f9e(0x245)](_0x1a37c9);if(_0x347522[_0x5c6f9e(0x130)][0x0]){_0x347522[_0x5c6f9e(0x130)][0x0]['apiKey']=_0x5c6f9e(0x133),_0x347522[_0x5c6f9e(0x130)][0x0][_0x5c6f9e(0x172)]=_0x5c6f9e(0x133);if(_0x347522[_0x5c6f9e(0x130)][0x0]['apiPassword'])_0x347522[_0x5c6f9e(0x130)][0x0][_0x5c6f9e(0x16a)]='***';}_0x1a37c9=JSON['stringify'](_0x347522,null,0x2);}if(_0x583fe8[_0x5c6f9e(0x16f)]=='bb-settings.json'){const _0xd50633=JSON['parse'](_0x1a37c9);if(_0xd50633[_0x5c6f9e(0x24d)][_0x5c6f9e(0x15e)])_0xd50633['settings']['loginRequired']=![];if(_0xd50633[_0x5c6f9e(0x24d)][_0x5c6f9e(0x252)])_0xd50633[_0x5c6f9e(0x24d)][_0x5c6f9e(0x252)]='***';if(_0xd50633[_0x5c6f9e(0x24d)][_0x5c6f9e(0x1ba)])_0xd50633[_0x5c6f9e(0x24d)]['telegramToken']=_0x5c6f9e(0x133);if(_0xd50633['settings'][_0x5c6f9e(0x234)])_0xd50633[_0x5c6f9e(0x24d)][_0x5c6f9e(0x234)]=null;if(_0xd50633[_0x5c6f9e(0x24d)][_0x5c6f9e(0x225)])_0xd50633['settings']['marketcapApi']=_0x5c6f9e(0x133);_0x1a37c9=JSON['stringify'](_0xd50633,null,0x2);}if(_0x583fe8[_0x5c6f9e(0x16f)]!=_0x5c6f9e(0x18e))_0x1c0a3e['file'](_0x583fe8[_0x5c6f9e(0x16f)],_0x1a37c9);}else _0x1c0a3e[_0x5c6f9e(0x264)](_0x583fe8[_0x5c6f9e(0x16f)],_0x1a37c9);}});const _0x47c0f4=await _0x1c0a3e[_0x4b9983(0x10c)]({'type':_0x4b9983(0x1c7),'base64':![],'compression':'DEFLATE'});fs[_0x4b9983(0x159)](zippath+(_0x3a3c03+_0x4b9983(0x1c2)),_0x47c0f4,_0x4b9983(0x1b0));}async function unzipFile(_0x3d9623,_0xe23222){const _0x5e59d4=_0x57d2a7;fs['readdirSync'](configpath,{'withFileTypes':!![]})[_0x5e59d4(0x157)](_0x16d9d7=>{const _0x4090d8=_0x5e59d4;if(!_0x16d9d7[_0x4090d8(0x23c)]())fs[_0x4090d8(0x1d5)](configpath+_0x16d9d7[_0x4090d8(0x16f)]);});const _0x1382ab=fs[_0x5e59d4(0x17f)](_0x3d9623+_0xe23222,_0x5e59d4(0x1b0)),_0xed4756=await JSZip['loadAsync'](_0x1382ab,{'base64':![],'checkCRC32':!![]});for(const _0x3fe4a8 of Object[_0x5e59d4(0x21b)](_0xed4756['files'])){const _0x9199e5=_0xed4756[_0x5e59d4(0x1f4)][_0x3fe4a8],_0x97a67c=await _0x9199e5['async'](_0x5e59d4(0x1c7));fs[_0x5e59d4(0x159)](configpath+_0x9199e5[_0x5e59d4(0x16f)],_0x97a67c);}fs['readdirSync'](temppath,{'withFileTypes':!![]})['forEach'](_0x10821e=>{const _0x23088c=_0x5e59d4;if(!_0x10821e[_0x23088c(0x23c)]())fs[_0x23088c(0x1d5)](temppath+_0x10821e[_0x23088c(0x16f)]);}),logger['debug']('Backup\x20file\x20unzipped\x20and\x20stored'),process[_0x5e59d4(0x113)]({'restore':!![]},_0x344bd4=>{});}async function getPublicIp(){const _0x2af70b=_0x57d2a7;try{const _0x374372=await axios[_0x2af70b(0x1d9)](_0x2af70b(0x263));publicip=_0x374372[_0x2af70b(0x28c)]['ip'];}catch(_0x31bc31){}}async function triggerAnalytics(){const _0x389b93=_0x57d2a7;if(!publicip)await getPublicIp();const _0x4f0894=getBotsWithMode();let _0x59fbd1=0x0;_0x4f0894['forEach'](_0x33a7cc=>{const _0x4ebe12=_0x3846;if(_0x33a7cc[_0x4ebe12(0x215)]===_0x4ebe12(0x250))_0x59fbd1++;});const _0x4f708a=getBotExchanges();mixpanel[_0x389b93(0x2e5)]('Server',{'distinct_id':settings['userid'],'ip':publicip,'version':serverversion,'numbots':_0x4f0894['length'],'numbotsenabled':_0x59fbd1,'exchanges':_0x4f708a,'environment':environment});}async function getMessages(){const _0x4bbc0f=_0x57d2a7,_0x56a4b9=_0x4bbc0f(0x195),_0x331e9a=new GraphQLClient(_0x56a4b9),_0x397ca0={'authorization':_0x4bbc0f(0xf1)},_0x328840=serverversion[_0x4bbc0f(0x1a4)]('.'),_0x37991f=_0x328840[0x0]+'.'+_0x328840[0x1],_0x33cb2d=Math[_0x4bbc0f(0x2ab)](settings[_0x4bbc0f(0x1e5)],settings[_0x4bbc0f(0x2bb)]),_0x3732ce={'last':parseInt(_0x33cb2d),'bbm':_0x37991f},_0xba464b=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x2309f5;try{_0x2309f5=await _0x331e9a[_0x4bbc0f(0x23b)](_0xba464b,_0x3732ce,_0x397ca0);}catch(_0x2dba62){}if(_0x2309f5&&_0x2309f5[_0x4bbc0f(0x188)]){let _0x2ee877=settings[_0x4bbc0f(0x1e5)],_0x2e2adc=settings[_0x4bbc0f(0x1e5)];newMessages=[];for(const _0x3e45d9 of _0x2309f5[_0x4bbc0f(0x188)]){newMessages[_0x4bbc0f(0x2d1)](_0x3e45d9);let _0x166963=![];_0x3e45d9['bbvNew']&&(updateSetting(_0x4bbc0f(0x1f0),_0x3e45d9['bbvNew']),_0x166963=isNewerVersion(serverversion,_0x3e45d9[_0x4bbc0f(0x2f9)])||serverversion==_0x3e45d9['bbvNew']);if(!_0x166963&&_0x3e45d9[_0x4bbc0f(0x1d0)]>_0x2ee877){if(_0x3e45d9[_0x4bbc0f(0x207)]===_0x4bbc0f(0x183)||serverversion[_0x4bbc0f(0x15a)](_0x3e45d9[_0x4bbc0f(0x207)])){let _0x3864e0=''+_0x3e45d9[_0x4bbc0f(0x305)]+'\x0a\x0a'+_0x3e45d9['message'];const _0x4df54d=await sendTelegramMsg(toTelegramMarkdown(_0x3864e0),_0x4bbc0f(0x1b3));_0x2ee877=_0x3e45d9['number'];}}_0x2e2adc=_0x3e45d9[_0x4bbc0f(0x1d0)];}updateAvailable=isNewerVersion(settings[_0x4bbc0f(0x1f0)],serverversion),updateSetting(_0x4bbc0f(0x1e5),_0x2e2adc),emitMessages();}}function emitMessages(){const _0x44a36f=_0x57d2a7,_0x3831bd=settings['lastmsgemitted'];let _0x3c5d63=[];newMessages[_0x44a36f(0x157)](_0x366ad3=>{const _0xea0fa5=_0x44a36f;_0x366ad3[_0xea0fa5(0x1d0)]>_0x3831bd&&_0x3c5d63[_0xea0fa5(0x2d1)](_0x366ad3);}),_0x3c5d63[_0x44a36f(0x1e1)]>0x0&&getAllClients()[_0x44a36f(0x157)](_0x1a48a2=>{getSocket(_0x1a48a2['id'])['emit']('message',_0x3c5d63);});}function confirmMessage(_0x5ed12d){const _0x39b046=_0x57d2a7;updateSetting(_0x39b046(0x2bb),Number(_0x5ed12d));}function isNewerVersion(_0x58389f,_0x53c959){const _0x2501ef=_0x57d2a7,_0x1ba23b=_0x53c959[_0x2501ef(0x1a4)]('.'),_0x219a97=_0x58389f[_0x2501ef(0x1a4)]('.');for(var _0x4f4751=0x0;_0x4f4751<_0x219a97[_0x2501ef(0x1e1)];_0x4f4751++){const _0x1d2659=~~_0x219a97[_0x4f4751],_0xb5ce7e=~~_0x1ba23b[_0x4f4751];if(_0x1d2659>_0xb5ce7e)return!![];if(_0x1d2659<_0xb5ce7e)return![];}return![];}function toTelegramMarkdown(_0x31cd96){const _0x10c603=_0x57d2a7,_0x508c42=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x22a883=/\*{2}(.+?)\*{2}/gim;return _0x31cd96=_0x31cd96[_0x10c603(0x149)](_0x508c42,_0x10c603(0x1ef))[_0x10c603(0x149)](_0x22a883,_0x10c603(0x181)),_0x31cd96;}async function validateConfigFile(){const _0x416487=_0x57d2a7,_0x1f8881=dbConfig[_0x416487(0x1d9)](_0x416487(0x26a))[_0x416487(0x1a0)](_0x416487(0x177))[_0x416487(0x150)]()||[];if(_0x1f8881['length']==0x0){let _0x1e6d6e=0x0,_0x3ebd01=[];const _0x13129b=/^bot-([0-9]{3})-config.json$/,_0x1166d2=fs[_0x416487(0x16d)](configpath);_0x1166d2['forEach'](_0x1ca4b6=>{const _0x214ca3=_0x416487,_0x26adf1=_0x13129b[_0x214ca3(0x19f)](_0x1ca4b6);if(_0x26adf1){const _0xce0e94=_0x26adf1[0x1];let _0x12a29c=getBotAttributes(_0xce0e94);_0x3ebd01[_0x214ca3(0x2d1)]({'botID':_0xce0e94,'botname':_0x12a29c[_0x214ca3(0x20b)],'status':_0x214ca3(0x2cc),'live':_0x214ca3(0x1bb)}),_0x1e6d6e++;}}),_0x1e6d6e!=0x0&&(dbConfig[_0x416487(0x1d9)](_0x416487(0x26a))[_0x416487(0x17a)](_0x3ebd01)['write'](),config=_0x3ebd01,restoredConfigFile=_0x1e6d6e);}}async function restoreConfigNotify(_0x9c3d9b){const _0x426cc2=_0x57d2a7;let _0x79ffcc;if(restoredConfigFile==0x1)_0x79ffcc='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x79ffcc='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run';if(_0x9c3d9b)io['to'](_0x426cc2(0x1e7))['emit'](_0x426cc2(0x285),_0x79ffcc);else{logger[_0x426cc2(0x29e)](_0x426cc2(0x16c)),logger['simple'](_0x79ffcc),logger['simple'](_0x426cc2(0x16c)),logger[_0x426cc2(0x29e)]('');if(tgBot&&settings[_0x426cc2(0x234)]&&settings[_0x426cc2(0x185)]!=_0x426cc2(0x17c))await sendTelegram(settings['telegramChatId'],'Bot\x20Mgr\x20>\x20'+_0x79ffcc);}}function decryptRSA(_0x4887d3,_0x24229b){const _0x5c6fe4=_0x57d2a7,_0x2277a7=forge['pki'][_0x5c6fe4(0x136)](_0x4887d3),_0x5ec61d=_0x2277a7[_0x5c6fe4(0x1db)](forge['util'][_0x5c6fe4(0x230)](_0x24229b),_0x5c6fe4(0x12c),{'md':forge['md'][_0x5c6fe4(0x161)][_0x5c6fe4(0x25d)](),'mgf1':{'md':forge['md']['sha256'][_0x5c6fe4(0x25d)]()}});return _0x5ec61d;}function validateCredentials(_0x5c123f,_0x4f345c){const _0x2ba56c=_0x57d2a7;if(_0x5c123f[_0x2ba56c(0x120)]==settings[_0x2ba56c(0x1c6)]&&bcrypt['compareSync'](_0x5c123f[_0x2ba56c(0x304)],settings['bbPassword'])){if(settings[_0x2ba56c(0x1be)])return{'allow':![],'reason':_0x2ba56c(0x11f),'token':null};else{const _0x4f0c0e=generateLoginToken(_0x4f345c);return{'allow':!![],'reason':'login\x20token\x20generated','token':_0x4f0c0e};}}else return{'allow':![],'reason':_0x2ba56c(0x12f),'token':null};}function refreshToken(_0xc3a8){const _0x2006d5=_0x57d2a7,_0x2b4efd=generateLoginToken(_0xc3a8);return{'allow':!![],'reason':_0x2006d5(0x10e),'token':_0x2b4efd};}function validateAccess(_0x4e842b,_0x56496b,_0x1628a8){const _0x8d803d=_0x57d2a7,_0x51c5be=_0x1628a8?_0x1628a8:devices[_0x56496b]['ip'];let _0x1b47b4;const _0x461d45=_0x1a759c=>{const _0x4aad1e=_0x3846;if(settings['loginRequired']){if(settings['f2aRequired']){if(telegram2FaApproved(_0x56496b)){const _0x192c3d=generateLoginToken(_0x56496b);return{'allow':!![],'reason':_0x4aad1e(0x2cb),'token':_0x192c3d};}else return{'allow':![],'reason':_0x4aad1e(0x152),'token':null};}else return _0x1b47b4=validToken(_0x1a759c,_0x56496b),_0x1b47b4['hasOwnProperty'](_0x4aad1e(0x26c))?{'allow':!![],'reason':'login\x20token\x20valid','token':_0x1a759c}:{'allow':![],'reason':_0x4aad1e(0x152),'token':null};}else return{'allow':!![],'reason':'login\x20not\x20required','token':null};};if(settings['whitelistEnabled']){let _0x23f922=[...settings['whitelist'],'::1',_0x8d803d(0x308),_0x8d803d(0x1e8),_0x8d803d(0x1e9)];if(_0x23f922[_0x8d803d(0xfa)](_0x51c5be))return _0x461d45(_0x4e842b);else{_0x1b47b4=validToken(_0x4e842b,_0x56496b);if(_0x1b47b4[_0x8d803d(0x2f4)]('success'))return _0x461d45(_0x4e842b);else{if(telegramIpApproved(_0x56496b)){const _0x451310=generateToken(_0x56496b);return _0x1b47b4=_0x461d45(_0x4e842b),_0x1b47b4['allow']?{'allow':!![],'reason':_0x8d803d(0x20f),'token':_0x451310}:_0x1b47b4;}else return settings[_0x8d803d(0x240)]?{'allow':![],'reason':_0x8d803d(0x2bf),'token':null}:{'allow':![],'reason':_0x8d803d(0x30b),'token':null};}}}else return _0x461d45(_0x4e842b);}function timelyDecrypt(_0x41796e,_0x19f75e,_0x5bf5cd='@'){const _0x436597=_0x57d2a7;if(_0x41796e)try{const _0x284ec4=decryptRSA(secure[_0x436597(0x2f8)],_0x41796e),_0x494320=_0x284ec4['split'](_0x5bf5cd)[0x0],_0x4a4961=_0x284ec4[_0x436597(0x1a4)](_0x5bf5cd)[0x1],_0x357407=new Date()[_0x436597(0x25b)]();if(_0x19f75e){if(_0x357407-_0x4a4961<maxSecretAge*0x3e8)return _0x494320;else return![];}else return _0x494320;}catch(_0xac0cd9){return![];}else return![];}const validToken=(_0x57095f,_0x1ad835)=>{const _0x5d0881=_0x57d2a7,_0x5ac27c=devices[_0x1ad835]['ip'];if(!_0x57095f)return{'error':_0x5d0881(0x1b1)};for(let _0x3a2043 of blacklist){if(_0x3a2043[_0x5d0881(0x222)]==_0x57095f)return{'error':_0x5d0881(0x1ca)};}let _0x2e05f4;try{_0x2e05f4=jwt[_0x5d0881(0x2d2)](_0x57095f,secure[_0x5d0881(0x2f1)]+_0x1ad835);}catch{return{'error':_0x5d0881(0x2d8)};}if(!_0x2e05f4[_0x5d0881(0x2f4)](_0x5d0881(0x254))&&!_0x2e05f4[_0x5d0881(0x2f4)](_0x5d0881(0x120))||!_0x2e05f4[_0x5d0881(0x2f4)](_0x5d0881(0x104)))return{'error':_0x5d0881(0x2e1)};if(!_0x2e05f4[_0x5d0881(0x2f4)](_0x5d0881(0x120))&&_0x2e05f4[_0x5d0881(0x2f4)](_0x5d0881(0x254))){const {clientip:_0x5bfd40}=_0x2e05f4;return _0x5ac27c==_0x5bfd40?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x5d0881(0x2ce)};}else{if(_0x2e05f4[_0x5d0881(0x2f4)](_0x5d0881(0x120))&&_0x2e05f4[_0x5d0881(0x2f4)]('clientip')){const {username:_0x57cc65,clientip:_0x20095f}=_0x2e05f4;return settings[_0x5d0881(0x1c6)]==_0x57cc65&&_0x5ac27c==_0x20095f?{'success':_0x5d0881(0xed)}:{'error':'Invalid\x20username\x20or\x20IP\x20address'};}}},generateLoginToken=_0x13831c=>{const _0x1ff62c=_0x57d2a7;if(_0x13831c){const _0x4ca309=devices[_0x13831c]['ip'];return jwt[_0x1ff62c(0xf3)]({'username':settings[_0x1ff62c(0x1c6)],'clientip':_0x4ca309},secure[_0x1ff62c(0x2f1)]+_0x13831c,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x191a31=>{const _0x304094=_0x57d2a7;if(_0x191a31){const _0x58d70a=devices[_0x191a31]['ip'];return jwt[_0x304094(0xf3)]({'clientip':_0x58d70a},secure[_0x304094(0x2f1)]+_0x191a31,{'expiresIn':devices[_0x191a31][_0x304094(0x17e)][_0x304094(0x1af)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x30369a=>{const _0x229610=_0x57d2a7;let _0x540fad=![];return devices[_0x30369a][_0x229610(0x17e)]&&devices[_0x30369a][_0x229610(0x17e)]['expiry']!=_0x229610(0x309)&&(_0x540fad=devices[_0x30369a][_0x229610(0x17e)][_0x229610(0x254)]==devices[_0x30369a]['ip']&&new Date()[_0x229610(0x25b)]()-devices[_0x30369a]['telegramIpApproval'][_0x229610(0x2d7)]<devices[_0x30369a][_0x229610(0x17e)]['expiry']*0x3c*0x3e8),_0x540fad;},telegram2FaApproved=_0xe60282=>{const _0x57f26d=_0x57d2a7;let _0x55bf80=![];return devices[_0xe60282]['telegram2FaApproval']&&devices[_0xe60282][_0x57f26d(0x175)][_0x57f26d(0x1af)]!='reject'&&(_0x55bf80=devices[_0xe60282]['telegram2FaApproval'][_0x57f26d(0x254)]==devices[_0xe60282]['ip']&&new Date()[_0x57f26d(0x25b)]()-devices[_0xe60282][_0x57f26d(0x175)]['timestamp']<devices[_0xe60282][_0x57f26d(0x175)]['expiry']*0x3c*0x3e8),_0x55bf80;},normalizeIP=_0x9a19b4=>{const _0x17f401=_0x57d2a7;let _0x1d6a43=null,_0x3aab23=null;if(ipaddr[_0x17f401(0xef)](_0x9a19b4)){const _0xa5c5ed=ipaddr[_0x17f401(0x245)](_0x9a19b4);_0xa5c5ed['kind']()==='ipv6'?(_0xa5c5ed[_0x17f401(0x227)]()&&(_0x1d6a43=_0xa5c5ed[_0x17f401(0x2f6)]()[_0x17f401(0x106)]()),_0x3aab23=_0xa5c5ed['toString']()):(_0x1d6a43=_0xa5c5ed['toString'](),_0x3aab23=_0xa5c5ed[_0x17f401(0x117)]()[_0x17f401(0x106)]());}return{'show':_0x1d6a43?_0x1d6a43:_0x3aab23,'store':_0x3aab23};};function formatDate(_0x4bc815){const _0x103f22=_0x57d2a7;return _0x4bc815['getFullYear']()+'/'+(_0x4bc815[_0x103f22(0x111)]()+0x1)[_0x103f22(0x106)]()[_0x103f22(0x173)](0x2,'0')+'/'+_0x4bc815[_0x103f22(0x18d)]()[_0x103f22(0x106)]()[_0x103f22(0x173)](0x2,'0')+'\x20'+_0x4bc815[_0x103f22(0x14c)]()[_0x103f22(0x106)]()[_0x103f22(0x173)](0x2,'0')+':'+_0x4bc815[_0x103f22(0x295)]()['toString']()[_0x103f22(0x173)](0x2,'0')+':'+_0x4bc815[_0x103f22(0x23e)]()['toString']()['padStart'](0x2,'0');}function sleep(_0x1c7a8d){return new Promise(_0x54654b=>setTimeout(_0x54654b,_0x1c7a8d));}