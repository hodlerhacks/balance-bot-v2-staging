const _0x7fb00e=_0x4bf9;(function(_0x1539db,_0x230090){const _0x2bae85=_0x4bf9,_0x37beb0=_0x1539db();while(!![]){try{const _0x25495f=-parseInt(_0x2bae85(0x271))/0x1*(-parseInt(_0x2bae85(0x249))/0x2)+parseInt(_0x2bae85(0x2a8))/0x3+-parseInt(_0x2bae85(0x351))/0x4*(-parseInt(_0x2bae85(0x239))/0x5)+-parseInt(_0x2bae85(0x1ce))/0x6+-parseInt(_0x2bae85(0x2b7))/0x7*(parseInt(_0x2bae85(0x38a))/0x8)+parseInt(_0x2bae85(0x30e))/0x9*(-parseInt(_0x2bae85(0x204))/0xa)+parseInt(_0x2bae85(0x1e8))/0xb*(parseInt(_0x2bae85(0x3a1))/0xc);if(_0x25495f===_0x230090)break;else _0x37beb0['push'](_0x37beb0['shift']());}catch(_0x43d040){_0x37beb0['push'](_0x37beb0['shift']());}}}(_0x1e15,0xcbb21));const _0x324e66=function(){let _0x248a59=!![];return function(_0x4852d6,_0x173377){const _0x4fe5be=_0x248a59?function(){const _0x404ac0=_0x4bf9;if(_0x173377){const _0x13cef9=_0x173377[_0x404ac0(0x2fb)](_0x4852d6,arguments);return _0x173377=null,_0x13cef9;}}:function(){};return _0x248a59=![],_0x4fe5be;};}(),_0x52c638=_0x324e66(this,function(){const _0x1fcd68=_0x4bf9;return _0x52c638[_0x1fcd68(0x1ef)]()[_0x1fcd68(0x28d)]('(((.+)+)+)+$')['toString']()[_0x1fcd68(0x2b0)](_0x52c638)[_0x1fcd68(0x28d)](_0x1fcd68(0x3b3));});_0x52c638();'use strict';process['env']['NTBA_FIX_319']=0x1;const childProcess=require(_0x7fb00e(0x203)),fs=require('fs'),fns=require('date-fns'),low=require(_0x7fb00e(0x3d1)),FileSync=require(_0x7fb00e(0x3b8)),path=require(_0x7fb00e(0x240)),crypto=require(_0x7fb00e(0x381)),forge=require('node-forge'),bcrypt=require(_0x7fb00e(0x2bc)),jwt=require(_0x7fb00e(0x1f0)),ipaddr=require('ipaddr.js'),yargs=require(_0x7fb00e(0x354)),uuidRandom=require(_0x7fb00e(0x3c1)),{Telegraf,Markup}=require(_0x7fb00e(0x2a6)),Mixpanel=require(_0x7fb00e(0x301)),axios=require('axios'),{GraphQLClient,gql}=require(_0x7fb00e(0x23c)),util=require(_0x7fb00e(0x2ec)),fileUpload=require(_0x7fb00e(0x338)),{networkInterfaces}=require('os'),JSZip=require(_0x7fb00e(0x2c7)),argv=yargs(process['argv'][_0x7fb00e(0x332)](0x2))['argv'],PORT=argv[_0x7fb00e(0x347)]||_0x7fb00e(0x202),pattern=/^[0-9]{2,4}$/;!pattern['test'](PORT)&&(console[_0x7fb00e(0x341)](_0x7fb00e(0x292)+PORT+_0x7fb00e(0x1d6)),process[_0x7fb00e(0x3ba)](0x1));const HOST=argv[_0x7fb00e(0x2bd)]||null,userID=argv[_0x7fb00e(0x25e)]||'',debugging=argv['d']||![],recreate=argv['r']||![],openBrowser=argv['o']||![],nodeversion=process[_0x7fb00e(0x23e)]['node'];let bbpath=_0x7fb00e(0x36c),bbpath2='';const botfile=_0x7fb00e(0x3bc),configfile=_0x7fb00e(0x2b9),settingsfile=_0x7fb00e(0x224),securefile=_0x7fb00e(0x3b7),environment=require('./'+bbpath2+_0x7fb00e(0x2e3))[_0x7fb00e(0x1f9)]||_0x7fb00e(0x374),maxBackups=0xa;let validInstallation=!![];const schedulerInterval=0x3c*0x3c*0x3e8;!fs[_0x7fb00e(0x2af)](bbpath+botfile)&&(bbpath='',validInstallation=![]);const {addClient,getAllClients,removeClient,getClient,getClientsWithBotID,getClientsWithUuid}=require('./'+bbpath2+_0x7fb00e(0x22c)),configpath=userID?bbpath+_0x7fb00e(0x2d7)+userID+'/':bbpath+_0x7fb00e(0x2d7),configbackuppath=configpath+_0x7fb00e(0x231),logspath=userID?bbpath+_0x7fb00e(0x2f2)+userID+'/':bbpath+_0x7fb00e(0x2f2),zippath=userID?bbpath+_0x7fb00e(0x1d8)+userID+'/':bbpath+_0x7fb00e(0x1d8),loggerfile=fs['createWriteStream'](logspath+_0x7fb00e(0x1d2),{'flags':'a'}),temppath=userID?bbpath+_0x7fb00e(0x35c)+userID+'/':bbpath+_0x7fb00e(0x35c);!fs['existsSync'](configpath)&&fs['mkdirSync'](configpath);!fs['existsSync'](configbackuppath)&&fs['mkdirSync'](configbackuppath);!fs[_0x7fb00e(0x2af)](logspath)&&fs['mkdirSync'](logspath);!fs[_0x7fb00e(0x2af)](zippath)&&fs[_0x7fb00e(0x310)](zippath);!fs[_0x7fb00e(0x2af)](temppath)&&fs['mkdirSync'](temppath);const adapter=new FileSync(configpath+configfile),dbConfig=low(adapter);dbConfig['defaults']({'bots':[]})[_0x7fb00e(0x397)]();const adapter2=new FileSync(configpath+settingsfile),dbSettings=low(adapter2);dbSettings[_0x7fb00e(0x228)]({'settings':{'timeshift':0x0,'loginRequired':![],'bbUsername':'','bbPassword':'','f2aRequired':![],'lastmsgtelegram':0x0,'lastmsgemitted':0x0,'latestversion':_0x7fb00e(0x22e),'onepagemode':![],'marketcapApi':''}})[_0x7fb00e(0x397)]();const adapter3=new FileSync(configpath+securefile),dbSecure=low(adapter3);dbSecure[_0x7fb00e(0x228)]({'secure':{},'blacklist':[]})[_0x7fb00e(0x397)]();const saltRounds=0xa,mixpanel=Mixpanel[_0x7fb00e(0x207)]('6b67f3d61ee94b8f5c80b4affef4c4d9',{'host':_0x7fb00e(0x3bd)});let config=getConfiguration(),settings=getSettings(),secure=getSecure(),blacklist=getBlacklist(),tgBot;if(settings[_0x7fb00e(0x3a5)]&&(settings[_0x7fb00e(0x3a5)]!=''&&settings['telegramToken']!=_0x7fb00e(0x322))&&settings['telegramUsername']&&settings['telegramUsername']!='')initTelegram();const parseColor=(_0x226e4e,_0x25536b)=>{const _0x16085e=_0x7fb00e,_0x54fe48=/#[A-Z]{3}#/g;if(typeof _0x226e4e==_0x16085e(0x21b)){!_0x25536b?_0x226e4e=_0x226e4e[_0x16085e(0x367)](_0x54fe48,''):(_0x226e4e=_0x226e4e[_0x16085e(0x367)](/#BLU#/g,_0x16085e(0x2b2)),_0x226e4e=_0x226e4e[_0x16085e(0x367)](/#RED#/g,_0x16085e(0x2ab)),_0x226e4e=_0x226e4e['replace'](/#YEL#/g,_0x16085e(0x1f7)),_0x226e4e=_0x226e4e[_0x16085e(0x367)](/#MAG#/g,_0x16085e(0x1fd)),_0x226e4e=_0x226e4e[_0x16085e(0x367)](/#CYA#/g,_0x16085e(0x3da)),_0x226e4e=_0x226e4e[_0x16085e(0x367)](/#RES#/g,_0x16085e(0x387)));;}return _0x226e4e;},logger={'screen':_0x12f8ba=>{console['log'](parseColor(_0x12f8ba,!![]));},'simple':_0x3e4590=>{console['log'](parseColor(_0x3e4590,!![])),loggerfile['write'](util['format'](parseColor(_0x3e4590,![]))+'\x0a');},'full':async _0x49758c=>{const _0x2be9c8=_0x7fb00e,_0x57bfd7=getTimeStamp()+_0x2be9c8(0x261)+_0x49758c;console[_0x2be9c8(0x341)](parseColor(_0x57bfd7,!![])),loggerfile[_0x2be9c8(0x397)](util['format'](parseColor(_0x57bfd7,![]))+'\x0a');if(tgBot&&settings['telegramChatId']&&settings[_0x2be9c8(0x3e2)]!=_0x2be9c8(0x234))await sendTelegram(settings[_0x2be9c8(0x32f)],_0x2be9c8(0x3c8)+parseColor(_0x49758c,![]));},'debug':async(_0x4ce24c,_0x5eef53='')=>{const _0x2fdec4=_0x7fb00e,_0x4af236=getTimeStamp()+_0x2fdec4(0x273)+_0x4ce24c;if(debugging)console[_0x2fdec4(0x341)](parseColor(_0x4af236,!![]));loggerfile[_0x2fdec4(0x397)](util[_0x2fdec4(0x1e1)](parseColor(_0x4af236,![]))+'\x0a');if(_0x5eef53){if(debugging)console[_0x2fdec4(0x341)](_0x5eef53);loggerfile[_0x2fdec4(0x397)](util[_0x2fdec4(0x1e1)](_0x5eef53)+'\x0a');}}};let terminating=![];process['on']('uncaughtException',function(_0x3ee36e){const _0x291f20=_0x7fb00e;_0x3ee36e['toString']()['includes']('address\x20already\x20in\x20use')?(logger[_0x291f20(0x34d)]('#RED#Balance\x20Bot\x20is\x20already\x20running\x20on\x20port\x20'+_0x3ee36e[_0x291f20(0x347)]+_0x291f20(0x237)),process['send']({'terminate':!![]},_0x3f2af6=>{})):logger[_0x291f20(0x34d)](_0x3ee36e);}),process['on'](_0x7fb00e(0x3ba),()=>{const _0x20c5de=_0x7fb00e;stopAllBots(),process[_0x20c5de(0x3ba)](0x0);}),process['on'](_0x7fb00e(0x2d2),()=>{stopAllBots(),process['exit'](0x0);}),process['on'](_0x7fb00e(0x29e),()=>{const _0x4355fa=_0x7fb00e;stopAllBots(),process[_0x4355fa(0x3ba)](0x0);});let restoredConfigFile=0x0,newBot=![],pid=[];const serverversion=require('./'+bbpath2+_0x7fb00e(0x2e3))[_0x7fb00e(0x210)],maxSecretAge=0xa,loginExpiry=0x4*0x3c,tokenRefresh=0x5;let tmpStorage={},devices=[],lastIpApproval,installingUpdate=![],publicip,newMessages=[],updateAvailable=![];const express=require('express'),app=express(),http=require('http')[_0x7fb00e(0x2eb)](app);app[_0x7fb00e(0x262)](fileUpload({'useTempFiles':!![]})),app[_0x7fb00e(0x3a8)](_0x7fb00e(0x380),async(_0x23bf7f,_0x4ac0c3)=>{const _0x510a03=_0x7fb00e,_0x106897=_0x23bf7f['params']['type'],_0x1a24c9=getClientsWithBotID(_0x510a03(0x378)),_0x18f2bd=_0x23bf7f['headers']['uuid'],_0x1374af=timelyDecrypt(_0x18f2bd,![]),_0x276078=_0x1a24c9[_0x510a03(0x213)](_0x25c19b=>_0x25c19b[_0x510a03(0x248)]==_0x1374af);if(_0x276078){const _0x15a215=normalizeIP(_0x23bf7f[_0x510a03(0x34b)]['remoteAddress'])[_0x510a03(0x2fc)],_0x38b76d=_0x23bf7f[_0x510a03(0x383)][_0x510a03(0x22f)];if(validateAccess(_0x38b76d,_0x1374af,_0x15a215)[_0x510a03(0x1db)])_0x106897==_0x510a03(0x365)&&await backupConfigFiles(),await zipFiles(_0x106897),_0x4ac0c3[_0x510a03(0x1ee)](zippath+(_0x106897+'.zip'),_0x417ae2=>{const _0x4a1400=_0x510a03;_0x417ae2&&(logger[_0x4a1400(0x2da)](_0x4a1400(0x325)+_0x106897),logger['simple'](_0x417ae2));});else logger[_0x510a03(0x2da)](_0x510a03(0x2db)+_0x106897+_0x510a03(0x297));}else logger[_0x510a03(0x2da)](_0x510a03(0x2db)+_0x106897+_0x510a03(0x376));}),app[_0x7fb00e(0x256)](_0x7fb00e(0x33d),async(_0x4ae3f9,_0x1f444f)=>{const _0x26c0e0=_0x7fb00e,_0x53cd81=getClientsWithBotID(_0x26c0e0(0x378)),_0x45c7e0=_0x4ae3f9[_0x26c0e0(0x383)][_0x26c0e0(0x248)],_0x2defb3=timelyDecrypt(_0x45c7e0,![]),_0x1962a3=_0x53cd81[_0x26c0e0(0x213)](_0x28b792=>_0x28b792['uuid']==_0x2defb3);logger[_0x26c0e0(0x2ce)](_0x26c0e0(0x208));if(_0x1962a3){const _0x2158f3=normalizeIP(_0x4ae3f9[_0x26c0e0(0x34b)][_0x26c0e0(0x2f3)])[_0x26c0e0(0x2fc)],_0x550e2f=_0x4ae3f9[_0x26c0e0(0x383)][_0x26c0e0(0x22f)];if(validateAccess(_0x550e2f,_0x2defb3,_0x2158f3)[_0x26c0e0(0x1db)]){if(_0x4ae3f9[_0x26c0e0(0x206)]){const _0x49e94d=_0x4ae3f9[_0x26c0e0(0x206)][_0x26c0e0(0x2e7)];await _0x49e94d['mv'](temppath+_0x49e94d['name']),_0x1f444f['send']({'status':!![],'message':_0x26c0e0(0x2f5)});const _0x19c3e1=getBotsWithMode();_0x19c3e1['length']>0x0?confirmRestore(temppath,_0x49e94d[_0x26c0e0(0x259)]):unzipFile(temppath,_0x49e94d[_0x26c0e0(0x259)]);}}else logger[_0x26c0e0(0x2da)](_0x26c0e0(0x2d4));}else logger['full'](_0x26c0e0(0x379));}),app[_0x7fb00e(0x262)](express['static'](path['join'](__dirname,bbpath2,_0x7fb00e(0x343)))),app[_0x7fb00e(0x262)](express[_0x7fb00e(0x295)](path['join'](__dirname,bbpath2,_0x7fb00e(0x2a1)))),app['get']('/',function(_0x1c8567,_0x226c7c){const _0x50b633=_0x7fb00e;_0x226c7c[_0x50b633(0x312)](path[_0x50b633(0x37b)](__dirname,bbpath2,'build2',_0x50b633(0x304)));}),app['get'](_0x7fb00e(0x232),function(_0x6f1e34,_0x894ca1){const _0x1a6a70=_0x7fb00e;_0x894ca1[_0x1a6a70(0x312)](path[_0x1a6a70(0x37b)](__dirname,bbpath2,_0x1a6a70(0x2a1),_0x1a6a70(0x304)));}),app['get'](_0x7fb00e(0x3cf),(_0x43dc62,_0x5b13f2)=>{const _0x36367b=_0x7fb00e;_0x5b13f2[_0x36367b(0x312)](path[_0x36367b(0x37b)](__dirname,bbpath2,_0x36367b(0x2a1),_0x36367b(0x304)));}),app[_0x7fb00e(0x3a8)](_0x7fb00e(0x318),(_0x3c0a27,_0x540c0a)=>{const _0x13a478=_0x7fb00e;_0x540c0a['sendFile'](path[_0x13a478(0x37b)](__dirname,bbpath2,_0x13a478(0x2a1),'index.html'));}),app[_0x7fb00e(0x3a8)]('/:bot/coins',(_0x9c7de9,_0x19a8b3)=>{const _0x1621a7=_0x7fb00e;_0x19a8b3[_0x1621a7(0x312)](path[_0x1621a7(0x37b)](__dirname,bbpath2,_0x1621a7(0x2a1),_0x1621a7(0x304)));}),app['get'](_0x7fb00e(0x247),(_0x548729,_0x556cc7)=>{const _0x192040=_0x7fb00e;_0x556cc7['sendFile'](path[_0x192040(0x37b)](__dirname,bbpath2,_0x192040(0x2a1),'index.html'));}),app['get'](_0x7fb00e(0x3d2),(_0x37bded,_0x707c59)=>{const _0x539c98=_0x7fb00e;_0x707c59[_0x539c98(0x312)](path['join'](__dirname,bbpath2,'build',_0x539c98(0x304)));}),app[_0x7fb00e(0x3a8)](_0x7fb00e(0x2a3),(_0xfc5921,_0x354b77)=>{const _0x513cb7=_0x7fb00e;_0x354b77['sendFile'](path[_0x513cb7(0x37b)](__dirname,bbpath2,_0x513cb7(0x2a1),_0x513cb7(0x304)));});if(HOST)http[_0x7fb00e(0x26a)](PORT,HOST);else http[_0x7fb00e(0x26a)](PORT);const io=require('socket.io')(http,{});openBrowser&&(async()=>{const {default:_0x2ec275}=await import('open');await _0x2ec275('http://localhost:'+PORT);})();init();async function init(){await validateConfigFile(),await initUser(),await initSecure(),oneTimeMigration(),cleanBlacklist(),initStates(),await startServer();if(restoredConfigFile)restoreConfigNotify(![]);startSocket(),startScheduler(),triggerAnalytics(),getMessages(),reloadBotManager();}function getServerIP(){const _0x3a8a9d=_0x7fb00e;let _0x5a35c0=_0x3a8a9d(0x375);const _0x4058e4=networkInterfaces(),_0x439ea0={};for(const _0x46d940 of Object[_0x3a8a9d(0x270)](_0x4058e4)){for(const _0x1fa390 of _0x4058e4[_0x46d940]){if((_0x1fa390[_0x3a8a9d(0x1d1)]=='IPv4'||_0x1fa390[_0x3a8a9d(0x1d1)]==0x4)&&!_0x1fa390[_0x3a8a9d(0x269)]){const _0x4390c8=ipaddr[_0x3a8a9d(0x385)](_0x1fa390[_0x3a8a9d(0x3b5)])[_0x3a8a9d(0x309)]();_0x4390c8!='private'&&(!_0x439ea0[_0x46d940]&&(_0x439ea0[_0x46d940]=[]),_0x439ea0[_0x46d940]['push'](_0x1fa390['address']),_0x5a35c0=_0x1fa390['address']);}}}return{'serverip':_0x5a35c0,'netinterfaces':_0x439ea0};}async function startServer(){const _0x2c88e3=_0x7fb00e,{serverip:_0x409579,netinterfaces:_0xce4688}=getServerIP();logger['simple'](''),logger[_0x2c88e3(0x34d)](_0x2c88e3(0x3a0)),await logger['full'](_0x2c88e3(0x260)+serverversion+'#RES#\x20'+(environment==_0x2c88e3(0x2e5)?_0x2c88e3(0x37c):'')+'\x0a'+(_0x2c88e3(0x2ef)+PORT+'#RES#\x20if\x20running\x20locally\x0a')+(_0x2c88e3(0x20d)+_0x409579+':'+PORT+_0x2c88e3(0x34c))),logger['simple'](_0x2c88e3(0x3a0));if(config['length']!=0x0)for(const _0x2a999b of config){const _0x408507=_0x2a999b['mode']==_0x2c88e3(0x398)?'a':'m';if(_0x2a999b[_0x2c88e3(0x2c4)]=='enabled'||_0x2a999b[_0x2c88e3(0x2c4)]==_0x2c88e3(0x283))await logger[_0x2c88e3(0x2da)](_0x2c88e3(0x272)+_0x408507+_0x2c88e3(0x2b1)+_0x2a999b[_0x2c88e3(0x25d)]+_0x2c88e3(0x3d9)+_0x2a999b[_0x2c88e3(0x27e)]),startBot([_0x2a999b[_0x2c88e3(0x25d)],userID],{'cwd':bbpath},function(_0x202b6e){const _0x334671=_0x2c88e3;if(_0x202b6e)logger[_0x334671(0x2da)](_0x202b6e);});else(_0x2a999b[_0x2c88e3(0x2c4)]=='disabled'||_0x2a999b[_0x2c88e3(0x2c4)]==_0x2c88e3(0x377))&&await logger[_0x2c88e3(0x2da)](_0x2c88e3(0x348)+_0x408507+_0x2c88e3(0x321)+_0x2a999b[_0x2c88e3(0x25d)]+_0x2c88e3(0x3d9)+_0x2a999b['botname']);}else!newBot&&logger['simple'](_0x2c88e3(0x3a4));if(newBot)addBot();logger[_0x2c88e3(0x34d)]('-----------------------------------------------------------------------------------'),logger['simple'](''),await logger[_0x2c88e3(0x2ce)](_0x2c88e3(0x27d)+nodeversion),await logger[_0x2c88e3(0x2ce)]('Network\x20Interfaces:',_0xce4688);}function startSocket(){io['on']('connection',_0x4fa2c4=>{const _0xbf340c=_0x4bf9;let _0xdcc17c,_0x3bf16b,_0xfe243e,_0x337818,_0x3fd41d;const _0x43f5e4=_0x4fa2c4[_0xbf340c(0x2a5)][_0xbf340c(0x383)][_0xbf340c(0x361)];_0x3bf16b=_0x43f5e4[_0xbf340c(0x1f4)](/bot[0-9]{3}/);if(_0x3bf16b)_0xfe243e=_0x3bf16b[0x0][_0xbf340c(0x1f4)](/[0-9]{3}/);if(_0xfe243e)_0xdcc17c=_0xfe243e[0x0];else _0xdcc17c='botmanager';const _0x58f68f=_0x4fa2c4['handshake'][_0xbf340c(0x38e)]['encryptedUuid'];if(!_0x58f68f)_0x4fa2c4['emit'](_0xbf340c(0x2c4),{'publicKey':secure[_0xbf340c(0x2a9)]});else{_0x337818=timelyDecrypt(_0x58f68f,![]);if(!_0x337818)_0x4fa2c4[_0xbf340c(0x211)](_0xbf340c(0x2c4),{'publicKey':secure[_0xbf340c(0x2a9)]});else{_0x3fd41d=normalizeIP(_0x4fa2c4[_0xbf340c(0x25c)][_0xbf340c(0x2f3)])[_0xbf340c(0x2fc)];if(!devices[_0x337818])devices[_0x337818]={'uuid':_0x337818,'access':{'token':null}};devices[_0x337818]['ip']=_0x3fd41d;const _0x44c326=addClient(_0x4fa2c4['id'],_0x337818,_0xdcc17c);setAccess(_0x44c326),emitMessages(),_0x4fa2c4['on'](_0xbf340c(0x362),_0x524711=>{const _0x153e83=_0xbf340c,_0x309989=timelyDecrypt(_0x524711[_0x153e83(0x264)],!![],_0x153e83(0x356));if(_0x309989){_0x524711={'username':_0x524711[_0x153e83(0x298)],'password':_0x309989},devices[_0x337818][_0x153e83(0x1e4)]=validateCredentials(_0x524711,_0x337818);if(devices[_0x337818]['access'][_0x153e83(0x1db)]==![]&&devices[_0x337818][_0x153e83(0x1e4)][_0x153e83(0x2e0)]==_0x153e83(0x2fd))_0x4fa2c4['emit'](_0x153e83(0x2c4),{'access':devices[_0x337818][_0x153e83(0x1e4)]}),loginAccess2FA(_0x337818,_0x3fd41d);else{if(devices[_0x337818][_0x153e83(0x1e4)]['allow']==![]&&devices[_0x337818][_0x153e83(0x1e4)][_0x153e83(0x2e0)]=='invalid\x20credentials')_0x4fa2c4[_0x153e83(0x211)](_0x153e83(0x2c4),{'access':devices[_0x337818][_0x153e83(0x1e4)]});else devices[_0x337818][_0x153e83(0x1e4)]['allow']&&devices[_0x337818]['access'][_0x153e83(0x2e0)]==_0x153e83(0x2b4)&&(getClientsWithUuid(_0x337818)[_0x153e83(0x257)](_0x177634=>{setAccess(_0x177634);}),logger['debug'](_0x153e83(0x346)+_0x337818[_0x153e83(0x332)](-0x8)),setTokenRefresh(_0x337818),setSessionTimeout(_0x153e83(0x362),_0x337818));}}else logger['full'](_0x153e83(0x3d5));}),_0x4fa2c4['on']('reset-password',()=>{resetPassword();}),_0x4fa2c4['on'](_0xbf340c(0x393),_0x37cbb4=>{removeClient(_0x4fa2c4['id']);}),_0xdcc17c=='botmanager'&&(restoredConfigFile&&(restoreConfigNotify(!![]),restoredConfigFile=0x0));}}});}function initClient(_0x250755){const _0x458d41=_0x7fb00e;if(_0x250755!='botmanager'&&config[_0x458d41(0x2f7)]!=''){if(pid[_0x250755])pid[_0x250755][_0x458d41(0x26b)]({'function':'initclient','args':null});}_0x250755!=_0x458d41(0x378)&&broadcastToBots(_0x458d41(0x3e4),JSON['stringify'](config));}function reloadBotManager(){const _0x44dc0b=_0x7fb00e;getClientsWithBotID(_0x44dc0b(0x378))['forEach'](_0x223fdc=>{const _0x3b83fa=_0x44dc0b;getSocket(_0x223fdc['id'])[_0x3b83fa(0x211)](_0x3b83fa(0x2c4),{'access':{'allow':![],'reason':_0x3b83fa(0x3c6),'token':null}});});}function getSocket(_0x1a8eee){const _0x58a9cc=io['_nsps']['get']('/');return _0x58a9cc['sockets']['get'](_0x1a8eee);}function setAccess(_0x1fdbf0){const _0x5cf565=_0x7fb00e,_0x125ec3=getSocket(_0x1fdbf0['id']),_0x52d330=_0x1fdbf0[_0x5cf565(0x248)],_0x11195e=_0x1fdbf0['bot'];devices[_0x52d330][_0x5cf565(0x1e4)]=validateAccess(devices[_0x52d330]['access'][_0x5cf565(0x1d9)],_0x52d330),logger[_0x5cf565(0x2ce)](_0x5cf565(0x2e2)+devices[_0x52d330]['access']['reason']+'\x20|\x20client:\x20...'+_0x1fdbf0['id'][_0x5cf565(0x332)](-0x8)+'\x20|\x20user:\x20...'+_0x52d330[_0x5cf565(0x332)](-0x8)),_0x125ec3[_0x5cf565(0x37b)](_0x52d330);if(devices[_0x52d330][_0x5cf565(0x1e4)][_0x5cf565(0x1db)]){_0x125ec3['join'](_0x11195e);if(_0x11195e==_0x5cf565(0x378))initializeSocketBotManager(_0x125ec3);else initializeSocketBot(_0x125ec3);initClient(_0x11195e);}devices[_0x52d330][_0x5cf565(0x1e4)][_0x5cf565(0x1d9)]&&devices[_0x52d330][_0x5cf565(0x1e4)]['reason']=='temporary\x20token\x20generated'&&setSessionTimeout(_0x5cf565(0x355),_0x52d330),devices[_0x52d330][_0x5cf565(0x1e4)][_0x5cf565(0x1d9)]&&devices[_0x52d330][_0x5cf565(0x1e4)][_0x5cf565(0x2e0)]==_0x5cf565(0x24e)&&setSessionTimeout(_0x5cf565(0x362),_0x52d330),_0x125ec3['emit'](_0x5cf565(0x2c4),{'status':_0x1fdbf0[_0x5cf565(0x3dc)],'serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x52d330][_0x5cf565(0x1e4)],'externalip':devices[_0x52d330]['ip'],'publicKey':secure[_0x5cf565(0x2a9)],'userid':settings[_0x5cf565(0x32b)],'validInstallation':validInstallation}),devices[_0x52d330]['access'][_0x5cf565(0x1db)]==![]&&devices[_0x52d330][_0x5cf565(0x1e4)][_0x5cf565(0x2e0)]==_0x5cf565(0x24d)&&temporaryAccess2FA(_0x52d330,devices[_0x52d330]['ip']);}function setSessionTimeout(_0x572fe9,_0xb840da){const _0x16f7ed=_0x7fb00e;let _0x1342a9;if(_0x572fe9=='login')_0x1342a9=loginExpiry*0x3c*0x3e8;else _0x1342a9=devices[_0xb840da][_0x16f7ed(0x1e2)]['expiry']*0x3c*0x3e8-(new Date()[_0x16f7ed(0x296)]()-devices[_0xb840da][_0x16f7ed(0x1e2)][_0x16f7ed(0x389)]);if(devices[_0xb840da][_0x16f7ed(0x333)])clearTimeout(devices[_0xb840da][_0x16f7ed(0x333)]);devices[_0xb840da][_0x16f7ed(0x333)]=setTimeout(()=>{const _0x129628=_0x16f7ed;if(devices[_0xb840da][_0x129628(0x3a2)])clearTimeout(devices[_0xb840da][_0x129628(0x3a2)]);removeSocketListeners(_0xb840da),addBlacklist(_0xb840da),devices[_0xb840da][_0x129628(0x1e2)]=null,devices[_0xb840da][_0x129628(0x266)]=null,devices[_0xb840da][_0x129628(0x1e4)][_0x129628(0x1d9)]=null,logger['debug']('Session\x20expired\x20for\x20user\x20...'+_0xb840da[_0x129628(0x332)](-0x8)),devices[_0xb840da][_0x129628(0x1e4)]=validateAccess(devices[_0xb840da][_0x129628(0x1e4)][_0x129628(0x1d9)],_0xb840da),!(devices[_0xb840da][_0x129628(0x1e4)][_0x129628(0x1db)]&&devices[_0xb840da][_0x129628(0x1e4)][_0x129628(0x2e0)]==_0x129628(0x336))&&(_0x572fe9==_0x129628(0x362)?io['to'](_0xb840da)[_0x129628(0x211)](_0x129628(0x2c4),{'access':{'allow':![],'reason':_0x129628(0x3c5),'token':null}}):io['to'](_0xb840da)[_0x129628(0x211)]('status',{'access':{'allow':![],'reason':_0x129628(0x25b),'token':null}})),devices[_0xb840da][_0x129628(0x1e4)][_0x129628(0x1d9)]=null;},_0x1342a9);}function setTokenRefresh(_0x4d1fe8){const _0x5573c3=_0x7fb00e;if(devices[_0x4d1fe8][_0x5573c3(0x3a2)])clearTimeout(devices[_0x4d1fe8][_0x5573c3(0x3a2)]);devices[_0x4d1fe8][_0x5573c3(0x3a2)]=setTimeout(()=>{const _0x35babd=_0x5573c3;getClientsWithUuid(_0x4d1fe8)[_0x35babd(0x23d)]!=0x0?(devices[_0x4d1fe8][_0x35babd(0x1e4)]=refreshToken(_0x4d1fe8),io['to'](_0x4d1fe8)[_0x35babd(0x211)](_0x35babd(0x2c4),{'status':'connected','serverversion':serverversion,'environment':environment,'servertime':getServerTime(),'access':devices[_0x4d1fe8]['access'],'externalip':devices[_0x4d1fe8]['ip'],'publicKey':secure[_0x35babd(0x2a9)],'validInstallation':validInstallation}),setTokenRefresh(_0x4d1fe8)):clearTimeout(devices[_0x4d1fe8][_0x35babd(0x3a2)]);},(tokenRefresh-0x1)*0x3c*0x3e8);}function initializeSocketBotManager(_0x27b638){const _0x638266=_0x7fb00e,_0x59072c=getClient(_0x27b638['id'])['uuid'];_0x27b638['emit'](_0x638266(0x3e4),config),_0x27b638[_0x638266(0x211)](_0x638266(0x2ed),cleanSettings()),_0x27b638['on'](_0x638266(0x327),_0x4fecc1=>{const _0x3c0caa=_0x638266;if(validateAccess(_0x4fecc1,_0x59072c)[_0x3c0caa(0x1db)])addBot();else logger[_0x3c0caa(0x2da)](_0x3c0caa(0x3b6));}),_0x27b638['on'](_0x638266(0x306),(_0x34e218,_0xe954cc)=>{const _0x59d641=_0x638266;if(validateAccess(_0xe954cc,_0x59072c)[_0x59d641(0x1db)])toggleBot(_0x34e218[_0x59d641(0x25d)],_0x34e218[_0x59d641(0x2c4)],_0x34e218[_0x59d641(0x2d1)]);else logger[_0x59d641(0x2da)](_0x59d641(0x320));}),_0x27b638['on'](_0x638266(0x268),(_0x46a7c1,_0x22b8e5)=>{const _0x3e87f0=_0x638266;if(validateAccess(_0x22b8e5,_0x59072c)['allow'])toggleBotMode(_0x46a7c1);else logger['full'](_0x3e87f0(0x320));}),_0x27b638['on'](_0x638266(0x246),(_0x1a450f,_0x53071c)=>{const _0x9150d9=_0x638266;if(validateAccess(_0x53071c,_0x59072c)['allow'])deleteBot(_0x1a450f);else logger[_0x9150d9(0x2da)]('Unauthorized\x20attempt\x20to\x20delete\x20bot');}),_0x27b638['on']('store-settings',(_0x308a9c,_0x1316dd)=>{const _0xfb00a2=_0x638266;if(validateAccess(_0x1316dd,_0x59072c)[_0xfb00a2(0x1db)])storeSettings(_0x308a9c,!![]);else logger['full']('Unauthorized\x20attempt\x20to\x20update\x20settings');}),_0x27b638['on']('update-bb',_0x30e27b=>{const _0x510934=_0x638266;if(validateAccess(_0x30e27b,_0x59072c)[_0x510934(0x1db)])updateBB(_0x510934(0x334));else logger['full'](_0x510934(0x3c4));}),_0x27b638['on']('reinstall-bb',_0x2ed91a=>{const _0x5103f4=_0x638266;if(validateAccess(_0x2ed91a,_0x59072c)[_0x5103f4(0x1db)])updateBB(_0x5103f4(0x276));else logger[_0x5103f4(0x2da)](_0x5103f4(0x357));}),_0x27b638['on']('get-backup-files',_0x195170=>{const _0x22400d=_0x638266;if(validateAccess(_0x195170,_0x59072c)[_0x22400d(0x1db)]){const _0x4c7506=getClient(_0x27b638['id']);if(_0x4c7506)getBackupFiles(_0x4c7506['uuid']);else logger[_0x22400d(0x2da)](_0x22400d(0x230));}else logger[_0x22400d(0x2da)]('Unauthorized\x20attempt\x20to\x20retrieve\x20list\x20of\x20backup\x20files');}),_0x27b638['on'](_0x638266(0x1dc),(_0x10aaee,_0x1bd1bc)=>{const _0x2979c5=_0x638266;if(validateAccess(_0x1bd1bc,_0x59072c)[_0x2979c5(0x1db)])restoreBackupFile(_0x10aaee);else logger[_0x2979c5(0x2da)](_0x2979c5(0x209));}),_0x27b638['on'](_0x638266(0x305),_0x369c17=>{const _0x3e11c3=_0x638266;if(validateAccess(_0x369c17,_0x59072c)[_0x3e11c3(0x1db)])getMessages();else logger['full'](_0x3e11c3(0x364));}),_0x27b638['on'](_0x638266(0x370),(_0x270590,_0x59a0ea)=>{const _0x1261eb=_0x638266;if(validateAccess(_0x59a0ea,_0x59072c)[_0x1261eb(0x1db)])confirmMessage(_0x270590);else logger['full']('Unauthorized\x20attempt\x20to\x20confirm\x20message');}),_0x27b638['on'](_0x638266(0x212),_0x2fca57=>{const _0x1680da=_0x638266;if(validateAccess(_0x2fca57,_0x59072c)[_0x1680da(0x1db)]){if(devices[_0x59072c][_0x1680da(0x3a2)])clearTimeout(devices[_0x59072c][_0x1680da(0x3a2)]);if(devices[_0x59072c]['pidExpireLogin'])clearTimeout(devices[_0x59072c][_0x1680da(0x333)]);removeSocketListeners(getClient(_0x27b638['id'])['uuid']),addBlacklist(_0x59072c),devices[_0x59072c][_0x1680da(0x1e2)]=null,devices[_0x59072c][_0x1680da(0x266)]=null,devices[_0x59072c][_0x1680da(0x1e4)][_0x1680da(0x1d9)]=null,logger[_0x1680da(0x2ce)](_0x1680da(0x2f6)+_0x59072c['slice'](-0x8)),io['to'](getClient(_0x27b638['id'])[_0x1680da(0x248)])[_0x1680da(0x211)](_0x1680da(0x2c4),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger['full']('Unauthorized\x20attempt\x20to\x20log\x20out');});}function initializeSocketBot(_0xdc260d){const _0x3aa06d=_0x7fb00e,_0x56525b=getClient(_0xdc260d['id'])[_0x3aa06d(0x2f9)],_0x2ce6d6=getClient(_0xdc260d['id'])['uuid'];_0xdc260d['on'](_0x3aa06d(0x254),(_0xdf9990,_0x643620)=>{const _0x3a6db0=_0x3aa06d;if(validateAccess(_0x643620,_0x2ce6d6)['allow']){if(pid[_0x56525b])pid[_0x56525b]['send']({'function':'emitHistory','args':_0xdf9990});}else logger[_0x3a6db0(0x2da)](_0x3a6db0(0x1df));}),_0xdc260d['on']('delete-alerts',(_0x333a1e,_0x1e68df)=>{const _0x1fe117=_0x3aa06d;if(validateAccess(_0x1e68df,_0x2ce6d6)['allow']){if(pid[_0x56525b])pid[_0x56525b][_0x1fe117(0x26b)]({'function':'deleteHistoryAlerts','args':_0x333a1e});}else logger['full'](_0x1fe117(0x2ad));}),_0xdc260d['on']('get-portfolio',(_0x1a06ea,_0x1e8fca)=>{const _0x437e0b=_0x3aa06d;if(validateAccess(_0x1e8fca,_0x2ce6d6)[_0x437e0b(0x1db)]){if(pid[_0x56525b])pid[_0x56525b][_0x437e0b(0x26b)]({'function':_0x437e0b(0x29f),'args':_0x1a06ea});}else logger['full'](_0x437e0b(0x2cb));}),_0xdc260d['on'](_0x3aa06d(0x39c),(_0x48df7f,_0x5224b0)=>{const _0x5b0f4b=_0x3aa06d;if(validateAccess(_0x5224b0,_0x2ce6d6)['allow']){if(pid[_0x56525b])pid[_0x56525b]['send']({'function':_0x5b0f4b(0x38d),'args':_0x48df7f});}else logger[_0x5b0f4b(0x2da)](_0x5b0f4b(0x1da));}),_0xdc260d['on'](_0x3aa06d(0x3b0),(_0x45e309,_0x14090f)=>{const _0x353b65=_0x3aa06d;if(validateAccess(_0x14090f,_0x2ce6d6)[_0x353b65(0x1db)]){if(pid[_0x56525b])pid[_0x56525b][_0x353b65(0x26b)]({'function':'storeHeadless','args':_0x45e309});}else logger[_0x353b65(0x2da)](_0x353b65(0x2e8));}),_0xdc260d['on']('store-fiat',(_0x12a335,_0x23ea7c)=>{const _0x25509b=_0x3aa06d;if(validateAccess(_0x23ea7c,_0x2ce6d6)[_0x25509b(0x1db)]){if(pid[_0x56525b])pid[_0x56525b][_0x25509b(0x26b)]({'function':_0x25509b(0x27f),'args':_0x12a335});}else logger['full'](_0x25509b(0x39f));}),_0xdc260d['on'](_0x3aa06d(0x20e),_0x57e005=>{const _0x3190cb=_0x3aa06d;if(validateAccess(_0x57e005,_0x2ce6d6)[_0x3190cb(0x1db)]){if(pid[_0x56525b])pid[_0x56525b]['send']({'function':_0x3190cb(0x284),'args':null});}else logger['full'](_0x3190cb(0x25a));}),_0xdc260d['on'](_0x3aa06d(0x3d4),_0x3e3848=>{const _0x32cd7e=_0x3aa06d;if(validateAccess(_0x3e3848,_0x2ce6d6)['allow']){if(pid[_0x56525b])pid[_0x56525b][_0x32cd7e(0x26b)]({'function':_0x32cd7e(0x37a),'args':null});}else logger[_0x32cd7e(0x2da)]('Unauthorized\x20attempt\x20to\x20get\x20starting\x20balances');}),_0xdc260d['on'](_0x3aa06d(0x294),(_0x3937af,_0x1975bb)=>{const _0x2a45ba=_0x3aa06d;if(validateAccess(_0x1975bb,_0x2ce6d6)[_0x2a45ba(0x1db)]){if(pid[_0x56525b])pid[_0x56525b][_0x2a45ba(0x26b)]({'function':'placeOrder','args':_0x3937af});}else logger['full'](_0x2a45ba(0x315));}),_0xdc260d['on']('cancel-loading',_0x54c777=>{const _0x48e1e1=_0x3aa06d;if(validateAccess(_0x54c777,_0x2ce6d6)['allow']){if(pid[_0x56525b])pid[_0x56525b][_0x48e1e1(0x26b)]({'function':'cancelLoading','args':null});}else logger[_0x48e1e1(0x2da)]('Unauthorized\x20attempt\x20to\x20cancel\x20loading\x20coins');}),_0xdc260d['on'](_0x3aa06d(0x3ae),_0x1a1f5c=>{const _0x809100=_0x3aa06d;if(validateAccess(_0x1a1f5c,_0x2ce6d6)[_0x809100(0x1db)]){if(pid[_0x56525b])pid[_0x56525b][_0x809100(0x26b)]({'function':'showConfig','args':null});}else logger[_0x809100(0x2da)](_0x809100(0x1e7));}),_0xdc260d['on'](_0x3aa06d(0x2dd),_0x147f97=>{const _0x3c7d74=_0x3aa06d;if(validateAccess(_0x147f97,_0x2ce6d6)[_0x3c7d74(0x1db)])updateBB(_0x3c7d74(0x334));else logger[_0x3c7d74(0x2da)](_0x3c7d74(0x3c4));}),_0xdc260d['on']('get-messages',_0x2ab234=>{const _0x155f5f=_0x3aa06d;if(validateAccess(_0x2ab234,_0x2ce6d6)['allow'])getMessages();else logger[_0x155f5f(0x2da)](_0x155f5f(0x364));}),_0xdc260d['on'](_0x3aa06d(0x370),(_0x69567e,_0x4df552)=>{const _0x389afe=_0x3aa06d;if(validateAccess(_0x4df552,_0x2ce6d6)['allow'])confirmMessage(_0x69567e);else logger[_0x389afe(0x2da)](_0x389afe(0x2cf));}),_0xdc260d['on'](_0x3aa06d(0x212),_0x1c4fb6=>{const _0x3f5ace=_0x3aa06d;if(validateAccess(_0x1c4fb6,_0x2ce6d6)[_0x3f5ace(0x1db)]){if(devices[_0x2ce6d6][_0x3f5ace(0x3a2)])clearTimeout(devices[_0x2ce6d6][_0x3f5ace(0x3a2)]);if(devices[_0x2ce6d6][_0x3f5ace(0x333)])clearTimeout(devices[_0x2ce6d6][_0x3f5ace(0x333)]);removeSocketListeners(getClient(_0xdc260d['id'])[_0x3f5ace(0x248)]),addBlacklist(_0x2ce6d6),devices[_0x2ce6d6][_0x3f5ace(0x1e2)]=null,devices[_0x2ce6d6][_0x3f5ace(0x266)]=null,devices[_0x2ce6d6][_0x3f5ace(0x1e4)]['token']=null,logger[_0x3f5ace(0x2ce)](_0x3f5ace(0x2f6)+_0x2ce6d6[_0x3f5ace(0x332)](-0x8)),io['to'](getClient(_0xdc260d['id'])[_0x3f5ace(0x248)])[_0x3f5ace(0x211)](_0x3f5ace(0x2c4),{'access':{'allow':![],'reason':'logged\x20out','token':null}});}else logger[_0x3f5ace(0x2da)](_0x3f5ace(0x277));});}function removeSocketListeners(_0x488b42){const _0x5b4681=_0x7fb00e;getClientsWithUuid(_0x488b42)[_0x5b4681(0x257)](_0x5c12d9=>{const _0x4dc17e=_0x5b4681;getSocket(_0x5c12d9['id'])[_0x4dc17e(0x24c)]();});}function cleanSettings(){const _0x34202d=_0x7fb00e;let _0x316887=settings;return settings[_0x34202d(0x3a5)]&&settings[_0x34202d(0x3a5)]!=''&&(_0x316887={..._0x316887,'telegramToken':'************'}),settings[_0x34202d(0x2e4)]&&settings[_0x34202d(0x2e4)]!=''&&(_0x316887={..._0x316887,'bbPassword':'************'}),settings[_0x34202d(0x3db)]&&settings[_0x34202d(0x3db)]!=''&&(_0x316887={..._0x316887,'marketcapApi':'************'}),(settings[_0x34202d(0x2e4)]&&settings[_0x34202d(0x2e4)]==_0x34202d(0x322)||settings[_0x34202d(0x3a5)]&&settings[_0x34202d(0x3a5)]==_0x34202d(0x322)||settings[_0x34202d(0x3db)]&&settings['marketcapApi']==_0x34202d(0x322))&&(_0x316887={..._0x316887,'restored':{'password':settings['bbPassword']==_0x34202d(0x322),'telegram':settings[_0x34202d(0x3a5)]==_0x34202d(0x322),'marketcap':settings[_0x34202d(0x3db)]==_0x34202d(0x322)}}),_0x316887;}async function updateBB(_0x5a2903){const _0x390eb8=_0x7fb00e;await backupConfigFiles(),installingUpdate=!![],config[_0x390eb8(0x257)](_0x50dec7=>{restartBot(_0x50dec7['botID']);});if(_0x5a2903==_0x390eb8(0x334))process[_0x390eb8(0x26b)]({'update':!![],'environment':environment},_0x5c3f87=>{});else _0x5a2903==_0x390eb8(0x276)&&process[_0x390eb8(0x26b)]({'reinstall':!![],'environment':environment},_0x29f9ae=>{});}function startBot(_0x324e73,_0x5054ca,_0x467aee){const _0x1c71de=_0x7fb00e;if(debugging)_0x324e73[_0x1c71de(0x33f)]('-d');if(recreate)_0x324e73[_0x1c71de(0x33f)]('-r');let _0x480585=![];const _0x522942=_0x324e73[0x0];_0x5054ca={..._0x5054ca,'stdio':['inherit',_0x1c71de(0x3d3),'inherit',_0x1c71de(0x245)]},pid[_0x522942]=childProcess[_0x1c71de(0x372)](botfile,_0x324e73,_0x5054ca),pid[_0x522942]['on'](_0x1c71de(0x2c0),_0x5847ed=>{const _0x402275=_0x1c71de;switch(Object[_0x402275(0x270)](_0x5847ed)[0x0]){case'botname':updateBotName(_0x522942,_0x5847ed[_0x402275(0x27e)]);break;case _0x402275(0x30c):updateBotManager();break;case _0x402275(0x2c4):updateStatus(_0x522942,_0x5847ed[_0x402275(0x2c4)]);break;case'live':updateLive(_0x522942,_0x5847ed[_0x402275(0x2d1)]);break;case _0x402275(0x3df):updateLive(_0x522942,_0x5847ed[_0x402275(0x3df)]),io['to'](_0x522942)[_0x402275(0x211)]('status',{'access':{'allow':![],'reason':_0x402275(0x3c6),'token':null}});break;case _0x402275(0x220):_0x5847ed['stop']=='restart'&&restartBot(_0x522942);_0x5847ed[_0x402275(0x220)]=='kill'&&toggleBot(_0x522942,_0x402275(0x255),'stopped');break;case _0x402275(0x35e):sendTelegramBot(_0x522942,_0x5847ed[_0x402275(0x35e)]);break;case _0x402275(0x34a):sendTelegramMsg(_0x5847ed[_0x402275(0x34a)]);break;case'function':io['to'](_0x522942)[_0x402275(0x211)](_0x5847ed[_0x402275(0x265)],_0x5847ed[_0x402275(0x314)]);break;}}),pid[_0x522942]['on'](_0x1c71de(0x33e),function(_0x168d59){if(_0x480585)return;_0x480585=!![],_0x467aee(_0x168d59);}),pid[_0x522942]['on']('exit',async function(_0x1bf913){const _0x32f352=_0x1c71de;if(terminating)return;if(installingUpdate){io[_0x32f352(0x3cc)]();return;}if(_0x480585)return;_0x480585=!![],_0x467aee(null);const _0x58390a=dbConfig['get'](_0x32f352(0x3e4))[_0x32f352(0x213)]({'botID':_0x522942})['value']();_0x58390a&&(_0x58390a[_0x32f352(0x2c4)]==_0x32f352(0x281)||_0x58390a['status']=='new')&&(await sleep(0x3e8),updateLive(_0x522942,_0x32f352(0x29b)),logger['full'](_0x32f352(0x2b3)+botRef(_0x522942)),startBot([_0x522942,userID],{'cwd':bbpath},function(_0x1860cb){if(_0x1860cb)logger['full'](_0x1860cb);}));});}function stopBot(_0x7f4666){const _0x27e0e2=_0x7fb00e;getClientsWithBotID(_0x7f4666)[_0x27e0e2(0x257)](_0x1fe042=>{const _0x210118=_0x27e0e2;getSocket(_0x1fe042['id'])[_0x210118(0x393)](!![]),removeClient(_0x1fe042['id']);}),pid[_0x7f4666]&&(pid[_0x7f4666]['kill'](),pid[_0x7f4666]=null);}function stopAllBots(){const _0x154d2b=_0x7fb00e;terminating=!![];const _0x100518=getEnabledBots();_0x100518[_0x154d2b(0x257)](_0x2d2e57=>{const _0x569c0c=_0x154d2b;stopBot(_0x2d2e57[_0x569c0c(0x25d)]);});}function restartBot(_0x19f3b1){const _0x3ed20d=_0x7fb00e;if(pid[_0x19f3b1])pid[_0x19f3b1][_0x3ed20d(0x1f6)]();}function addBot(){const _0x55a4cc=_0x7fb00e;let _0xbaec96;for(let _0x16c714=0x1;_0x16c714<0x3e9;_0x16c714++){_0xbaec96=_0x16c714['toString']()[_0x55a4cc(0x39d)](0x3,'0');let _0x29a3bf=config[_0x55a4cc(0x213)](_0x2d0975=>_0x2d0975['botID']==_0xbaec96);if(!_0x29a3bf)break;}if(_0xbaec96==='1000'){logger[_0x55a4cc(0x2da)]('The\x20maximum\x20of\x20999\x20bots\x20has\x20been\x20reached');return;}logger['full']('Starting\x20new\x20bot\x20|\x20Bot\x20'+_0xbaec96),dbConfig[_0x55a4cc(0x3a8)](_0x55a4cc(0x3e4))[_0x55a4cc(0x33f)]({'botID':_0xbaec96,'botname':'Bot\x20'+_0xbaec96,'status':_0x55a4cc(0x283),'live':''})['write'](),startBot([_0xbaec96,userID],{'cwd':bbpath},function(_0x587cc2){const _0x129ee2=_0x55a4cc;if(_0x587cc2)logger[_0x129ee2(0x2da)](_0x587cc2);}),config=getConfiguration(),io['to'](_0x55a4cc(0x378))[_0x55a4cc(0x211)]('bots',config),broadcastToBots(_0x55a4cc(0x3e4),JSON[_0x55a4cc(0x2cd)](config));}function deleteBot(_0x2861d3){const _0x2faf77=_0x7fb00e;getClientsWithBotID(_0x2861d3)[_0x2faf77(0x257)](_0x5e7d5a=>{const _0x7f6450=_0x2faf77;getSocket(_0x5e7d5a['id'])[_0x7f6450(0x393)](!![]),removeClient(_0x5e7d5a['id']);}),dbConfig[_0x2faf77(0x3a8)](_0x2faf77(0x3e4))[_0x2faf77(0x282)]({'botID':_0x2861d3})[_0x2faf77(0x397)](),logger[_0x2faf77(0x2da)](_0x2faf77(0x2ee)+_0x2861d3),stopBot(_0x2861d3);try{if(fs[_0x2faf77(0x2af)](path[_0x2faf77(0x37b)](configpath,_0x2faf77(0x2a2)+_0x2861d3+_0x2faf77(0x1eb))))fs['unlinkSync'](path[_0x2faf77(0x37b)](configpath,_0x2faf77(0x2a2)+_0x2861d3+_0x2faf77(0x1eb)));if(fs[_0x2faf77(0x2af)](path[_0x2faf77(0x37b)](configpath,_0x2faf77(0x2a2)+_0x2861d3+'-events.json')))fs[_0x2faf77(0x21a)](path[_0x2faf77(0x37b)](configpath,'bot-'+_0x2861d3+_0x2faf77(0x236)));if(fs[_0x2faf77(0x2af)](path[_0x2faf77(0x37b)](configpath,_0x2faf77(0x2a2)+_0x2861d3+_0x2faf77(0x3de))))fs['unlinkSync'](path['join'](configpath,_0x2faf77(0x2a2)+_0x2861d3+_0x2faf77(0x3de)));if(fs[_0x2faf77(0x2af)](path[_0x2faf77(0x37b)](configpath,'bot-'+_0x2861d3+_0x2faf77(0x390))))fs[_0x2faf77(0x21a)](path[_0x2faf77(0x37b)](configpath,_0x2faf77(0x2a2)+_0x2861d3+_0x2faf77(0x390)));}catch(_0x295f2c){if(_0x295f2c)logger[_0x2faf77(0x2da)](_0x2faf77(0x36a),_0x295f2c);}config=getConfiguration(),io['to'](_0x2faf77(0x378))['emit'](_0x2faf77(0x3e4),config),broadcastToBots(_0x2faf77(0x3e4),JSON[_0x2faf77(0x2cd)](config));}function _0x4bf9(_0x4b9f30,_0x49ea85){const _0x502621=_0x1e15();return _0x4bf9=function(_0x52c638,_0x324e66){_0x52c638=_0x52c638-0x1ce;let _0x1e15fd=_0x502621[_0x52c638];return _0x1e15fd;},_0x4bf9(_0x4b9f30,_0x49ea85);}function toggleBot(_0x5006eb,_0x2109d9,_0x2594fb){const _0x290950=_0x7fb00e;dbConfig['get'](_0x290950(0x3e4))['find']({'botID':_0x5006eb})[_0x290950(0x201)]({'status':_0x2109d9})[_0x290950(0x201)]({'live':_0x2594fb})[_0x290950(0x397)]();const _0x8740ec=botRef(_0x5006eb);if(_0x2109d9=='enabled'||_0x2109d9=='new')logger[_0x290950(0x2da)]('Enabled\x20'+_0x8740ec),startBot([_0x5006eb,userID],{'cwd':bbpath},function(_0x6e1fdd){if(_0x6e1fdd)logger['full'](_0x6e1fdd);});else(_0x2109d9==_0x290950(0x255)||_0x2109d9==_0x290950(0x377))&&(logger[_0x290950(0x2da)]('Disabled\x20'+_0x8740ec),stopBot(_0x5006eb));config=getConfiguration(),io['to'](_0x290950(0x378))[_0x290950(0x211)](_0x290950(0x3e4),config),broadcastToBots('bots',JSON['stringify'](config));}function toggleStatus(_0x34c773){const _0xd672c0=_0x7fb00e;let _0x277665=dbConfig[_0xd672c0(0x3a8)](_0xd672c0(0x3e4))['find']({'botID':_0x34c773})[_0xd672c0(0x1f2)](),_0x3cd950;if(_0x277665[_0xd672c0(0x2c4)]===_0xd672c0(0x281))_0x3cd950=_0xd672c0(0x255);else{if(_0x277665[_0xd672c0(0x2c4)]===_0xd672c0(0x283))_0x3cd950='new-disabled';else{if(_0x277665[_0xd672c0(0x2c4)]===_0xd672c0(0x377))_0x3cd950=_0xd672c0(0x283);else{if(_0x277665['status']===_0xd672c0(0x255))_0x3cd950='enabled';}}}return _0x3cd950;}function updateStatus(_0x1a0932,_0x85544b){const _0x701ba9=_0x7fb00e;dbConfig[_0x701ba9(0x3a8)]('bots')['find']({'botID':_0x1a0932})[_0x701ba9(0x201)]({'status':_0x85544b})[_0x701ba9(0x397)](),config=getConfiguration(),io['to'](_0x701ba9(0x378))['emit'](_0x701ba9(0x3e4),config),broadcastToBots(_0x701ba9(0x3e4),JSON['stringify'](config));}function updateLive(_0x531185,_0x283dd0){const _0x365de3=_0x7fb00e;dbConfig['get']('bots')[_0x365de3(0x213)]({'botID':_0x531185})[_0x365de3(0x201)]({'live':_0x283dd0})[_0x365de3(0x397)](),config=getConfiguration(),io['to'](_0x365de3(0x378))[_0x365de3(0x211)](_0x365de3(0x3e4),config),broadcastToBots(_0x365de3(0x3e4),JSON['stringify'](config));}function updateBotName(_0x18bbc6,_0x7281c4){const _0x4029c7=_0x7fb00e;dbConfig[_0x4029c7(0x3a8)]('bots')[_0x4029c7(0x213)]({'botID':_0x18bbc6})[_0x4029c7(0x201)]({'botname':_0x7281c4})[_0x4029c7(0x397)](),config=getConfiguration(),io['to'](_0x4029c7(0x378))[_0x4029c7(0x211)](_0x4029c7(0x3e4),config),broadcastToBots(_0x4029c7(0x3e4),JSON['stringify'](config));}function updateBotManager(){const _0x5757d1=_0x7fb00e;config=getConfiguration(),io['to']('botmanager')[_0x5757d1(0x211)]('bots',config),broadcastToBots(_0x5757d1(0x3e4),JSON[_0x5757d1(0x2cd)](config));}function toggleBotMode(_0x5573d5){const _0x3b7fa7=_0x7fb00e;if(pid[_0x5573d5])pid[_0x5573d5]['send']({'function':_0x3b7fa7(0x1e6),'args':null});else{const _0x2dea01=configpath+_0x3b7fa7(0x2a2)+_0x5573d5+_0x3b7fa7(0x1eb),_0x500173=fs['readFileSync'](_0x2dea01),_0x232af0=JSON['parse'](_0x500173),_0x5a14cf=_0x232af0[_0x3b7fa7(0x2f9)][0x0][_0x3b7fa7(0x3e6)];_0x232af0[_0x3b7fa7(0x2f9)][0x0]['headless']=!_0x5a14cf;const _0x4e7e3c=JSON['stringify'](_0x232af0,null,0x2);fs[_0x3b7fa7(0x3ce)](_0x2dea01,_0x4e7e3c),config=getConfiguration(),io['to']('botmanager')[_0x3b7fa7(0x211)]('bots',config),broadcastToBots('bots',JSON['stringify'](config));}}function validateTelegram(_0x4b0a2c){const _0x3e33f2=_0x7fb00e;if(_0x4b0a2c['from'][_0x3e33f2(0x298)]!=settings['telegramUsername']&&'@'+_0x4b0a2c[_0x3e33f2(0x3bf)][_0x3e33f2(0x298)]!=settings[_0x3e33f2(0x324)]||_0x4b0a2c['chat']['id']!=settings[_0x3e33f2(0x32f)])return sendTelegram(_0x4b0a2c[_0x3e33f2(0x2b5)]['id'],_0x3e33f2(0x299),{'parse_mode':_0x3e33f2(0x3cb)}),![];return!![];}function botRef(_0x495552){const _0x525749=_0x7fb00e,_0x1f6f26=getBotAttributes(_0x495552),_0x26e0b7=_0x1f6f26['showname']?_0x1f6f26[_0x525749(0x27e)]:_0x525749(0x35d)+_0x495552;return _0x26e0b7;}async function initTelegram(){const _0x400dcf=_0x7fb00e;tgBot&&(await tgBot[_0x400dcf(0x220)](),await sleep(0x7d0));tgBot=new Telegraf(settings[_0x400dcf(0x3a5)]);let _0x21a75f=_0x400dcf(0x26e);_0x21a75f+='\x0a',_0x21a75f+=_0x400dcf(0x3dd),_0x21a75f+=_0x400dcf(0x311),_0x21a75f+=_0x400dcf(0x316),_0x21a75f+=_0x400dcf(0x31c),_0x21a75f+=_0x400dcf(0x37f),_0x21a75f+=_0x400dcf(0x33c),_0x21a75f+=_0x400dcf(0x2df),_0x21a75f+=_0x400dcf(0x39e),_0x21a75f+=_0x400dcf(0x23b),_0x21a75f+=_0x400dcf(0x34f),_0x21a75f+=_0x400dcf(0x285),_0x21a75f+=_0x400dcf(0x200),_0x21a75f+=_0x400dcf(0x2ea),_0x21a75f+=_0x400dcf(0x3e7),_0x21a75f+=_0x400dcf(0x2ff),_0x21a75f+=_0x400dcf(0x3d8);let _0x279243=_0x400dcf(0x1e3);_0x279243+='\x0a',_0x279243+=_0x21a75f,tgBot[_0x400dcf(0x227)]((_0x503c3e,_0x25b556)=>{const _0x451614=_0x400dcf;logger[_0x451614(0x34d)](getTimeStamp()+':\x20Bot\x20Mgr\x20>\x20Telegram\x20error\x20occured'),logger['debug'](_0x451614(0x2fe),_0x503c3e);}),tgBot[_0x400dcf(0x262)](async(_0x34f38a,_0x541bf5)=>{const _0x434b74=_0x400dcf;if(settings[_0x434b74(0x32f)]||_0x34f38a[_0x434b74(0x334)][_0x434b74(0x2c0)]['text']!=_0x434b74(0x35a)){if(!validateTelegram(_0x34f38a))return;}_0x541bf5();}),tgBot[_0x400dcf(0x22d)]('start',async _0x66b06=>{const _0x1bf3f7=_0x400dcf;if(_0x66b06['from'][_0x1bf3f7(0x298)]==settings[_0x1bf3f7(0x324)]||'@'+_0x66b06[_0x1bf3f7(0x3bf)][_0x1bf3f7(0x298)]==settings[_0x1bf3f7(0x324)]){if(!settings['telegramChatId'])updateSetting('telegramChatId',_0x66b06[_0x1bf3f7(0x2b5)]['id']);else{if(!validateTelegram(_0x66b06))return;}}else{if(!validateTelegram(_0x66b06))return;}updateSetting(_0x1bf3f7(0x2f1),!![]),await sendTelegram(_0x66b06[_0x1bf3f7(0x2b5)]['id'],_0x279243);}),tgBot['command']('enable',async _0x4efd3a=>{const _0x12825e=_0x400dcf;updateSetting(_0x12825e(0x2f1),!![]),await sendTelegram(_0x4efd3a['chat']['id'],_0x12825e(0x3aa));}),tgBot[_0x400dcf(0x22d)]('disable',async _0x255675=>{const _0x33174d=_0x400dcf;await sendTelegram(_0x255675['chat']['id'],_0x33174d(0x21d)),updateSetting(_0x33174d(0x2f1),![]);}),tgBot['command']('config',async _0x1128b5=>{const _0x519980=_0x400dcf,_0x2c3efd=Markup[_0x519980(0x30a)]([Markup[_0x519980(0x1f5)][_0x519980(0x27c)](_0x519980(0x2d3),'config_orders'),Markup[_0x519980(0x1f5)]['callback'](_0x519980(0x2aa),_0x519980(0x3e9)),Markup[_0x519980(0x1f5)][_0x519980(0x27c)](_0x519980(0x3e3),_0x519980(0x274))]);_0x1128b5[_0x519980(0x21e)](_0x519980(0x286),_0x2c3efd);}),tgBot[_0x400dcf(0x242)](_0x400dcf(0x28c),async _0x5a3b57=>{const _0x5baa43=_0x400dcf;_0x5a3b57[_0x5baa43(0x3e1)](),updateSetting(_0x5baa43(0x3e2),_0x5baa43(0x234)),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x5a3b57[_0x5baa43(0x2b5)]['id'],_0x5baa43(0x3c7));}),tgBot['action']('config_alerts',async _0x1b632a=>{const _0x2aee7b=_0x400dcf;_0x1b632a['editMessageReplyMarkup'](),updateSetting(_0x2aee7b(0x3e2),'alerts'),updateSetting(_0x2aee7b(0x2f1),!![]),await sendTelegram(_0x1b632a[_0x2aee7b(0x2b5)]['id'],_0x2aee7b(0x291));}),tgBot[_0x400dcf(0x242)](_0x400dcf(0x274),async _0x163b6e=>{const _0x5e7ed3=_0x400dcf;_0x163b6e[_0x5e7ed3(0x3e1)](),updateSetting('telegramEvents','all'),updateSetting('telegramEnabled',!![]),await sendTelegram(_0x163b6e[_0x5e7ed3(0x2b5)]['id'],_0x5e7ed3(0x205));}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x2c4),async _0x4f144e=>{const _0x1aa5ac=_0x400dcf,_0xc165fb=getBotsWithMode();let _0x35ca5a='<b>Balance\x20Bot\x20Status:</b>\x0a';config[_0x1aa5ac(0x257)](_0x5f0698=>{const _0x5006a4=_0x1aa5ac,_0x366787=_0xc165fb[_0x5006a4(0x213)](_0x40a534=>_0x40a534['botID']==_0x5f0698[_0x5006a4(0x25d)])[_0x5006a4(0x20c)];_0x35ca5a+='Bot\x20'+_0x5f0698[_0x5006a4(0x25d)]+':\x20'+_0x5f0698['status']+_0x5006a4(0x3d9)+_0x366787+_0x5006a4(0x3d9)+_0x5f0698[_0x5006a4(0x2d1)]+'\x0a';}),_0x35ca5a+='\x0a',_0x35ca5a+='<b>Telegram\x20Bot\x20Status:</b>\x0a',_0x35ca5a+=!settings[_0x1aa5ac(0x2f1)]?'Notifications\x20disabled\x0a':_0x1aa5ac(0x278),_0x35ca5a+=settings[_0x1aa5ac(0x2f1)]?settings[_0x1aa5ac(0x3e2)]==_0x1aa5ac(0x2e6)?_0x1aa5ac(0x267):'Notifications\x20types:\x20'+settings[_0x1aa5ac(0x3e2)]+_0x1aa5ac(0x2be):'',await sendTelegram(_0x4f144e[_0x1aa5ac(0x2b5)]['id'],_0x35ca5a,{'parse_mode':_0x1aa5ac(0x3cb)});}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x2bb),async _0x13cb59=>{const _0x3d81bd=_0x400dcf,_0x3ec437=getEnabledBots();if(_0x3ec437[_0x3d81bd(0x23d)]==0x0)await sendTelegram(_0x13cb59[_0x3d81bd(0x2b5)]['id'],_0x3d81bd(0x3b4));else{if(_0x3ec437[_0x3d81bd(0x23d)]>0x1)_0x3ec437[_0x3d81bd(0x33f)]({'botID':'all'});let _0x50b395=[],_0x244998=[];const _0x27afcb=_0x3ec437[_0x3d81bd(0x23d)]%0x4==0x0||_0x3ec437['length']%0x4==0x3||_0x3ec437[_0x3d81bd(0x23d)]%0x3==0x1?0x4:0x3;let _0x327221=0x0;_0x3ec437['forEach']((_0x16d52c,_0x460a35)=>{const _0x13e530=_0x3d81bd;if(_0x460a35%_0x27afcb==0x0)_0x244998=[];_0x244998[_0x13e530(0x33f)](Markup[_0x13e530(0x1f5)]['callback'](_0x16d52c[_0x13e530(0x25d)]==_0x13e530(0x2e6)?_0x13e530(0x32d):botRef(_0x16d52c[_0x13e530(0x25d)]),_0x13e530(0x223)+_0x16d52c['botID'])),_0x460a35%_0x27afcb==0x0&&(_0x50b395[_0x327221]=_0x244998,_0x327221++);});const _0x187cb7=Markup[_0x3d81bd(0x30a)](_0x50b395);_0x13cb59[_0x3d81bd(0x21e)](_0x3d81bd(0x241),_0x187cb7);}}),tgBot[_0x400dcf(0x242)](/restart_(.+)/,async _0x1b8baf=>{const _0xb8bcf1=_0x400dcf,_0x5a2dad=_0x1b8baf[_0xb8bcf1(0x1f4)][0x1];_0x1b8baf[_0xb8bcf1(0x3e1)](),_0x5a2dad==_0xb8bcf1(0x2e6)?config[_0xb8bcf1(0x257)](_0x675e00=>{const _0x1c866b=_0xb8bcf1;restartBot(_0x675e00[_0x1c866b(0x25d)]);}):restartBot(_0x5a2dad);}),tgBot[_0x400dcf(0x22d)]('on',async _0x564720=>{const _0x1c36e3=_0x400dcf,_0x27f897=getDisabledBots();if(_0x27f897[_0x1c36e3(0x23d)]==0x0)await sendTelegram(_0x564720['chat']['id'],'All\x20bots\x20running\x20right\x20now');else{if(_0x27f897[_0x1c36e3(0x23d)]>0x1)_0x27f897['push']({'botID':_0x1c36e3(0x2e6)});let _0x464f76=[],_0x5b4374=[];const _0x4d3f8e=_0x27f897[_0x1c36e3(0x23d)]%0x4==0x0||_0x27f897[_0x1c36e3(0x23d)]%0x4==0x3||_0x27f897[_0x1c36e3(0x23d)]%0x3==0x1?0x4:0x3;let _0x2aed8a=0x0;_0x27f897[_0x1c36e3(0x257)]((_0x50099f,_0x59d9b4)=>{const _0x31030c=_0x1c36e3;if(_0x59d9b4%_0x4d3f8e==0x0)_0x5b4374=[];_0x5b4374[_0x31030c(0x33f)](Markup['button'][_0x31030c(0x27c)](_0x50099f[_0x31030c(0x25d)]==_0x31030c(0x2e6)?_0x31030c(0x32d):botRef(_0x50099f[_0x31030c(0x25d)]),_0x31030c(0x2d5)+_0x50099f[_0x31030c(0x25d)])),_0x59d9b4%_0x4d3f8e==0x0&&(_0x464f76[_0x2aed8a]=_0x5b4374,_0x2aed8a++);});const _0x250c81=Markup[_0x1c36e3(0x30a)](_0x464f76);_0x564720[_0x1c36e3(0x21e)](_0x1c36e3(0x279),_0x250c81);}}),tgBot[_0x400dcf(0x242)](/on_(.+)/,async _0x38de95=>{const _0x377d0e=_0x400dcf,_0x4f2b63=_0x38de95[_0x377d0e(0x1f4)][0x1];_0x38de95[_0x377d0e(0x3e1)]();if(_0x4f2b63==_0x377d0e(0x2e6)){const _0x59ed2c=getDisabledBots();await sendTelegram(_0x38de95[_0x377d0e(0x2b5)]['id'],_0x377d0e(0x307)),_0x59ed2c[_0x377d0e(0x257)](_0x12a30d=>{const _0x1b10bb=_0x377d0e;if(_0x12a30d[_0x1b10bb(0x25d)]!='all')toggleBot(_0x12a30d[_0x1b10bb(0x25d)],toggleStatus(_0x12a30d['botID']),_0x1b10bb(0x29b));});}else await sendTelegram(_0x38de95[_0x377d0e(0x2b5)]['id'],_0x377d0e(0x27a)+botRef(_0x4f2b63)),toggleBot(_0x4f2b63,toggleStatus(_0x4f2b63),'stopped');}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x395),async _0x6c0a62=>{const _0x450735=_0x400dcf,_0x13fbcb=getEnabledBots();if(_0x13fbcb['length']==0x0)await sendTelegram(_0x6c0a62[_0x450735(0x2b5)]['id'],'No\x20bots\x20running\x20right\x20now');else{if(_0x13fbcb[_0x450735(0x23d)]>0x1)_0x13fbcb[_0x450735(0x33f)]({'botID':'all'});let _0x173f32=[],_0x1d9529=[];const _0x57ce2d=_0x13fbcb[_0x450735(0x23d)]%0x4==0x0||_0x13fbcb['length']%0x4==0x3||_0x13fbcb['length']%0x3==0x1?0x4:0x3;let _0x1c8a16=0x0;_0x13fbcb[_0x450735(0x257)]((_0x3ad839,_0x4f55e2)=>{const _0x45bd62=_0x450735;if(_0x4f55e2%_0x57ce2d==0x0)_0x1d9529=[];_0x1d9529[_0x45bd62(0x33f)](Markup[_0x45bd62(0x1f5)]['callback'](_0x3ad839[_0x45bd62(0x25d)]==_0x45bd62(0x2e6)?_0x45bd62(0x32d):botRef(_0x3ad839[_0x45bd62(0x25d)]),_0x45bd62(0x229)+_0x3ad839[_0x45bd62(0x25d)])),_0x4f55e2%_0x57ce2d==0x0&&(_0x173f32[_0x1c8a16]=_0x1d9529,_0x1c8a16++);});const _0x584351=Markup[_0x450735(0x30a)](_0x173f32);_0x6c0a62[_0x450735(0x21e)](_0x450735(0x3c3),_0x584351);}}),tgBot[_0x400dcf(0x242)](/off_(.+)/,async _0x57e546=>{const _0x2b7c6b=_0x400dcf,_0x27819a=_0x57e546[_0x2b7c6b(0x1f4)][0x1];_0x57e546[_0x2b7c6b(0x3e1)]();if(_0x27819a==_0x2b7c6b(0x2e6)){const _0x6a3bc7=getEnabledBots();await sendTelegram(_0x57e546[_0x2b7c6b(0x2b5)]['id'],'Bot\x20Mgr\x20>\x20Stopping\x20all\x20bots'),_0x6a3bc7['forEach'](_0x49cf3f=>{const _0x2f85df=_0x2b7c6b;if(_0x49cf3f[_0x2f85df(0x25d)]!=_0x2f85df(0x2e6))toggleBot(_0x49cf3f[_0x2f85df(0x25d)],toggleStatus(_0x49cf3f['botID']),_0x2f85df(0x29b));});}else await sendTelegram(_0x57e546[_0x2b7c6b(0x2b5)]['id'],_0x2b7c6b(0x36f)+botRef(_0x27819a)),toggleBot(_0x27819a,toggleStatus(_0x27819a),_0x2b7c6b(0x29b));}),tgBot['command'](_0x400dcf(0x1de),async _0x3e5768=>{const _0x3ceff8=_0x400dcf,_0x51cbd4=getEnabledBots();if(_0x51cbd4[_0x3ceff8(0x23d)]==0x0)await sendTelegram(_0x3e5768[_0x3ceff8(0x2b5)]['id'],_0x3ceff8(0x3b4));else{if(_0x51cbd4[_0x3ceff8(0x23d)]>0x1){let _0x590afc=[],_0x3fbc75=[];const _0x3b2d95=_0x51cbd4[_0x3ceff8(0x23d)]%0x4==0x0||_0x51cbd4['length']%0x4==0x3||_0x51cbd4[_0x3ceff8(0x23d)]%0x3==0x1?0x4:0x3;let _0x1e8e70=0x0;_0x51cbd4[_0x3ceff8(0x257)]((_0x3533b0,_0x59e8cb)=>{const _0x5aba29=_0x3ceff8;if(_0x59e8cb%_0x3b2d95==0x0)_0x3fbc75=[];_0x3fbc75[_0x5aba29(0x33f)](Markup[_0x5aba29(0x1f5)][_0x5aba29(0x27c)](botRef(_0x3533b0[_0x5aba29(0x25d)]),_0x5aba29(0x37e)+_0x3533b0[_0x5aba29(0x25d)])),_0x59e8cb%_0x3b2d95==0x0&&(_0x590afc[_0x1e8e70]=_0x3fbc75,_0x1e8e70++);});const _0x5e4c9e=Markup[_0x3ceff8(0x30a)](_0x590afc);_0x3e5768[_0x3ceff8(0x21e)]('For\x20which\x20bot\x20do\x20you\x20want\x20the\x20metrics?',_0x5e4c9e);}else{const _0x456524=_0x51cbd4[0x0][_0x3ceff8(0x25d)];if(pid[_0x456524])pid[_0x456524][_0x3ceff8(0x26b)]({'function':_0x3ceff8(0x32c),'args':null});}}}),tgBot[_0x400dcf(0x242)](/metrics_(.+)/,async _0x338afa=>{const _0x31eff3=_0x400dcf,_0x5c5881=_0x338afa['match'][0x1];_0x338afa[_0x31eff3(0x3e1)]();if(pid[_0x5c5881])pid[_0x5c5881]['send']({'function':'sendMetricsTelegram','args':null});}),tgBot[_0x400dcf(0x22d)]('portfolio',async _0x37f369=>{const _0x9095aa=_0x400dcf,_0x7ad6f1=getEnabledBots();if(_0x7ad6f1[_0x9095aa(0x23d)]==0x0)await sendTelegram(_0x37f369[_0x9095aa(0x2b5)]['id'],_0x9095aa(0x3b4));else{if(_0x7ad6f1[_0x9095aa(0x23d)]>0x1){let _0x171f8f=[],_0x7a9a50=[];const _0x181028=_0x7ad6f1[_0x9095aa(0x23d)]%0x4==0x0||_0x7ad6f1[_0x9095aa(0x23d)]%0x4==0x3||_0x7ad6f1['length']%0x3==0x1?0x4:0x3;let _0x501637=0x0;_0x7ad6f1['forEach']((_0xd608d0,_0x2a27e3)=>{const _0x5e5bc7=_0x9095aa;if(_0x2a27e3%_0x181028==0x0)_0x7a9a50=[];_0x7a9a50['push'](Markup[_0x5e5bc7(0x1f5)][_0x5e5bc7(0x27c)](botRef(_0xd608d0[_0x5e5bc7(0x25d)]),_0x5e5bc7(0x33a)+_0xd608d0['botID'])),_0x2a27e3%_0x181028==0x0&&(_0x171f8f[_0x501637]=_0x7a9a50,_0x501637++);});const _0x3822f0=Markup['inlineKeyboard'](_0x171f8f);_0x37f369['reply'](_0x9095aa(0x28b),_0x3822f0);}else{const _0x525c24=_0x7ad6f1[0x0][_0x9095aa(0x25d)];if(pid[_0x525c24])pid[_0x525c24][_0x9095aa(0x26b)]({'function':_0x9095aa(0x2fa),'args':null});}}}),tgBot[_0x400dcf(0x242)](/portfolio_(.+)/,async _0x17105d=>{const _0x393cd4=_0x400dcf,_0x465414=_0x17105d[_0x393cd4(0x1f4)][0x1];_0x17105d[_0x393cd4(0x3e1)]();if(pid[_0x465414])pid[_0x465414][_0x393cd4(0x26b)]({'function':'sendPortfolioTelegram','args':null});}),tgBot[_0x400dcf(0x22d)]('logs',async _0x4b1e64=>{const _0xa69606=_0x400dcf,_0x1f18a0='logs';await zipFiles(_0x1f18a0);const _0x2cd9f6=zippath+(_0x1f18a0+_0xa69606(0x3a3));_0x4b1e64[_0xa69606(0x1ed)]({'source':_0x2cd9f6})[_0xa69606(0x30f)](()=>{})[_0xa69606(0x227)](_0x11d22b=>logger[_0xa69606(0x2ce)](_0xa69606(0x2a4)+_0x1f18a0+_0xa69606(0x20b),_0x11d22b));}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x365),async _0x2aa4bc=>{const _0x41d784=_0x400dcf,_0x1208eb='backup';await backupConfigFiles(),await zipFiles(_0x1208eb);const _0x2258af=zippath+(_0x1208eb+_0x41d784(0x3a3));_0x2aa4bc[_0x41d784(0x1ed)]({'source':_0x2258af})[_0x41d784(0x30f)](()=>{})[_0x41d784(0x227)](_0x161947=>logger['debug'](_0x41d784(0x2a4)+_0x1208eb+_0x41d784(0x20b),_0x161947));}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x334),async _0x53af6a=>{const _0x8010b3=_0x400dcf;await getMessages();if(!updateAvailable)await sendTelegram(_0x53af6a['chat']['id'],_0x8010b3(0x3af));else{if(!validInstallation)await sendTelegram(_0x53af6a['chat']['id'],_0x8010b3(0x251));else{const _0x5f0eac=Markup[_0x8010b3(0x30a)]([Markup['button'][_0x8010b3(0x27c)]('Yes',_0x8010b3(0x3ac)),Markup[_0x8010b3(0x1f5)][_0x8010b3(0x27c)]('No',_0x8010b3(0x369))]);_0x53af6a['reply'](_0x8010b3(0x238),_0x5f0eac);}}}),tgBot[_0x400dcf(0x242)](/update_(.+)/,async _0x5220d7=>{const _0x63b96e=_0x400dcf,_0x1270cc=_0x5220d7[_0x63b96e(0x1f4)][0x1];_0x5220d7[_0x63b96e(0x3e1)](),_0x1270cc=='yes'&&(await sendTelegram(_0x5220d7[_0x63b96e(0x2b5)]['id'],_0x63b96e(0x290)),updateBB('update')),_0x1270cc=='no'&&await sendTelegram(_0x5220d7[_0x63b96e(0x2b5)]['id'],_0x63b96e(0x2c2));}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x276),async _0x32b428=>{const _0x287380=_0x400dcf;if(!validInstallation)await sendTelegram(_0x32b428[_0x287380(0x2b5)]['id'],'Your\x20installation\x20does\x20not\x20support\x20reinstalling\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20reinstallation');else{const _0x5654a6=Markup[_0x287380(0x30a)]([Markup['button']['callback'](_0x287380(0x303),_0x287380(0x1fa)),Markup[_0x287380(0x1f5)]['callback']('No',_0x287380(0x21f))]);_0x32b428[_0x287380(0x21e)](_0x287380(0x386),_0x5654a6);}}),tgBot[_0x400dcf(0x242)](/reinstall_(.+)/,async _0x15bb20=>{const _0x56bfb9=_0x400dcf,_0x29cee6=_0x15bb20[_0x56bfb9(0x1f4)][0x1];_0x15bb20[_0x56bfb9(0x3e1)](),_0x29cee6==_0x56bfb9(0x2c5)&&(await sendTelegram(_0x15bb20[_0x56bfb9(0x2b5)]['id'],'Starting\x20Balance\x20Bot\x20reinstallation'),updateBB('reinstall')),_0x29cee6=='no'&&await sendTelegram(_0x15bb20[_0x56bfb9(0x2b5)]['id'],_0x56bfb9(0x3c9));}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x38f),async _0x339777=>{const _0x50e853=_0x400dcf,_0x371277=getBotsWithMode();if(_0x371277[_0x50e853(0x23d)]==0x0)await sendTelegram(_0x339777[_0x50e853(0x2b5)]['id'],'No\x20bots\x20running\x20right\x20now');else{let _0xf61df3=[],_0x468fda=[];const _0x416a9e=0x2;let _0x4d503b=0x0;_0x371277[_0x50e853(0x257)]((_0x352a21,_0x5107a9)=>{const _0xdcc133=_0x50e853;if(_0x5107a9%_0x416a9e==0x0)_0x468fda=[];_0x468fda['push'](Markup['button'][_0xdcc133(0x27c)](botRef(_0x352a21['botID'])+'\x20('+_0x352a21['mode']+')','toggle_'+_0x352a21['botID'])),_0x5107a9%_0x416a9e==0x0&&(_0xf61df3[_0x4d503b]=_0x468fda,_0x4d503b++);});const _0x5bdb49=Markup['inlineKeyboard'](_0xf61df3);_0x339777[_0x50e853(0x21e)]('Which\x20bot\x20do\x20you\x20want\x20to\x20toggle?',_0x5bdb49);}}),tgBot[_0x400dcf(0x242)](/toggle_(.+)/,async _0x9e7ed7=>{const _0x3905cd=_0x400dcf,_0x1100c1=_0x9e7ed7[_0x3905cd(0x1f4)][0x1];_0x9e7ed7[_0x3905cd(0x3e1)]();const _0x4eb010=getBotsWithMode(),_0x177803=_0x4eb010[_0x3905cd(0x213)](_0x519844=>_0x519844[_0x3905cd(0x25d)]==_0x1100c1),_0x5676a4=_0x177803[_0x3905cd(0x20c)]==_0x3905cd(0x398)?'manual':_0x3905cd(0x398);await sendTelegram(_0x9e7ed7[_0x3905cd(0x2b5)]['id'],_0x3905cd(0x330)+botRef(_0x177803[_0x3905cd(0x25d)])+_0x3905cd(0x1f1)+_0x5676a4+_0x3905cd(0x396)),toggleBotMode(_0x1100c1);}),tgBot['command'](_0x400dcf(0x313),async _0x2af316=>{const _0x45eebd=_0x400dcf;let _0x4e13e6='';config['forEach'](_0x5b0554=>{const _0x33e4da=_0x4bf9;_0x4e13e6+=_0x33e4da(0x35d)+_0x5b0554['botID']+':\x20'+_0x5b0554['botname']+'\x0a';}),await sendTelegram(_0x2af316[_0x45eebd(0x2b5)]['id'],_0x4e13e6,{'parse_mode':_0x45eebd(0x3cb)});}),tgBot[_0x400dcf(0x22d)](_0x400dcf(0x329),async _0x145893=>{await sendTelegram(_0x145893['chat']['id'],_0x21a75f);}),process[_0x400dcf(0x1ec)](_0x400dcf(0x29e),()=>tgBot[_0x400dcf(0x220)](_0x400dcf(0x29e))),process[_0x400dcf(0x1ec)]('SIGTERM',()=>tgBot['stop'](_0x400dcf(0x2d2))),tgBot[_0x400dcf(0x399)]();}function disableTelegram(){const _0x4e50b8=_0x7fb00e;tgBot&&tgBot[_0x4e50b8(0x220)]();}async function sendTelegram(_0x2545b2,_0x5b5e3d,_0x1028ff){const _0x9a2a36=_0x7fb00e;_0x1028ff={..._0x1028ff,'disable_web_page_preview':!![]};try{await tgBot[_0x9a2a36(0x35e)][_0x9a2a36(0x300)](_0x2545b2,_0x5b5e3d,_0x1028ff);}catch(_0x4d368b){logger['debug'](_0x9a2a36(0x3ab),_0x4d368b);}}async function sendTelegramBot(_0x43c951,_0x25053c){const _0x499c48=_0x7fb00e;if(settings[_0x499c48(0x2f1)]){if(settings[_0x499c48(0x3e2)]==_0x499c48(0x2e6)||(_0x25053c[_0x499c48(0x2c1)]==_0x499c48(0x33e)||_0x25053c[_0x499c48(0x2c1)]==_0x499c48(0x358)||_0x25053c[_0x499c48(0x2c1)]=='success')&&settings[_0x499c48(0x3e2)]==_0x499c48(0x31d)||_0x25053c[_0x499c48(0x2c1)]==_0x499c48(0x263)&&settings[_0x499c48(0x3e2)]==_0x499c48(0x234)){if(tgBot&&settings[_0x499c48(0x32f)]){if(_0x25053c[_0x499c48(0x250)])await sendTelegram(settings[_0x499c48(0x32f)],_0x25053c['botname']+'\x20>\x20'+_0x25053c[_0x499c48(0x349)]);else await sendTelegram(settings[_0x499c48(0x32f)],'Bot\x20'+_0x43c951+_0x499c48(0x2b6)+_0x25053c['event']);}}}}async function sendTelegramMsg(_0x1df6d6,_0x3f5ed6=_0x7fb00e(0x3cb)){return tgBot&&settings['telegramChatId']?(await sendTelegram(settings['telegramChatId'],_0x1df6d6,{'parse_mode':_0x3f5ed6}),!![]):![];}function getDeviceWithIp(_0x125af0){const _0x3192bd=_0x7fb00e;return devices[_0x3192bd(0x213)](_0x2ef4ee=>_0x2ef4ee['ip']===_0x125af0);}async function temporaryAccess2FA(_0x1398d2,_0x476b90){const _0xc14542=_0x7fb00e;let _0x5c6de0=new Date(),_0x4bcf62=![];if(lastIpApproval){if(_0x5c6de0-lastIpApproval<0x1388)_0x4bcf62=!![];}lastIpApproval=new Date();if(_0x4bcf62)return;if(tgBot&&settings[_0xc14542(0x32f)]){const _0x51d693=uuidRandom();tmpStorage[_0x51d693]={'uuid':_0x1398d2,'externalip':_0x476b90};const _0x7cb4c6=Markup[_0xc14542(0x30a)]([Markup[_0xc14542(0x1f5)][_0xc14542(0x27c)]('5\x20min','tempaccess_5_'+_0x51d693),Markup[_0xc14542(0x1f5)]['callback']('15\x20min',_0xc14542(0x1cf)+_0x51d693),Markup[_0xc14542(0x1f5)][_0xc14542(0x27c)](_0xc14542(0x2de),_0xc14542(0x3a7)+_0x51d693),Markup[_0xc14542(0x1f5)][_0xc14542(0x27c)](_0xc14542(0x2e1),_0xc14542(0x29c)+_0x51d693)]);await sendTelegram(settings[_0xc14542(0x32f)],_0xc14542(0x2f8)+normalizeIP(_0x476b90)[_0xc14542(0x293)]+'\x20?',_0x7cb4c6),tgBot[_0xc14542(0x242)](/tempaccess_(.+)_(.+)/,async _0x402972=>{const _0x3257da=_0xc14542,_0xc4251d=_0x402972['match'][0x1],_0x42445b=_0x402972['match'][0x2],{uuid:_0x165520,externalip:_0x5c443d}=tmpStorage[_0x42445b];delete tmpStorage[_0x42445b],_0x402972[_0x3257da(0x3e1)](),devices[_0x165520][_0x3257da(0x1e2)]={'clientip':_0x5c443d,'timestamp':new Date()[_0x3257da(0x296)](),'expiry':_0xc4251d},_0xc4251d!=_0x3257da(0x2e1)?(await sendTelegram(_0x402972['chat']['id'],_0x3257da(0x216)+_0xc4251d+_0x3257da(0x3e5),{'parse_mode':_0x3257da(0x3cb)}),io['to'](_0x165520)[_0x3257da(0x211)](_0x3257da(0x2c4),{'access':{'allow':![],'reason':_0x3257da(0x3c6),'token':null}})):(await sendTelegram(_0x402972['chat']['id'],_0x3257da(0x2a7)),io['to'](_0x165520)[_0x3257da(0x211)]('status',{'access':{'allow':![],'reason':_0x3257da(0x288),'token':null}}));});}}async function loginAccess2FA(_0x40d70b,_0x3cbbfd){const _0x299390=_0x7fb00e;if(tgBot&&settings[_0x299390(0x32f)]){const _0x49ff52=uuidRandom();tmpStorage[_0x49ff52]={'uuid':_0x40d70b,'externalip':_0x3cbbfd};const _0x12a370=Markup[_0x299390(0x30a)]([Markup[_0x299390(0x1f5)]['callback'](_0x299390(0x384),_0x299390(0x280)+loginExpiry+'_'+_0x49ff52),Markup[_0x299390(0x1f5)]['callback'](_0x299390(0x2e1),'login2fa_reject_'+_0x49ff52)]);await sendTelegram(settings[_0x299390(0x32f)],_0x299390(0x3b2)+normalizeIP(_0x3cbbfd)[_0x299390(0x293)]+'\x20?',_0x12a370),tgBot['action'](/login2fa_(.+)_(.+)/,async _0x1279a2=>{const _0x3c60ac=_0x299390,_0x56ef3f=_0x1279a2['match'][0x1],_0x259f06=_0x1279a2[_0x3c60ac(0x1f4)][0x2],{uuid:_0x1c1a7d,externalip:_0x1bd6a7}=tmpStorage[_0x259f06];delete tmpStorage[_0x259f06],_0x1279a2['editMessageReplyMarkup'](),devices[_0x1c1a7d][_0x3c60ac(0x266)]={'clientip':_0x1bd6a7,'timestamp':new Date()['getTime'](),'expiry':_0x56ef3f},_0x56ef3f!=_0x3c60ac(0x2e1)?(await sendTelegram(_0x1279a2['chat']['id'],_0x3c60ac(0x353),{'parse_mode':'HTML'}),io['to'](_0x1c1a7d)[_0x3c60ac(0x211)]('status',{'access':{'allow':![],'reason':_0x3c60ac(0x3c6),'token':null}})):(await sendTelegram(_0x1279a2['chat']['id'],_0x3c60ac(0x3d6)),io['to'](_0x1c1a7d)[_0x3c60ac(0x211)](_0x3c60ac(0x2c4),{'access':{'allow':![],'reason':_0x3c60ac(0x337),'token':null}}));});}}function getConfiguration(){return getBotsWithMode();}function getEnabledBots(){const _0x2e946c=_0x7fb00e;return dbConfig[_0x2e946c(0x3a8)]('bots')[_0x2e946c(0x1ea)](_0x2e946c(0x25d))[_0x2e946c(0x20a)]({'status':_0x2e946c(0x281)})[_0x2e946c(0x1f2)]()||[];}function getDisabledBots(){const _0x176794=_0x7fb00e;return dbConfig[_0x176794(0x3a8)](_0x176794(0x3e4))[_0x176794(0x1ea)](_0x176794(0x25d))['filter']({'status':_0x176794(0x255)})[_0x176794(0x1f2)]()||[];}function getBotAttributes(_0x30712e){const _0x246f9d=_0x7fb00e;let _0x567bec={};const _0x39f594=configpath+'bot-'+_0x30712e+_0x246f9d(0x1eb),_0x1b265c=fs[_0x246f9d(0x2af)](_0x39f594);if(_0x1b265c){const _0x5618d2=fs[_0x246f9d(0x2f0)](_0x39f594);try{const _0x47d260=JSON[_0x246f9d(0x385)](_0x5618d2),_0x128746=_0x47d260?_0x47d260[_0x246f9d(0x2f9)][0x0]['headless']:![];_0x567bec['mode']=_0x128746?_0x246f9d(0x398):_0x246f9d(0x218),_0x567bec[_0x246f9d(0x27e)]=_0x47d260?_0x47d260[_0x246f9d(0x2f9)][0x0][_0x246f9d(0x27e)]:_0x246f9d(0x35d)+_0x30712e,_0x567bec[_0x246f9d(0x250)]=_0x47d260?_0x47d260['bot'][0x0][_0x246f9d(0x250)]:![];}catch(_0x47c316){_0x567bec[_0x246f9d(0x20c)]=_0x246f9d(0x218),_0x567bec[_0x246f9d(0x27e)]='Bot\x20'+_0x30712e,_0x567bec[_0x246f9d(0x250)]=![];}}else _0x567bec[_0x246f9d(0x20c)]=_0x246f9d(0x218),_0x567bec[_0x246f9d(0x27e)]='Bot\x20'+_0x30712e,_0x567bec['showname']=![];return _0x567bec;}function getBotsWithMode(){const _0x2a3b32=_0x7fb00e,_0x53f596=dbConfig[_0x2a3b32(0x3a8)](_0x2a3b32(0x3e4))[_0x2a3b32(0x1ea)](_0x2a3b32(0x25d))[_0x2a3b32(0x1f2)]()||[];return _0x53f596[_0x2a3b32(0x257)](_0x47b779=>{const _0x343dbb=_0x2a3b32;let _0x111b5c=getBotAttributes(_0x47b779[_0x343dbb(0x25d)]);_0x47b779[_0x343dbb(0x20c)]=_0x111b5c[_0x343dbb(0x20c)];}),_0x53f596;}function getBotExchanges(){const _0x2903ab=_0x7fb00e;let _0xce4b6a=[];const _0x3ed0a4=dbConfig['get']('bots')[_0x2903ab(0x1ea)]('botID')[_0x2903ab(0x1f2)]()||[];_0x3ed0a4['forEach'](_0x433d85=>{const _0x33e77e=_0x2903ab;if(_0x433d85[_0x33e77e(0x2c4)]==_0x33e77e(0x281)){const _0x508402=configpath+_0x33e77e(0x2a2)+_0x433d85[_0x33e77e(0x25d)]+_0x33e77e(0x1eb),_0x5eb937=fs['existsSync'](_0x508402);let _0xd02369;if(_0x5eb937){const _0x420d02=fs[_0x33e77e(0x2f0)](_0x508402);try{const _0x4e49cf=JSON[_0x33e77e(0x385)](_0x420d02);_0xd02369=_0x4e49cf?_0x4e49cf[_0x33e77e(0x2f9)][0x0][_0x33e77e(0x3e0)]:null;}catch(_0x151492){}}if(_0xd02369)_0xce4b6a['push'](_0xd02369);}});const _0x493c09=[...new Set(_0xce4b6a)][_0x2903ab(0x3a6)]();return _0x493c09;}async function initUser(){const _0x29532d=_0x7fb00e;if(!settings[_0x29532d(0x32b)]){const _0x1c9c57=uuidRandom();mixpanel[_0x29532d(0x24a)](_0x1c9c57),updateSetting(_0x29532d(0x32b),_0x1c9c57);}}async function initSecure(){const _0x3f5423=_0x7fb00e;let _0x221bef=getSecure();if(!_0x221bef[_0x3f5423(0x36d)]('secret')){let _0x1ef0ac=await generateKeys();_0x221bef[_0x3f5423(0x2a9)]=_0x1ef0ac[_0x3f5423(0x2a9)],_0x221bef[_0x3f5423(0x225)]=_0x1ef0ac[_0x3f5423(0x225)],_0x221bef[_0x3f5423(0x275)]=crypto[_0x3f5423(0x38c)](0x20)[_0x3f5423(0x1ef)](_0x3f5423(0x2c8));;storeSecure(_0x221bef);}}function getSettings(){const _0x58d761=_0x7fb00e;return dbSettings['get'](_0x58d761(0x2ed))[_0x58d761(0x1f2)]()||{};}function getSecure(){const _0x4ec7c2=_0x7fb00e;return dbSecure[_0x4ec7c2(0x3a8)]('secure')[_0x4ec7c2(0x1f2)]()||{};}function getBlacklist(){const _0x3d83ba=_0x7fb00e;return dbSecure['get'](_0x3d83ba(0x373))[_0x3d83ba(0x1f2)]()||[];}function broadcastToBots(_0xbad86e,_0x5b11ea){config['forEach'](_0xb6f46d=>{const _0x4993f7=_0x4bf9;if(_0xb6f46d[_0x4993f7(0x2c4)]=='enabled'&&_0xb6f46d[_0x4993f7(0x2d1)]=='running'||_0xb6f46d[_0x4993f7(0x2c4)]==_0x4993f7(0x283)&&_0xb6f46d[_0x4993f7(0x2d1)]=='running'){if(pid[_0xb6f46d['botID']])pid[_0xb6f46d[_0x4993f7(0x25d)]]['send']({[_0xbad86e]:_0x5b11ea});}});}async function storeSettings(_0x30ce02,_0x420d36=![]){const _0x516ba2=_0x7fb00e;_0x30ce02={...settings,..._0x30ce02};if(_0x420d36&&_0x30ce02[_0x516ba2(0x2e4)]!=_0x516ba2(0x317)&&_0x30ce02[_0x516ba2(0x2e4)]!=_0x516ba2(0x322)&&_0x30ce02[_0x516ba2(0x2e4)]!=''){const _0x399803=decryptRSA(secure['privateKey'],_0x30ce02[_0x516ba2(0x2e4)])['split']('|@|')[0x0],_0x2b9f13=bcrypt['hashSync'](_0x399803,saltRounds);_0x30ce02={..._0x30ce02,'bbPassword':_0x2b9f13};}if(_0x420d36&&_0x30ce02[_0x516ba2(0x3a5)]!=_0x516ba2(0x317)&&_0x30ce02[_0x516ba2(0x3a5)]!='***'&&_0x30ce02['telegramToken']!=''){const _0x234a20=decryptRSA(secure[_0x516ba2(0x225)],_0x30ce02[_0x516ba2(0x3a5)])[_0x516ba2(0x360)](_0x516ba2(0x356))[0x0];_0x30ce02={..._0x30ce02,'telegramToken':_0x234a20};}if(_0x420d36&&_0x30ce02[_0x516ba2(0x3db)]!='************'&&_0x30ce02[_0x516ba2(0x3db)]!='***'&&_0x30ce02[_0x516ba2(0x3db)]!=''){const _0x10e4f8=decryptRSA(secure['privateKey'],_0x30ce02[_0x516ba2(0x3db)])[_0x516ba2(0x360)]('|@|')[0x0];_0x30ce02={..._0x30ce02,'marketcapApi':_0x10e4f8};}const _0x4b82cd=_0x30ce02[_0x516ba2(0x3a5)]!=_0x516ba2(0x317)&&_0x30ce02[_0x516ba2(0x3a5)]!=settings[_0x516ba2(0x3a5)]||_0x30ce02[_0x516ba2(0x324)]!=settings[_0x516ba2(0x324)],_0x54a126=_0x30ce02[_0x516ba2(0x3a5)]==''||_0x30ce02[_0x516ba2(0x324)]=='',_0x128a79=_0x30ce02['marketcapApi']&&_0x30ce02[_0x516ba2(0x3db)]!=_0x516ba2(0x317)&&_0x30ce02['marketcapApi']!=settings['marketcapApi'];_0x4b82cd&&(_0x30ce02[_0x516ba2(0x32f)]=null,_0x30ce02[_0x516ba2(0x3e2)]='all');for(const [_0x1c1677,_0x16b405]of Object[_0x516ba2(0x30b)](_0x30ce02)){if(_0x1c1677==_0x516ba2(0x3a5)&&_0x16b405=='************'){_0x30ce02[_0x516ba2(0x3a5)]=settings[_0x516ba2(0x3a5)];continue;};if(_0x1c1677==_0x516ba2(0x2e4)&&_0x16b405==_0x516ba2(0x317)){_0x30ce02[_0x516ba2(0x2e4)]=settings[_0x516ba2(0x2e4)];continue;};if(_0x1c1677==_0x516ba2(0x3db)&&_0x16b405=='************'){_0x30ce02['marketcapApi']=settings[_0x516ba2(0x3db)];continue;};dbSettings[_0x516ba2(0x252)](_0x516ba2(0x36e)+_0x1c1677,_0x16b405)[_0x516ba2(0x397)]();}settings=_0x30ce02,io['to'](_0x516ba2(0x378))[_0x516ba2(0x211)](_0x516ba2(0x2ed),cleanSettings()),broadcastToBots(_0x516ba2(0x26f),settings['timeshift']),broadcastToBots(_0x516ba2(0x342),settings[_0x516ba2(0x342)]),broadcastToBots(_0x516ba2(0x3db),settings[_0x516ba2(0x3db)]);if(_0x4b82cd&&!_0x54a126)initTelegram();_0x4b82cd&&_0x54a126&&(updateSetting(_0x516ba2(0x32f),null),disableTelegram()),getAllClients()[_0x516ba2(0x257)](_0x3912ff=>{const _0x3ebeed=_0x516ba2;getSocket(_0x3912ff['id'])[_0x3ebeed(0x211)]('status',{'access':{'allow':![],'reason':_0x3ebeed(0x3c6),'token':null}});}),_0x128a79&&(await sleep(0xbb8),testMarketcapApi(_0x30ce02[_0x516ba2(0x3db)]));}async function testMarketcapApi(_0x15b780){const _0x3e017c=_0x7fb00e,_0x3f6230=[_0x3e017c(0x1d7),'ETH'];try{await axios[_0x3e017c(0x3a8)](_0x3e017c(0x1f3),{'headers':{'X-CMC_PRO_API_KEY':_0x15b780},'params':{'symbol':_0x3f6230[_0x3e017c(0x1ef)]()}});}catch(_0x33d102){_0x33d102[_0x3e017c(0x1ef)]()[_0x3e017c(0x258)](_0x3e017c(0x3ad))?(io['to']('botmanager')[_0x3e017c(0x211)](_0x3e017c(0x222),'CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager'),logger[_0x3e017c(0x2da)]('CoinMarketCap\x20API\x20key\x20is\x20invalid\x20-\x20enter\x20your\x20API\x20key\x20in\x20the\x20Bot\x20Manager')):(io['to'](_0x3e017c(0x378))[_0x3e017c(0x211)]('notification','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details'),logger['full'](_0x3e017c(0x394)),logger[_0x3e017c(0x2ce)]('Error\x20details:',_0x33d102[_0x3e017c(0x1ef)]()+_0x3e017c(0x2ca)+_0x33d102[_0x3e017c(0x39a)]));return;}logger[_0x3e017c(0x2ce)](_0x3e017c(0x22a));}function updateSetting(_0x42b7b4,_0x401642){const _0x10c238=_0x7fb00e;dbSettings[_0x10c238(0x252)](_0x10c238(0x36e)+_0x42b7b4,_0x401642)[_0x10c238(0x397)](),settings=getSettings(),io['to'](_0x10c238(0x378))['emit'](_0x10c238(0x2ed),cleanSettings());}function storeSecure(_0x20dc39){const _0x41434f=_0x7fb00e;dbSecure[_0x41434f(0x3a8)]('secure')[_0x41434f(0x33f)](_0x20dc39)[_0x41434f(0x397)](),secure=_0x20dc39;}function addBlacklist(_0x29fb14){const _0x2472f2=_0x7fb00e;cleanBlacklist();let _0xda531f;devices[_0x29fb14]['telegramIpApproval']?_0xda531f=Math[_0x2472f2(0x2ba)](devices[_0x29fb14][_0x2472f2(0x1e2)][_0x2472f2(0x3ca)],loginExpiry):_0xda531f=loginExpiry,dbSecure[_0x2472f2(0x3a8)](_0x2472f2(0x373))['push']({'expiry':new Date()[_0x2472f2(0x296)]()+_0xda531f*0x3c*0x3e8,'token':devices[_0x29fb14][_0x2472f2(0x1e4)][_0x2472f2(0x1d9)]})[_0x2472f2(0x397)](),blacklist=dbSecure['get'](_0x2472f2(0x373))['value']();}function cleanBlacklist(){const _0x470d59=_0x7fb00e;let _0x308f5e=dbSecure[_0x470d59(0x3a8)](_0x470d59(0x373))[_0x470d59(0x3e8)]()['value'](),_0x7e4baa=new Date()[_0x470d59(0x296)]();_0x308f5e[_0x470d59(0x257)](_0x2c8540=>{const _0x236552=_0x470d59;_0x2c8540[_0x236552(0x3ca)]<_0x7e4baa&&dbSecure[_0x236552(0x3a8)](_0x236552(0x373))[_0x236552(0x282)]({'expiry':_0x2c8540['expiry']})['write']();});}function initStates(){const _0x510226=_0x7fb00e;let _0x2a6618=getConfiguration();_0x2a6618[_0x510226(0x257)](_0x1070c0=>{const _0x53c21b=_0x510226;_0x1070c0[_0x53c21b(0x2d1)]=_0x53c21b(0x29b);}),storeConfiguration(_0x2a6618);}async function generateKeys(){const _0x28daaf=_0x7fb00e,_0x209286=forge[_0x28daaf(0x20f)]['rsa']['generateKeyPair']({'bits':0x1000,'e':0x10001}),_0x1ff0d=forge[_0x28daaf(0x20f)][_0x28daaf(0x388)](_0x209286['privateKey']),_0x239eda=forge[_0x28daaf(0x20f)][_0x28daaf(0x2bf)](_0x209286['publicKey']);return{'privateKey':_0x1ff0d,'publicKey':_0x239eda};}async function oneTimeMigration(){const _0x5d4386=_0x7fb00e;let _0x58f549=getSettings(),_0x4b7e8d=![];!_0x58f549[_0x5d4386(0x36d)](_0x5d4386(0x217))&&(_0x58f549[_0x5d4386(0x217)]=0x0,_0x4b7e8d=!![]);!_0x58f549[_0x5d4386(0x36d)](_0x5d4386(0x235))&&(_0x58f549['lastmsgemitted']=0x0,_0x4b7e8d=!![]);!_0x58f549[_0x5d4386(0x36d)](_0x5d4386(0x24b))&&(_0x58f549['latestversion']=_0x5d4386(0x22e),_0x4b7e8d=!![]);!_0x58f549[_0x5d4386(0x36d)]('onepagemode')&&(_0x58f549[_0x5d4386(0x342)]=![],_0x4b7e8d=!![]);!_0x58f549[_0x5d4386(0x36d)](_0x5d4386(0x3db))&&(_0x58f549[_0x5d4386(0x3db)]='',_0x4b7e8d=!![]);if(_0x4b7e8d)storeSettings(_0x58f549);try{fs['readdirSync'](configbackuppath,{'withFileTypes':!![]})[_0x5d4386(0x257)](_0x24d978=>{const _0x178a12=_0x5d4386;if(!_0x24d978['isDirectory']()){if(!_0x24d978[_0x178a12(0x259)]['startsWith'](_0x178a12(0x27b)))fs[_0x178a12(0x21a)](configbackuppath+_0x24d978[_0x178a12(0x259)]);}else fs[_0x178a12(0x2e9)](configbackuppath+_0x24d978[_0x178a12(0x259)],{'recursive':!![]});});}catch(_0x229cf9){logger[_0x5d4386(0x2ce)](_0x5d4386(0x22b),_0x229cf9);}}function storeConfiguration(_0x598fde){const _0x1b017a=_0x7fb00e;dbConfig['get']('bots')['remove']()[_0x1b017a(0x397)](),dbConfig[_0x1b017a(0x3a8)](_0x1b017a(0x3e4))[_0x1b017a(0x33f)](..._0x598fde)[_0x1b017a(0x397)](),config=_0x598fde;}async function resetPassword(){const _0x31d498=_0x7fb00e;if(tgBot&&settings[_0x31d498(0x32f)]){const _0x216e92=Markup[_0x31d498(0x30a)]([Markup[_0x31d498(0x1f5)][_0x31d498(0x27c)](_0x31d498(0x2c5),'resetpw_yes'),Markup[_0x31d498(0x1f5)][_0x31d498(0x27c)]('no',_0x31d498(0x371))]);await sendTelegram(settings['telegramChatId'],'Do\x20you\x20want\x20to\x20reset\x20your\x20password?',_0x216e92),tgBot['action'](/resetpw_(.+)/,async _0x90dc7b=>{const _0x3d2bb0=_0x31d498,_0x40bb7c=_0x90dc7b[_0x3d2bb0(0x1f4)][0x1];_0x90dc7b[_0x3d2bb0(0x3e1)]();if(_0x40bb7c!='no'){const _0x54fde9=0xf,_0x56eb8c=_0x3d2bb0(0x253),_0x1b67c5=Array[_0x3d2bb0(0x3bf)](crypto['randomFillSync'](new Uint32Array(_0x54fde9)))[_0x3d2bb0(0x28f)](_0x293f7a=>_0x56eb8c[_0x293f7a%_0x56eb8c[_0x3d2bb0(0x23d)]])['join'](''),_0x4fcadb=bcrypt['hashSync'](_0x1b67c5,saltRounds);storeSettings({'bbPassword':_0x4fcadb}),await sendTelegram(_0x90dc7b['chat']['id'],_0x3d2bb0(0x2f4)+_0x1b67c5,{'parse_mode':_0x3d2bb0(0x3cb)});}else await sendTelegram(_0x90dc7b[_0x3d2bb0(0x2b5)]['id'],'Password\x20reset\x20rejected');});}}async function confirmRestore(_0x4899cb,_0x216a4a){const _0x453bac=_0x7fb00e;io['to'](_0x453bac(0x378))['emit'](_0x453bac(0x222),_0x453bac(0x215),_0x453bac(0x31f));if(tgBot&&settings[_0x453bac(0x32f)]){const _0x3bd76f=uuidRandom();tmpStorage[_0x3bd76f]={'path':_0x4899cb,'filename':_0x216a4a};const _0x1ac6e2=Markup[_0x453bac(0x30a)]([Markup[_0x453bac(0x1f5)][_0x453bac(0x27c)](_0x453bac(0x2c5),_0x453bac(0x29d)+_0x3bd76f),Markup['button'][_0x453bac(0x27c)]('no',_0x453bac(0x2c3)+_0x3bd76f)]);await sendTelegram(settings[_0x453bac(0x32f)],_0x453bac(0x1f8),_0x1ac6e2),tgBot[_0x453bac(0x242)](/restore_(.+)_(.+)/,async _0x331307=>{const _0x2e5929=_0x453bac,_0xb58750=_0x331307[_0x2e5929(0x1f4)][0x1],_0x236050=_0x331307[_0x2e5929(0x1f4)][0x2],{path:_0xf29f34,filename:_0x26d064}=tmpStorage[_0x236050];delete tmpStorage[_0x236050],_0x331307['editMessageReplyMarkup'](),_0xb58750=='yes'?(logger[_0x2e5929(0x2ce)](_0x2e5929(0x287)),await sendTelegram(_0x331307[_0x2e5929(0x2b5)]['id'],_0x2e5929(0x3b1),{'parse_mode':_0x2e5929(0x3cb)}),unzipFile(_0xf29f34,_0x26d064)):(logger['debug'](_0x2e5929(0x3be)),await sendTelegram(_0x331307[_0x2e5929(0x2b5)]['id'],_0x2e5929(0x3be)));});}}function getServerTime(){const _0x49f05f=_0x7fb00e,_0x4cd55c=new Date();return _0x4cd55c['getFullYear']()+'/'+(_0x4cd55c['getMonth']()+0x1)[_0x49f05f(0x1ef)]()[_0x49f05f(0x39d)](0x2,'0')+'/'+_0x4cd55c[_0x49f05f(0x1fe)]()['toString']()[_0x49f05f(0x39d)](0x2,'0')+'\x20'+_0x4cd55c[_0x49f05f(0x382)]()[_0x49f05f(0x1ef)]()[_0x49f05f(0x39d)](0x2,'0')+':'+_0x4cd55c[_0x49f05f(0x3d7)]()[_0x49f05f(0x1ef)]()[_0x49f05f(0x39d)](0x2,'0')+':'+_0x4cd55c[_0x49f05f(0x328)]()[_0x49f05f(0x1ef)]()[_0x49f05f(0x39d)](0x2,'0');}function _0x1e15(){const _0x2d6a96=['bbvNew','unlinkSync','string','clientip','Notifications\x20disabled','reply','reinstall_no','stop','toIPv4Address','notification','restart_','bb-settings.json','privateKey','Invalid\x20authentication\x20token\x20(2)','catch','defaults','off_','CoinMarketCap\x20API\x20key\x20validated','Error\x20removing\x20old\x20backup\x20files:','clients','command','0.0.0','tkn','Unknown\x20client\x20attempting\x20to\x20retrieve\x20list\x20of\x20backup\x20files','backup/','/:bot','logs','orders','lastmsgemitted','-events.json','#RES#','Are\x20you\x20sure\x20you\x20want\x20to\x20update\x20Balance\x20Bot\x20now?','5YzSRZO','toIPv4MappedAddress','/status\x20-\x20show\x20bot(s)\x20status\x0a','graphql-request','length','versions','getFullYear','path','Which\x20bot\x20do\x20you\x20want\x20to\x20restart?','action','exp','size','ipc','delete-bot','/:bot/history','uuid','1514408BENjRo','alias','latestversion','removeAllListeners','2FA\x20required','2FA\x20login\x20token\x20generated','decrypt','showname','Your\x20installation\x20does\x20not\x20support\x20updating\x20from\x20Telegram.\x20Please\x20perform\x20a\x20manual\x20update','set','0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz~!@-#$','get-logs','disabled','post','forEach','includes','name','Unauthorized\x20attempt\x20to\x20reset\x20bot\x20history','temporary\x20access\x20timeout','conn','botID','user','startsWith','Starting\x20#RED#Balance\x20Bot\x20v',':\x20Bot\x20Mgr\x20>\x20','use','order','password','function','telegram2FaApproval','Notifications\x20types:\x20orders\x20and\x20alerts\x0a','toggle-bot-mode','internal','listen','send','::1','any','You\x20can\x20use\x20the\x20following\x20commands:\x0a','timeshift','keys','1zbnRyj','Starting\x20(',':\x20Bot\x20Mgr\x20>\x20[DEBUG]\x20','config_all','secret','reinstall','Unauthorized\x20attempt\x20to\x20log\x20out','Notifications\x20enabled\x0a','Which\x20bot\x20do\x20you\x20want\x20to\x20start?','Bot\x20Mgr\x20>\x20Starting\x20','backup-full@','callback','Node.js\x20v','botname','storeFiat','login2fa_','enabled','remove','new','resetHistory','/portfolio\x20-\x20show\x20bot\x20portfolio\x0a','Of\x20which\x20events\x20do\x20you\x20want\x20to\x20be\x20notified?','Restore\x20process\x20confirmed','temporary\x20access\x20rejected','apiPassword','request','For\x20which\x20bot\x20do\x20you\x20want\x20the\x20portfolio?','config_orders','search','getUTCHours','map','Starting\x20Balance\x20Bot\x20update','Ok,\x20will\x20send\x20alert\x20notifications\x20only','Error:\x20Invalid\x20argument\x20','show','place-order','static','getTime','\x20(1)','username','Unauthorized\x20user\x20-\x20make\x20sure\x20you\x27ve\x20entered\x20your\x20<b>personal</b>\x20Telegram\x20username\x20in\x20the\x20Bot\x20Manager\x27s\x20settings','Invalid\x20authentication\x20token\x20(1)','stopped','tempaccess_reject_','restore_yes_','SIGINT','getPortfolio','RSA-OAEP','build','bot-','/:bot/support','Error\x20sending\x20','handshake','telegraf','Temporary\x20access\x20rejected','1501881uaufVd','publicKey','Alerts','\x1b[31m','copyFileSync','Unauthorized\x20attempt\x20to\x20delete\x20alerts','backup-full.zip','existsSync','constructor',')\x20|\x20Bot\x20','\x1b[34m','Restarting\x20','login\x20token\x20generated','chat','\x20>\x20','5542803pDtmOi','temporary\x20access\x20not\x20allowed','bb-config.json','max','restart','bcryptjs','host','\x20only\x0a','publicKeyToPem','message','type','Ok,\x20consider\x20updating\x20Balance\x20Bot\x20later','restore_no_','status','yes','bbUsername','jszip','hex','No\x20authentication\x20token','\x20-\x20','Unauthorized\x20attempt\x20to\x20get\x20portfolio','backup-files','stringify','debug','Unauthorized\x20attempt\x20to\x20confirm\x20message','getMonth','live','SIGTERM','Orders','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(1)','on_','output-000.log','config/','Markdown','127.0.0.1','full','Unauthorized\x20attempt\x20to\x20download\x20','async','update-bb','30\x20min','/toggle\x20-\x20toggle\x20manual\x20vs\x20auto\x20mode\x0a','reason','reject','Setting\x20access:\x20','version.json','bbPassword','staging','all','backupfile','Unauthorized\x20attempt\x20to\x20store\x20headless\x20configuration','rmSync','/backup\x20-\x20receive\x20backup\x20files\x0a','createServer','util','settings','Deleted\x20Bot\x20','=>\x20Go\x20to\x20#CYA#http://127.0.0.1:','readFileSync','telegramEnabled','logs/','remoteAddress','Password\x20has\x20been\x20reset\x20to:\x20','File\x20uploaded','Logged\x20out\x20user\x20...','apiKey','Allow\x20temporary\x20access\x20from\x20IP\x20address\x20','bot','sendPortfolioTelegram','apply','store','2FA\x20login\x20required','Telegraf\x20error:','/reinstall\x20-\x20reinstall\x20Balance\x20Bot\x0a','sendMessage','mixpanel','output-001.log','Yes','index.html','get-messages','update-bot','Bot\x20Mgr\x20>\x20Starting\x20all\x20bots','apiSecret','range','inlineKeyboard','entries','updatebotmanager','title','9EWkSLM','then','mkdirSync','/disable\x20-\x20disable\x20notifications\x0a','sendFile','names','args','Unauthorized\x20attempt\x20to\x20place\x20market\x20order','/config\x20-\x20notification\x20types\x20to\x20receive\x0a','************','/:bot/performance','loginRequired','add','readdirSync','/restart\x20-\x20restart\x20bot(s)\x0a','alerts','NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bots\x20are\x20disabled\x20by\x20default\x20-\x20enable\x20those\x20you\x20want\x20to\x20run','success','Unauthorized\x20attempt\x20to\x20update\x20bot',')\x20\x20\x20|\x20Bot\x20','***','Backup\x20file\x20unzipped\x20and\x20stored','telegramUsername','Failed\x20to\x20download\x20','output-002.log','add-bot','getSeconds','help','login\x20token\x20valid','userid','sendMetricsTelegram','All\x20bots','Invalid\x20username\x20or\x20IP\x20address','telegramChatId','Bot\x20Mgr\x20>\x20Toggling\x20','::ffff:7f00:1','slice','pidExpireLogin','update','messages','login\x20not\x20required','2FA\x20login\x20rejected','express-fileupload','f2aRequired','portfolio_','sign','/off\x20-\x20stop\x20bot(s)\x0a','/upload-backup','error','push','*$1*','log','onepagemode','build2','binary','test','Logged\x20in\x20user\x20...','port','Idling\x20(','event','telegrammsg','socket','#RES#\x20if\x20running\x20on\x20server','simple','login\x20required','/metrics\x20-\x20show\x20bot\x20performance\x0a','::ffff:127.0.0.1','5964556sQtlON','statSync','Login\x20accepted','yargs','2FA','|@|','Unauthorized\x20attempt\x20to\x20reinstall\x20Balance\x20Bot','warning','output-003.log','/start','Server','temp/','Bot\x20','telegram','Invalid\x20IP\x20address','split','referer','login','create','Unauthorized\x20attempt\x20to\x20get\x20messages','backup','https://api.ipify.org?format=json','replace','temporaryAccessAllowed','update_no','Error\x20while\x20deleting\x20config\x20files:\x20','Token\x20blacklisted','bb/','hasOwnProperty','settings.','Bot\x20Mgr\x20>\x20Stopping\x20','confirm-message','resetpw_no','fork','blacklist','production','[ip-address]','\x20(2)','new-disabled','botmanager','Unauthorized\x20attempt\x20to\x20upload\x20file\x20(2)','getStartingBalances','join','(staging)','privateKeyFromPem','metrics_','/on\x20-\x20start\x20bot(s)\x0a','/download/:type','crypto','getHours','headers','accept','parse','Are\x20you\x20sure\x20you\x20want\x20to\x20reinstall\x20Balance\x20Bot\x20now?','\x1b[0m','privateKeyToPem','timestamp','8aCuDay','exec','randomBytes','storeConfiguration','auth','toggle','-results.json','bbvReceive','isDirectory','disconnect','CoinMarketCap\x20data\x20could\x20not\x20be\x20retrieved\x20-\x20see\x20logs\x20for\x20details','off','\x20mode','write','auto','launch','code','endsWith','store-configuration','padStart','/names\x20-\x20show\x20bot\x20names\x0a','Unauthorized\x20attempt\x20to\x20store\x20fiat\x20configuration','-----------------------------------------------------------------------------------','12JlZDdJ','pidRefreshToken','.zip','>\x20Set\x20up\x20your\x20first\x20bot\x20in\x20the\x20Bot\x20Manager!','telegramToken','sort','tempaccess_30_','get','Running\x20#RED#Balance\x20Bot\x20v','Notifications\x20enabled','Telegram\x20error:','update_yes','status\x20code\x20401','show-config','Your\x20installation\x20is\x20already\x20up\x20to\x20date','store-headless','Restoring\x20bot(s)\x20from\x20backup','Allow\x20login\x20from\x20IP\x20address\x20','(((.+)+)+)+$','No\x20bots\x20running\x20right\x20now','address','Unauthorized\x20attempt\x20to\x20add\x20bot','bb-secure.json','lowdb/adapters/FileSync','loadAsync','exit','isValid','bot.js','api-eu.mixpanel.com','Restore\x20process\x20aborted','from','invalid\x20credentials','uuid-random','whitelistEnabled','Which\x20bot\x20do\x20you\x20want\x20to\x20stop?','Unauthorized\x20attempt\x20to\x20update\x20Balance\x20Bot','access\x20timeout','reload','Ok,\x20will\x20send\x20order\x20notifications\x20only','Bot\x20Mgr\x20>\x20','Ok,\x20reinstalling\x20Balance\x20Bot\x20canceled','expiry','HTML','close','DEFLATE','writeFileSync','/:bot/portfolio','number','lowdb','/:bot/configuration','inherit','get-starting-balances','Unauthorized\x20login\x20attempt\x20(timeout)','Login\x20rejected','getMinutes','/help\x20-\x20show\x20available\x20commands\x0a','\x20|\x20','\x1b[36m','marketcapApi','server','/enable\x20-\x20enable\x20notifications\x0a','-performance.json','started','exchange','editMessageReplyMarkup','telegramEvents','All','bots','\x20minutes','headless','/update\x20-\x20update\x20Balance\x20Bot\x0a','cloneDeep','config_alerts','4463430lqMuyQ','tempaccess_15_','--------------------------------------','family','/output-000.log','generateAsync','https://api-eu-central-1.graphcms.com/v2/ckoytzv3lotky01w59glace7y/master','decode64',',\x20must\x20be\x20a\x204\x20digit\x20number','BCT','zip/','token','Unauthorized\x20attempt\x20to\x20store\x20configuration','allow','restore-backup-file','track','metrics','Unauthorized\x20attempt\x20to\x20get\x20events','isIPv4MappedAddress','format','telegramIpApproval','Welcome\x20to\x20your\x20personal\x20Balance\x20Bot\x20Telegram\x20bot!\x0a','access','data','toggleBotMode','Unauthorized\x20attempt\x20to\x20show\x20configuration','2856678PcnasO','verify','sortBy','-config.json','once','replyWithDocument','download','toString','jsonwebtoken','\x20to\x20','value','https://pro-api.coinmarketcap.com/v2/cryptocurrency/quotes/latest','match','button','kill','\x1b[33m','Do\x20you\x20want\x20to\x20restore\x20your\x20installation?\x20NOTE:\x20this\x20will\x20replace\x20your\x20current\x20settings\x20and\x20bot(s)','environment','reinstall_yes','sha256','file','\x1b[35m','getDate','whitelist','/logs\x20-\x20receive\x20log\x20files\x0a','assign','3000','child_process','6385970eEoJhe','Ok,\x20will\x20send\x20both\x20order\x20and\x20alert\x20notifications','files','init','Backup\x20file\x20uploaded','Unauthorized\x20attempt\x20to\x20restore\x20backup\x20file','filter','\x20files\x20over\x20Telegram:','mode','=>\x20Go\x20to\x20#CYA#http://','reset-history','pki','version','emit','logout','find','compareSync','Please\x20confirm\x20restoring\x20in\x20your\x20Telegram\x20bot','Access\x20enabled\x20for\x20','lastmsgtelegram','manual'];_0x1e15=function(){return _0x2d6a96;};return _0x1e15();}function getTimeStamp(){const _0x119bc0=_0x7fb00e,_0x32019a=shiftedTime();return _0x32019a[_0x119bc0(0x23f)]()+'/'+(_0x32019a[_0x119bc0(0x2d0)]()+0x1)['toString']()[_0x119bc0(0x39d)](0x2,'0')+'/'+_0x32019a['getDate']()[_0x119bc0(0x1ef)]()[_0x119bc0(0x39d)](0x2,'0')+'\x20'+_0x32019a[_0x119bc0(0x382)]()[_0x119bc0(0x1ef)]()[_0x119bc0(0x39d)](0x2,'0')+':'+_0x32019a[_0x119bc0(0x3d7)]()[_0x119bc0(0x1ef)]()[_0x119bc0(0x39d)](0x2,'0')+':'+_0x32019a[_0x119bc0(0x328)]()[_0x119bc0(0x1ef)]()[_0x119bc0(0x39d)](0x2,'0');}function getCleanTimeStamp(){const _0x3638c4=_0x7fb00e,_0x1bbf94=shiftedTime();return _0x1bbf94[_0x3638c4(0x23f)]()+(_0x1bbf94[_0x3638c4(0x2d0)]()+0x1)['toString']()[_0x3638c4(0x39d)](0x2,'0')+_0x1bbf94[_0x3638c4(0x1fe)]()[_0x3638c4(0x1ef)]()[_0x3638c4(0x39d)](0x2,'0')+'-'+_0x1bbf94[_0x3638c4(0x382)]()[_0x3638c4(0x1ef)]()[_0x3638c4(0x39d)](0x2,'0')+_0x1bbf94[_0x3638c4(0x3d7)]()[_0x3638c4(0x1ef)]()['padStart'](0x2,'0')+_0x1bbf94['getSeconds']()['toString']()[_0x3638c4(0x39d)](0x2,'0');}function shiftedTime(){const _0x3a99a0=_0x7fb00e,_0x34c3ed=new Date();let _0x12020d=_0x34c3ed;if(settings[_0x3a99a0(0x26f)]&&settings[_0x3a99a0(0x26f)]!==0x0)_0x12020d=fns[_0x3a99a0(0x31a)](_0x34c3ed,{'hours':settings[_0x3a99a0(0x26f)]});return _0x12020d;}async function startScheduler(){const _0x3b956a=_0x7fb00e,_0x51d754=new Date()[_0x3b956a(0x28e)](),_0xaa4e89=shiftedTime()[_0x3b956a(0x382)]();_0xaa4e89==0x4&&backupConfigFiles(),_0xaa4e89==0x0&&(rotateLogFiles(),logger[_0x3b956a(0x2ce)](_0x3b956a(0x1d0)),logger[_0x3b956a(0x2ce)](_0x3b956a(0x3a9)+serverversion+'#RES#\x20'+(environment==_0x3b956a(0x2e5)?_0x3b956a(0x37c):'')),logger[_0x3b956a(0x2ce)](_0x3b956a(0x1d0))),_0x51d754%0x6==0x0&&triggerAnalytics(),_0x51d754%0x6==0x0&&getMessages(),await sleep(schedulerInterval),startScheduler();}async function restoreBackupFile(_0x182c0d){const _0x25ed86=_0x7fb00e;logger[_0x25ed86(0x2ce)]('Restore\x20backup\x20file\x20'+_0x182c0d);const _0x45702d=getBotsWithMode();_0x45702d['length']>0x0?confirmRestore(configbackuppath,_0x182c0d):unzipFile(configbackuppath,_0x182c0d);}async function getBackupFiles(_0x3bdc3c=null){const _0x3757fa=_0x7fb00e;let _0x25e315=[],_0x52d2e7=fs[_0x3757fa(0x31b)](configbackuppath,{'withFileTypes':!![]});_0x52d2e7[_0x3757fa(0x3a6)]((_0xf1a21e,_0x27b415)=>_0xf1a21e[_0x3757fa(0x259)]<_0x27b415['name']?0x1:_0x27b415[_0x3757fa(0x259)]<_0xf1a21e[_0x3757fa(0x259)]?-0x1:0x0),_0x52d2e7['forEach'](_0x3defcf=>{const _0x433421=_0x3757fa;if(!_0x3defcf[_0x433421(0x392)]()&&_0x3defcf[_0x433421(0x259)][_0x433421(0x25f)]('backup-full@')&&_0x3defcf[_0x433421(0x259)][_0x433421(0x39b)](_0x433421(0x3a3))){const _0x498dc2=formatDate(fs[_0x433421(0x352)](configbackuppath+_0x3defcf[_0x433421(0x259)])['mtime']);_0x25e315[_0x433421(0x33f)]({'name':_0x3defcf[_0x433421(0x259)],'mtime':_0x498dc2});}});if(_0x3bdc3c)io['to'](_0x3bdc3c)[_0x3757fa(0x211)](_0x3757fa(0x2cc),_0x25e315);else return _0x25e315;}async function backupConfigFiles(){const _0x10d0c5=_0x7fb00e;await zipFiles('backup-full');const _0x216789=getCleanTimeStamp();fs[_0x10d0c5(0x2ac)](zippath+_0x10d0c5(0x2ae),configbackuppath+(_0x10d0c5(0x27b)+_0x216789+_0x10d0c5(0x3a3)));let _0x80732a=fs[_0x10d0c5(0x31b)](configbackuppath,{'withFileTypes':!![]});_0x80732a[_0x10d0c5(0x3a6)]((_0x46e318,_0x5112ea)=>_0x46e318[_0x10d0c5(0x259)]<_0x5112ea[_0x10d0c5(0x259)]?0x1:_0x5112ea['name']<_0x46e318[_0x10d0c5(0x259)]?-0x1:0x0),_0x80732a[_0x10d0c5(0x23d)]>maxBackups&&fs['unlinkSync'](configbackuppath+_0x80732a[_0x80732a[_0x10d0c5(0x23d)]-0x1][_0x10d0c5(0x259)]);}function rotateLogFiles(){const _0x348b83=_0x7fb00e,_0x1baa89=fs[_0x348b83(0x352)](logspath+_0x348b83(0x2d6)),_0x163d8b=_0x1baa89[_0x348b83(0x244)]/0x400;if(_0x163d8b>0x64){let _0x5c0217=fs['readdirSync'](logspath,{'withFileTypes':!![]});_0x5c0217['sort']((_0x151d79,_0x17bfc1)=>_0x151d79[_0x348b83(0x259)]<_0x17bfc1[_0x348b83(0x259)]?0x1:_0x17bfc1[_0x348b83(0x259)]<_0x151d79[_0x348b83(0x259)]?-0x1:0x0),_0x5c0217[_0x348b83(0x257)](_0x4e9f2e=>{const _0x2d166c=_0x348b83;if(_0x4e9f2e[_0x2d166c(0x259)]=='output-002.log')fs[_0x2d166c(0x2ac)](logspath+_0x4e9f2e['name'],logspath+_0x2d166c(0x359));if(_0x4e9f2e['name']==_0x2d166c(0x302))fs[_0x2d166c(0x2ac)](logspath+_0x4e9f2e['name'],logspath+_0x2d166c(0x326));_0x4e9f2e['name']==_0x2d166c(0x2d6)&&(fs[_0x2d166c(0x2ac)](logspath+_0x4e9f2e[_0x2d166c(0x259)],logspath+'output-001.log'),fs[_0x2d166c(0x3ce)](logspath+_0x4e9f2e[_0x2d166c(0x259)],''));});}}async function zipFiles(_0x3d1e64){const _0x22431b=_0x7fb00e;let _0x49dc3f;if(_0x3d1e64==_0x22431b(0x233))_0x49dc3f=logspath;if(_0x3d1e64==_0x22431b(0x365))_0x49dc3f=configpath;if(_0x3d1e64=='backup-full')_0x49dc3f=configpath;let _0x3ff2e6=fs[_0x22431b(0x31b)](_0x49dc3f,{'withFileTypes':!![]});const _0x1ad924=new JSZip();_0x3ff2e6[_0x22431b(0x257)](_0x584083=>{const _0xe1c909=_0x22431b;if(!_0x584083[_0xe1c909(0x392)]()){let _0x14f51f=fs[_0xe1c909(0x2f0)](_0x49dc3f+_0x584083[_0xe1c909(0x259)]);if(_0x3d1e64=='backup'){const _0x26f6c8=/^bot-[0-9]{3}-config.json$/,_0x29fe5d=_0x26f6c8[_0xe1c909(0x345)](_0x584083[_0xe1c909(0x259)]);if(_0x29fe5d){const _0x45825c=JSON[_0xe1c909(0x385)](_0x14f51f);if(_0x45825c[_0xe1c909(0x2f9)][0x0]){_0x45825c[_0xe1c909(0x2f9)][0x0][_0xe1c909(0x2f7)]=_0xe1c909(0x322),_0x45825c[_0xe1c909(0x2f9)][0x0][_0xe1c909(0x308)]=_0xe1c909(0x322);if(_0x45825c[_0xe1c909(0x2f9)][0x0][_0xe1c909(0x289)])_0x45825c[_0xe1c909(0x2f9)][0x0]['apiPassword']=_0xe1c909(0x322);}_0x14f51f=JSON[_0xe1c909(0x2cd)](_0x45825c,null,0x2);}if(_0x584083[_0xe1c909(0x259)]==_0xe1c909(0x224)){const _0x2ecda5=JSON[_0xe1c909(0x385)](_0x14f51f);if(_0x2ecda5['settings'][_0xe1c909(0x319)])_0x2ecda5[_0xe1c909(0x2ed)][_0xe1c909(0x319)]=![];if(_0x2ecda5[_0xe1c909(0x2ed)][_0xe1c909(0x2e4)])_0x2ecda5[_0xe1c909(0x2ed)]['bbPassword']='***';if(_0x2ecda5[_0xe1c909(0x2ed)]['telegramToken'])_0x2ecda5['settings']['telegramToken']=_0xe1c909(0x322);if(_0x2ecda5[_0xe1c909(0x2ed)][_0xe1c909(0x32f)])_0x2ecda5[_0xe1c909(0x2ed)][_0xe1c909(0x32f)]=null;if(_0x2ecda5[_0xe1c909(0x2ed)][_0xe1c909(0x3db)])_0x2ecda5[_0xe1c909(0x2ed)][_0xe1c909(0x3db)]=_0xe1c909(0x322);_0x14f51f=JSON[_0xe1c909(0x2cd)](_0x2ecda5,null,0x2);}if(_0x584083[_0xe1c909(0x259)]!='bb-secure.json')_0x1ad924[_0xe1c909(0x1fc)](_0x584083['name'],_0x14f51f);}else _0x1ad924[_0xe1c909(0x1fc)](_0x584083[_0xe1c909(0x259)],_0x14f51f);}});const _0x1cb7e5=await _0x1ad924[_0x22431b(0x1d3)]({'type':_0x22431b(0x21b),'base64':![],'compression':_0x22431b(0x3cd)});fs['writeFileSync'](zippath+(_0x3d1e64+_0x22431b(0x3a3)),_0x1cb7e5,_0x22431b(0x344));}async function unzipFile(_0x524f68,_0x25dbe3){const _0x348013=_0x7fb00e;fs[_0x348013(0x31b)](configpath,{'withFileTypes':!![]})[_0x348013(0x257)](_0x5a9433=>{const _0xadc394=_0x348013;if(!_0x5a9433[_0xadc394(0x392)]())fs[_0xadc394(0x2e9)](configpath+_0x5a9433[_0xadc394(0x259)]);});const _0x48b48b=fs[_0x348013(0x2f0)](_0x524f68+_0x25dbe3,_0x348013(0x344)),_0x4bf6d1=await JSZip[_0x348013(0x3b9)](_0x48b48b,{'base64':![],'checkCRC32':!![]});for(const _0x294530 of Object[_0x348013(0x270)](_0x4bf6d1['files'])){const _0x177944=_0x4bf6d1['files'][_0x294530],_0x4f2259=await _0x177944[_0x348013(0x2dc)](_0x348013(0x21b));fs['writeFileSync'](configpath+_0x177944[_0x348013(0x259)],_0x4f2259);}fs[_0x348013(0x31b)](temppath,{'withFileTypes':!![]})['forEach'](_0x3c74f2=>{const _0x45b81f=_0x348013;if(!_0x3c74f2['isDirectory']())fs[_0x45b81f(0x2e9)](temppath+_0x3c74f2[_0x45b81f(0x259)]);}),logger[_0x348013(0x2ce)](_0x348013(0x323)),process[_0x348013(0x26b)]({'restore':!![]},_0x1c8d6a=>{});}async function getPublicIp(){const _0x463f9d=_0x7fb00e;try{const _0x5b8834=await axios[_0x463f9d(0x3a8)](_0x463f9d(0x366));publicip=_0x5b8834[_0x463f9d(0x1e5)]['ip'];}catch(_0x5b8428){}}async function triggerAnalytics(){const _0x1ec3ec=_0x7fb00e;if(!publicip)await getPublicIp();const _0x3687f4=getBotsWithMode();let _0x245fb6=0x0;_0x3687f4[_0x1ec3ec(0x257)](_0x5e93ea=>{const _0x190f3b=_0x1ec3ec;if(_0x5e93ea[_0x190f3b(0x2c4)]===_0x190f3b(0x281))_0x245fb6++;});const _0x11e6ab=getBotExchanges();mixpanel[_0x1ec3ec(0x1dd)](_0x1ec3ec(0x35b),{'distinct_id':settings[_0x1ec3ec(0x32b)],'ip':publicip,'version':serverversion,'numbots':_0x3687f4[_0x1ec3ec(0x23d)],'numbotsenabled':_0x245fb6,'exchanges':_0x11e6ab,'environment':environment});}async function getMessages(){const _0x23130a=_0x7fb00e,_0x24cdc7=_0x23130a(0x1d4),_0x1df707=new GraphQLClient(_0x24cdc7),_0x2974d9={'authorization':'Bearer\x20eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImdjbXMtbWFpbi1wcm9kdWN0aW9uIn0.eyJ2ZXJzaW9uIjozLCJpYXQiOjE2MjE2NjgzMzgsImF1ZCI6WyJodHRwczovL2FwaS1ldS1jZW50cmFsLTEuZ3JhcGhjbXMuY29tL3YyL2Nrb3l0enYzbG90a3kwMXc1OWdsYWNlN3kvbWFzdGVyIiwiaHR0cHM6Ly9tYW5hZ2VtZW50LW5leHQuZ3JhcGhjbXMuY29tIl0sImlzcyI6Imh0dHBzOi8vbWFuYWdlbWVudC5ncmFwaGNtcy5jb20vIiwic3ViIjoiYjZlOTBmODAtZmEzYS00ODJmLWE0NTAtMTY3YTFmZTliNzIzIiwianRpIjoiY2tvemZnaWE0Mno4bTAxdzU5bHU5ZTA3NSJ9.cEJ5isSubzX1ymlpkfyvfgZ6zyUMFiFOVaD4N84NoEOxwGZ8DtYM1k4DlCjoeCcTR8Ftr43bIGDxR4apANAG_-wf9Nge9T2MAuKa9z2sCWA5jnYtTHYU-x1Hx_ShpHAl1wPjrSpTMquV3bRlKQBm6EQTreoaQZgBXY25ClLbVzXFcohcDn3RGi3hHVRvxNLr0F7ETwFJnbowm9UX66vz2SP-5-u-CBKUxSipKMO5za0MZiIWoprSdE0f22xVXp8up3k_6-5x22mS88P2OFgMXoA-UBFS8nz6jRE_fRULzCouKYyJG3oQ10ovuZ1M729GQ0rMv9fkJroVKyS4i8KgglwPPBwQbaD2LCJXINKXYC65DmKyJ9UjWxQ9Lv6akcnkT7CkeqEqzwLnCEQgZEmJS_PBFDu40LMS8UbnwDcntJznA8rH_jsD7IkMdyRyXmns6fbLOc91Q1idBCk-VqUzkL0FzfscCVpkg1J7kGtGeW4YEWhWyPze4ZO4IxM9WRoSsCDUOx3EXklA0WSdR2M6IRnoFL-qoawOLQaaPACy8-QGmaAL6N6fuMIHUWavOTYnyLip0oyy74sUHz4S4sx4mAf5pexlvDcxM_6RIRnCQ84THsM2KwpoWkpR-F2s4pIyfYYn-4R7MNENfPGxNm4INjBYrCOWyZN_vXHGBa4uw2U'},_0x5375a4=serverversion[_0x23130a(0x360)]('.'),_0x2b3852=_0x5375a4[0x0]+'.'+_0x5375a4[0x1],_0x27b971=Math['min'](settings[_0x23130a(0x217)],settings[_0x23130a(0x235)]),_0x109a3f={'last':parseInt(_0x27b971),'bbm':_0x2b3852},_0x526711=gql`
            query getMessages($bbm: String!, $last: Int!) {
                messages(where: {
                    number_gt: $last
                    OR: [
                    {bbvReceive: "any"},
                    {bbvReceive_contains: $bbm}
                    ]
                    archived_not: true
                }, orderBy: number_ASC) {
                    id
                    number
                    bbvReceive
                    bbvNew
                    title
                    message
                    dialogWidth
                    lock
                }
            }
            `;let _0x5f3a15;try{_0x5f3a15=await _0x1df707[_0x23130a(0x28a)](_0x526711,_0x109a3f,_0x2974d9);}catch(_0x225cd6){}if(_0x5f3a15&&_0x5f3a15['messages']){let _0x15d890=settings[_0x23130a(0x217)],_0x35719d=settings[_0x23130a(0x217)];newMessages=[];for(const _0x5b9c16 of _0x5f3a15[_0x23130a(0x335)]){newMessages[_0x23130a(0x33f)](_0x5b9c16);let _0x3e67fa=![];_0x5b9c16[_0x23130a(0x219)]&&(updateSetting('latestversion',_0x5b9c16[_0x23130a(0x219)]),_0x3e67fa=isNewerVersion(serverversion,_0x5b9c16[_0x23130a(0x219)])||serverversion==_0x5b9c16[_0x23130a(0x219)]);if(!_0x3e67fa&&_0x5b9c16[_0x23130a(0x3d0)]>_0x15d890){if(_0x5b9c16[_0x23130a(0x391)]===_0x23130a(0x26d)||serverversion[_0x23130a(0x25f)](_0x5b9c16['bbvReceive'])){let _0x58217e=''+_0x5b9c16[_0x23130a(0x30d)]+'\x0a\x0a'+_0x5b9c16[_0x23130a(0x2c0)];const _0x523ef1=await sendTelegramMsg(toTelegramMarkdown(_0x58217e),_0x23130a(0x2d8));_0x15d890=_0x5b9c16[_0x23130a(0x3d0)];}}_0x35719d=_0x5b9c16[_0x23130a(0x3d0)];}updateAvailable=isNewerVersion(settings[_0x23130a(0x24b)],serverversion),updateSetting('lastmsgtelegram',_0x35719d),emitMessages();}}function emitMessages(){const _0x6e669=_0x7fb00e,_0x44779e=settings[_0x6e669(0x235)];let _0x576e09=[];newMessages[_0x6e669(0x257)](_0x464109=>{const _0x122a56=_0x6e669;_0x464109[_0x122a56(0x3d0)]>_0x44779e&&_0x576e09[_0x122a56(0x33f)](_0x464109);}),_0x576e09[_0x6e669(0x23d)]>0x0&&getAllClients()['forEach'](_0x248df3=>{const _0x16b057=_0x6e669;getSocket(_0x248df3['id'])[_0x16b057(0x211)]('message',_0x576e09);});}function confirmMessage(_0x5e4dd7){updateSetting('lastmsgemitted',Number(_0x5e4dd7));}function isNewerVersion(_0x18d762,_0x5de7e5){const _0xbaf23a=_0x7fb00e,_0x1628c0=_0x5de7e5[_0xbaf23a(0x360)]('.'),_0x358333=_0x18d762[_0xbaf23a(0x360)]('.');for(var _0x2de131=0x0;_0x2de131<_0x358333[_0xbaf23a(0x23d)];_0x2de131++){const _0xc2fc8c=~~_0x358333[_0x2de131],_0x5e9556=~~_0x1628c0[_0x2de131];if(_0xc2fc8c>_0x5e9556)return!![];if(_0xc2fc8c<_0x5e9556)return![];}return![];}function toTelegramMarkdown(_0x301717){const _0x15e02b=_0x7fb00e,_0x4003eb=/(^|[^\*])\*{1}([^\*.]+?)\*{1}([^\*]|$)/gim,_0x18b8e4=/\*{2}(.+?)\*{2}/gim;return _0x301717=_0x301717[_0x15e02b(0x367)](_0x4003eb,'$1_$2_$3')['replace'](_0x18b8e4,_0x15e02b(0x340)),_0x301717;}async function validateConfigFile(){const _0x15506a=_0x7fb00e,_0x10ae10=dbConfig['get'](_0x15506a(0x3e4))[_0x15506a(0x1ea)](_0x15506a(0x25d))[_0x15506a(0x1f2)]()||[];if(_0x10ae10['length']==0x0){let _0x58ba25=0x0,_0x210dee=[];const _0x2e0715=/^bot-([0-9]{3})-config.json$/,_0x27b3a9=fs[_0x15506a(0x31b)](configpath);_0x27b3a9[_0x15506a(0x257)](_0x4ad779=>{const _0x2cb586=_0x15506a,_0x208146=_0x2e0715[_0x2cb586(0x38b)](_0x4ad779);if(_0x208146){const _0x23761a=_0x208146[0x1];let _0xca9712=getBotAttributes(_0x23761a);_0x210dee['push']({'botID':_0x23761a,'botname':_0xca9712['botname'],'status':_0x2cb586(0x255),'live':'stopped'}),_0x58ba25++;}}),_0x58ba25!=0x0&&(dbConfig[_0x15506a(0x3a8)]('bots')[_0x15506a(0x201)](_0x210dee)[_0x15506a(0x397)](),config=_0x210dee,restoredConfigFile=_0x58ba25);}}async function restoreConfigNotify(_0x348e6c){const _0x9cb4c5=_0x7fb00e;let _0x3a90a0;if(restoredConfigFile==0x1)_0x3a90a0='NOTE:\x0aYour\x20bb-config.json\x20file\x20got\x20corrupted,\x20but\x20it\x20has\x20been\x20restored!\x20\x0aYour\x20bot\x20is\x20disabled\x20by\x20default\x20-\x20enable\x20if\x20you\x20want\x20it\x20to\x20run';else _0x3a90a0=_0x9cb4c5(0x31e);if(_0x348e6c)io['to'](_0x9cb4c5(0x378))[_0x9cb4c5(0x211)]('notification',_0x3a90a0);else{logger[_0x9cb4c5(0x34d)]('-----------------------------------------------------------------------------------'),logger[_0x9cb4c5(0x34d)](_0x3a90a0),logger[_0x9cb4c5(0x34d)](_0x9cb4c5(0x3a0)),logger[_0x9cb4c5(0x34d)]('');if(tgBot&&settings[_0x9cb4c5(0x32f)]&&settings['telegramEvents']!=_0x9cb4c5(0x234))await sendTelegram(settings[_0x9cb4c5(0x32f)],_0x9cb4c5(0x3c8)+_0x3a90a0);}}function decryptRSA(_0x1cc267,_0x529bfd){const _0x133eb8=_0x7fb00e,_0x228f45=forge[_0x133eb8(0x20f)][_0x133eb8(0x37d)](_0x1cc267),_0x98982a=_0x228f45[_0x133eb8(0x24f)](forge['util'][_0x133eb8(0x1d5)](_0x529bfd),_0x133eb8(0x2a0),{'md':forge['md'][_0x133eb8(0x1fb)]['create'](),'mgf1':{'md':forge['md'][_0x133eb8(0x1fb)][_0x133eb8(0x363)]()}});return _0x98982a;}function validateCredentials(_0x48364f,_0x1622f3){const _0x4a40d9=_0x7fb00e;if(_0x48364f[_0x4a40d9(0x298)]==settings[_0x4a40d9(0x2c6)]&&bcrypt[_0x4a40d9(0x214)](_0x48364f['password'],settings[_0x4a40d9(0x2e4)])){if(settings[_0x4a40d9(0x339)])return{'allow':![],'reason':_0x4a40d9(0x2fd),'token':null};else{const _0x33fb7f=generateLoginToken(_0x1622f3);return{'allow':!![],'reason':_0x4a40d9(0x2b4),'token':_0x33fb7f};}}else return{'allow':![],'reason':_0x4a40d9(0x3c0),'token':null};}function refreshToken(_0x4d18b8){const _0x160c4b=_0x7fb00e,_0x3d5921=generateLoginToken(_0x4d18b8);return{'allow':!![],'reason':_0x160c4b(0x2b4),'token':_0x3d5921};}function validateAccess(_0x3432b9,_0x10f360,_0x55e304){const _0x42c6e3=_0x7fb00e,_0x197718=_0x55e304?_0x55e304:devices[_0x10f360]['ip'];let _0xed3f23;const _0x5076c3=_0x5e8865=>{const _0x1ac46b=_0x4bf9;if(settings[_0x1ac46b(0x319)]){if(settings[_0x1ac46b(0x339)]){if(telegram2FaApproved(_0x10f360)){const _0x451ad0=generateLoginToken(_0x10f360);return{'allow':!![],'reason':_0x1ac46b(0x24e),'token':_0x451ad0};}else return{'allow':![],'reason':_0x1ac46b(0x34e),'token':null};}else return _0xed3f23=validToken(_0x5e8865,_0x10f360),_0xed3f23[_0x1ac46b(0x36d)](_0x1ac46b(0x31f))?{'allow':!![],'reason':_0x1ac46b(0x32a),'token':_0x5e8865}:{'allow':![],'reason':_0x1ac46b(0x34e),'token':null};}else return{'allow':!![],'reason':_0x1ac46b(0x336),'token':null};};if(settings[_0x42c6e3(0x3c2)]){let _0x53d50c=[...settings[_0x42c6e3(0x1ff)],_0x42c6e3(0x26c),_0x42c6e3(0x350),_0x42c6e3(0x2d9),_0x42c6e3(0x331)];if(_0x53d50c[_0x42c6e3(0x258)](_0x197718))return _0x5076c3(_0x3432b9);else{_0xed3f23=validToken(_0x3432b9,_0x10f360);if(_0xed3f23[_0x42c6e3(0x36d)]('success'))return _0x5076c3(_0x3432b9);else{if(telegramIpApproved(_0x10f360)){const _0x133e67=generateToken(_0x10f360);return _0xed3f23=_0x5076c3(_0x3432b9),_0xed3f23[_0x42c6e3(0x1db)]?{'allow':!![],'reason':'temporary\x20token\x20generated','token':_0x133e67}:_0xed3f23;}else return settings[_0x42c6e3(0x368)]?{'allow':![],'reason':'2FA\x20required','token':null}:{'allow':![],'reason':_0x42c6e3(0x2b8),'token':null};}}}else return _0x5076c3(_0x3432b9);}function timelyDecrypt(_0x4e54ec,_0x1125af,_0x3113f1='@'){const _0xc7b652=_0x7fb00e;if(_0x4e54ec)try{const _0x7d238e=decryptRSA(secure['privateKey'],_0x4e54ec),_0x1aaa15=_0x7d238e[_0xc7b652(0x360)](_0x3113f1)[0x0],_0x47ab4a=_0x7d238e[_0xc7b652(0x360)](_0x3113f1)[0x1],_0x1a8bed=new Date()['getTime']();if(_0x1125af){if(_0x1a8bed-_0x47ab4a<maxSecretAge*0x3e8)return _0x1aaa15;else return![];}else return _0x1aaa15;}catch(_0xd4615d){return![];}else return![];}const validToken=(_0x188c54,_0x3fcf6b)=>{const _0x34877b=_0x7fb00e,_0x1d0f39=devices[_0x3fcf6b]['ip'];if(!_0x188c54)return{'error':_0x34877b(0x2c9)};for(let _0x38ca6b of blacklist){if(_0x38ca6b[_0x34877b(0x1d9)]==_0x188c54)return{'error':_0x34877b(0x36b)};}let _0x4f8f41;try{_0x4f8f41=jwt[_0x34877b(0x1e9)](_0x188c54,secure[_0x34877b(0x275)]+_0x3fcf6b);}catch{return{'error':_0x34877b(0x29a)};}if(!_0x4f8f41[_0x34877b(0x36d)](_0x34877b(0x21c))&&!_0x4f8f41[_0x34877b(0x36d)](_0x34877b(0x298))||!_0x4f8f41[_0x34877b(0x36d)](_0x34877b(0x243)))return{'error':_0x34877b(0x226)};if(!_0x4f8f41['hasOwnProperty']('username')&&_0x4f8f41[_0x34877b(0x36d)](_0x34877b(0x21c))){const {clientip:_0x1eeee4}=_0x4f8f41;return _0x1d0f39==_0x1eeee4?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x34877b(0x35f)};}else{if(_0x4f8f41[_0x34877b(0x36d)](_0x34877b(0x298))&&_0x4f8f41[_0x34877b(0x36d)]('clientip')){const {username:_0xce2468,clientip:_0x8f0e86}=_0x4f8f41;return settings[_0x34877b(0x2c6)]==_0xce2468&&_0x1d0f39==_0x8f0e86?{'success':'User\x20has\x20been\x20validated'}:{'error':_0x34877b(0x32e)};}}},generateLoginToken=_0x580c86=>{const _0x40c9c7=_0x7fb00e;if(_0x580c86){const _0x53eaff=devices[_0x580c86]['ip'];return jwt[_0x40c9c7(0x33b)]({'username':settings[_0x40c9c7(0x2c6)],'clientip':_0x53eaff},secure[_0x40c9c7(0x275)]+_0x580c86,{'expiresIn':tokenRefresh*0x3c,'allowInsecureKeySizes':!![]});}else return![];},generateToken=_0x428c87=>{const _0x1611cc=_0x7fb00e;if(_0x428c87){const _0x20d04=devices[_0x428c87]['ip'];return jwt['sign']({'clientip':_0x20d04},secure[_0x1611cc(0x275)]+_0x428c87,{'expiresIn':devices[_0x428c87][_0x1611cc(0x1e2)][_0x1611cc(0x3ca)]*0x3c,'allowInsecureKeySizes':!![]});}else return![];},telegramIpApproved=_0x3c96bf=>{const _0x1bfe38=_0x7fb00e;let _0x4e959e=![];return devices[_0x3c96bf]['telegramIpApproval']&&devices[_0x3c96bf]['telegramIpApproval'][_0x1bfe38(0x3ca)]!=_0x1bfe38(0x2e1)&&(_0x4e959e=devices[_0x3c96bf][_0x1bfe38(0x1e2)]['clientip']==devices[_0x3c96bf]['ip']&&new Date()[_0x1bfe38(0x296)]()-devices[_0x3c96bf]['telegramIpApproval'][_0x1bfe38(0x389)]<devices[_0x3c96bf][_0x1bfe38(0x1e2)]['expiry']*0x3c*0x3e8),_0x4e959e;},telegram2FaApproved=_0x5310ec=>{const _0x51dfd4=_0x7fb00e;let _0x4265a2=![];return devices[_0x5310ec][_0x51dfd4(0x266)]&&devices[_0x5310ec][_0x51dfd4(0x266)]['expiry']!=_0x51dfd4(0x2e1)&&(_0x4265a2=devices[_0x5310ec]['telegram2FaApproval']['clientip']==devices[_0x5310ec]['ip']&&new Date()[_0x51dfd4(0x296)]()-devices[_0x5310ec]['telegram2FaApproval'][_0x51dfd4(0x389)]<devices[_0x5310ec][_0x51dfd4(0x266)][_0x51dfd4(0x3ca)]*0x3c*0x3e8),_0x4265a2;},normalizeIP=_0x2af23b=>{const _0xbfda1a=_0x7fb00e;let _0x1c6517=null,_0x518d3d=null;if(ipaddr[_0xbfda1a(0x3bb)](_0x2af23b)){const _0x743eaf=ipaddr[_0xbfda1a(0x385)](_0x2af23b);_0x743eaf['kind']()==='ipv6'?(_0x743eaf[_0xbfda1a(0x1e0)]()&&(_0x1c6517=_0x743eaf[_0xbfda1a(0x221)]()[_0xbfda1a(0x1ef)]()),_0x518d3d=_0x743eaf[_0xbfda1a(0x1ef)]()):(_0x1c6517=_0x743eaf[_0xbfda1a(0x1ef)](),_0x518d3d=_0x743eaf[_0xbfda1a(0x23a)]()['toString']());}return{'show':_0x1c6517?_0x1c6517:_0x518d3d,'store':_0x518d3d};};function formatDate(_0xda3b1){const _0x18f77b=_0x7fb00e;return _0xda3b1[_0x18f77b(0x23f)]()+'/'+(_0xda3b1[_0x18f77b(0x2d0)]()+0x1)[_0x18f77b(0x1ef)]()[_0x18f77b(0x39d)](0x2,'0')+'/'+_0xda3b1[_0x18f77b(0x1fe)]()[_0x18f77b(0x1ef)]()[_0x18f77b(0x39d)](0x2,'0')+'\x20'+_0xda3b1[_0x18f77b(0x382)]()[_0x18f77b(0x1ef)]()[_0x18f77b(0x39d)](0x2,'0')+':'+_0xda3b1[_0x18f77b(0x3d7)]()['toString']()[_0x18f77b(0x39d)](0x2,'0')+':'+_0xda3b1[_0x18f77b(0x328)]()[_0x18f77b(0x1ef)]()[_0x18f77b(0x39d)](0x2,'0');}function sleep(_0x360f13){return new Promise(_0xa17a51=>setTimeout(_0xa17a51,_0x360f13));}